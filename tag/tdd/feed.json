{
    "version": "https://jsonfeed.org/version/1",
    "title": "Dave's Notebook • All posts by \"tdd\" tag",
    "description": null,
    "home_page_url": "http://davembush.github.com",
    "items": [
        {
            "id": "http://davembush.github.com/what-if-unit-testing-wasn%E2%80%99t-necessary-notdd/",
            "url": "http://davembush.github.com/what-if-unit-testing-wasn%E2%80%99t-necessary-notdd/",
            "title": "What If Unit Testing Wasn’t Necessary? #noTDD",
            "date_published": "2018-10-06T10:30:05.000Z",
            "content_html": "<p>I recently read (yet another) post proposing that <a href=\"//blogs.msdn.microsoft.com/ericgu/2017/06/22/notdd/\">TDD “doesn’t work” and that we shouldn’t use it, or should use it very little</a>. What was shocking about this article wasn’t the content, but the fact that it is hosted on a Microsoft site.</p>\n<p>While I’m not entirely on board with throwing out TDD, the one thing I will agree to is that learning TDD is difficult. I am also willing to admit that, to a large extent, TDD is broken. If you’ve been following my post for a while, this SHOULD be shocking news.</p>\n<p>And so, I’ve been thinking.</p>\n<p>Maybe we’ve been asking the wrong question.  Maybe, instead of asking “How do we encourage people to implement TDD?”  We should be asking, “How do we make TDD either unnecessary, or trivial to implement?”</p>\n<figure>![](/uploads/2017/06/2017-06-27.jpg \"What If Unit Testing Wasn't Necessary? #noTDD\")<figcaption>Photo credit: [abraham.williams](//www.flickr.com/photos/4braham/5867328365/) via [VisualHunt.com](//visualhunt.com/re/0e2a0e) / [ CC BY-SA](//creativecommons.org/licenses/by-sa/2.0/)</figcaption></figure>\n\n<span id=\"more\"></span>\n\n<h2 id=\"Benefits-of-TDD\"><a href=\"#Benefits-of-TDD\" class=\"headerlink\" title=\"Benefits of TDD\"></a>Benefits of TDD</h2><p>So, let’s review why we think TDD is a good idea. One of the first reasons that you’ll find is that when TDD is done correctly, it encourages loose coupling of code. In fact, one of the things that make TDD hard to learn is that our code tends to be SO tightly coupled that it can’t be tested. There are whole books about how to decouple legacy code so we can get tests around them. There are problems with this, but we’ll get to those in a bit.</p>\n<p>The next major benefit of TDD is that it allows us to refactor our code without worrying about breaking anything. This is the feature I like the most. I was working on a system recently where the requirements were being “leaked” to me a bit at a time. I’d get something done and it would be “oh, I forgot to tell you about…”  </p>\n<p>Arrrgh.</p>\n<p>I was able to add the new code up until the last, “Oh, I forgot…”  And that broke my whole pattern. But it forced a much better architecture.</p>\n<p>Now in the old days, before I started writing tests, I would have been really nervous about tearing the code apart and putting it back together again. What if I broke something that already worked? But, because I had a large suite of tests around this code, I could refactor, run the tests, and fix the tests until I was back to everything working. Without the tests, I would not have known that I broke anything.</p>\n<p>BTW, no one has found any bugs in this code yet and it has been almost a year since I wrote it.</p>\n<p>Related to refactoring, by having a suite of tests in place, we can be reasonably sure that, as we add new features, we aren’t breaking any existing features.</p>\n<p>Next, TDD forces, or it should force, incremental coding.</p>\n<p>I was surprised when I found out that people don’t program incrementally. I always write just enough code to move the project along and then test it. But I know people who write code for hours and even days before they run any of it. And then, they can’t figure out where they broke the code. TDD done correctly, doesn’t let this happen.</p>\n<p>And finally, once you’ve learned how to test, TDD actually increases the speed with which you can produce quality code. I know a guy who brags about how fast he can code. But I also know he’s only counting the time until he said he was done, not the time it took him to fix all the bugs he found. Is he really any faster than any other programmer? It is hard to judge. But studies have shown that using TDD leads to greater over all speed and less technical debt. Something to consider.</p>\n<h2 id=\"Disadvantages-of-TDD\"><a href=\"#Disadvantages-of-TDD\" class=\"headerlink\" title=\"Disadvantages of TDD\"></a>Disadvantages of TDD</h2><p>But for all those benefits, there are still some major problems with TDD as a practice. </p>\n<p>The first and most looming of all, is the fact that using TDD introduces A LOT of friction into the programming process. As an exercise, I wrote a demo application using TDD while learning a new framework. I knew the language and the testing framework, I was just learning a new programming framework. The problem was I not only had to learn the new framework, but the framework has its own helper functions for testing that I also had to learn.</p>\n<p>I would say this friction is what holds most people back and is often voiced as, “TDD slows down my programming.”  Which is true until you’ve learned it all.</p>\n<p>The tendency with TDD is to try to get 100% code coverage. This often lulls us into the belief that we’ve tested everything that can be tested. But the problem is, because our code often has hidden parameters, we can’t always be sure we’ve written enough tests to be sure that we’ve covered all the possible ways those parameters show up. So, the fact is, we can’t be sure we have 100% coverage of the situations our code may run into even if we have 100% coverage of our code.</p>\n<p>The next two disadvantages impact relatively new programmers. That is, people who have been programming for less than 5 years. The problem is, that’s half of the programmers available to the market. After 5 years, you’ve either been promoted to management where you eventually forget how to program or, at the very best only know what you knew when you were promoted, or you’ve moved on to a new career. And then there are people like me who can’t stop coding.</p>\n<p>The problem with programmers who have less than 5 years of experience is that they don’t have any concept of design patterns and they know nothing of architecture. And unless you work in an organization that has senior level programmers with more than 10 years of experience, you aren’t likely to know it is even something you need to learn. And here is the problem. It is nearly impossible to implement TDD if you don’t have a broad understanding of these two subjects. If you have less than 5 years of experience, you are still focused on the basic problem of naming things, keeping your code DRY, and making sure you are implementing the single responsibility principle.</p>\n<p>And finally, there is simply nothing that is making you write tests. Your code will compile and run just fine without them. The syntax of your language really doesn’t care. So given all the detractors, it is really easy to just not write them at all. There, I’ve said it. Yes, we SHOULD use TDD, but it is impractical to expect any but the most seasoned programmers to use this methodology. And by then, they may not need them as much.</p>\n<h2 id=\"What-Tests-Aren’t-Needed\"><a href=\"#What-Tests-Aren’t-Needed\" class=\"headerlink\" title=\"What Tests Aren’t Needed\"></a>What Tests Aren’t Needed</h2><p>But what if we could write code that didn’t need to be tested? Well, generally any code you can look at and be sure you know what it does and what you can expect is code you don’t have to test. Code with a cyclomatic complexity of 2 or lower, which still allows for a condition or two. Code that is:</p>\n<ul>\n<li>Small.</li>\n<li>No conditions</li>\n<li>No hidden parameters</li>\n<li>No side effects</li>\n</ul>\n<p>By “small” I’m talking about code that is, ideally, 5 lines or fewer with the occasional 10 lines in the rarest of instances. </p>\n<p>No hidden parameters. This is a big one. Think about code you’ve recently written. If you are writing Object-Oriented code, you typically have a method that takes a parameter or two (maybe more) and then accesses a member variable and may even create a new object in the middle of the function. The reason we have Dependency Injection is to give us the ability to inject mock objects into our tests so that we can write test against something stable and known rather than these hidden parameters that are constantly changing. </p>\n<p>“No side effects” is a specific instance of a hidden parameter. Anyone try to test code that accesses a database? What if all the code you wrote that had some side effect was isolated to a specific area of your program? In that case, it would reduce the number of tests you would need to write to just that area. And if you wrote that code correctly, the tests would be trivial to write.</p>\n<h2 id=\"I’ve-Fallen-in-Love-…\"><a href=\"#I’ve-Fallen-in-Love-…\" class=\"headerlink\" title=\"I’ve Fallen in Love …\"></a>I’ve Fallen in Love …</h2><p>And this is why I’ve fallen in love with the concepts behind Functional Programming.</p>\n<p>In Functional Programming you have a series of functions that you chain together. Much like fluent programming in the Object-Oriented world, the return value of a function becomes the input for the next function. Each function does just one thing, so they implement the Single Responsibility principle probably better than any class you can possibly write. Each function only works on the parameters it has been given, so you don’t need to worry about hidden parameters and the function is not allowed to generate a side effect.  Even your conditions are handled by functions that filter the data before passing it on. This all makes your code REALLY easy to test if you decide you need to test it at all.</p>\n<p>Of course, no one ever said we couldn’t have side effects. Those are all isolated to specific code that is super easy to test.</p>\n<p>If this is all new to you, I suggest you take a look at the <a href=\"//reactivex.io/\">ReactiveX</a> and start learning this library in the language of your choice.</p>\n<p>For me, the gateway drug into the Functional world has be NgRX and the Flux&#x2F;Redux pattern which is based on RxJS a JavaScript implementation of ReactiveX.</p>\n",
            "tags": [
                "tdd",
                "agile",
                "noTDD"
            ]
        },
        {
            "id": "http://davembush.github.com/property-based-testing-revealed-a-better-way-to-test/",
            "url": "http://davembush.github.com/property-based-testing-revealed-a-better-way-to-test/",
            "title": "Property Based Testing Revealed - A Better Way to Test",
            "date_published": "2018-01-23T11:30:24.000Z",
            "content_html": "<p>Over the last couple of weeks, I’ve been experimenting with Property Based Testing.  While I’m probably doing it “wrong” by many definitions, I’m finding it useful enough that I’m adding it to my testing toolbox. <figure><img src=\"/uploads/2018/01/2018-01-23.jpg\" title=\"Property Based Testing Revealed - A Better Way to Test\"><figcaption>Photo credit: <a href=\"//visualhunt.com/author/0651d3\">abraham.williams</a> on <a href=\"//visualhunt.com/re/284007\">VisualHunt.com</a> &#x2F; <a href=\"//creativecommons.org/licenses/by-sa/2.0/\"> CC BY-SA</a></figcaption></figure></p>\n<span id=\"more\"></span> \n\n<h2 id=\"What’s-A-Property\"><a href=\"#What’s-A-Property\" class=\"headerlink\" title=\"What’s A Property?\"></a>What’s A Property?</h2><p>As you introduce yourself to Property Based Testing, one of the first things you’ll need to understand is what they mean by a “property.”  Most of us who have been doing some form of Object Oriented Programming think of “properties” as data points on an object.  That’s not even close to what the word means when we talk about Property Based Testing. </p>\n<p>Roughly translated, a “property” is some feature of the code under tests.  Most of the beginner literature uses the classic add(a, b) method.  Properties of an add method include:</p>\n<ul>\n<li><code>add(a, b) === add(b, a)</code></li>\n<li>if <code>a</code> is zero then <code>add()</code> will return the value of <code>b</code></li>\n<li><code>add(a, b) - a</code> will equal b (and similar for minus b equals a).</li>\n</ul>\n<p>The key here is that we shouldn’t need to know too much about the data we are sending in to our add method because we are going to send in random data.  So, any property we test needs to be expressed in a data agnostic way.</p>\n<h2 id=\"What-are-the-Advantages\"><a href=\"#What-are-the-Advantages\" class=\"headerlink\" title=\"What are the Advantages?\"></a>What are the Advantages?</h2><p>And while having to think about our test in a data agnostic way is hard, at first, the first advantage is that we start thinking about testing our code in terms of generalities instead of specifics.  And, really, a general test is a much more robust test. </p>\n<p>But, we need data for our tests, right?  Where does that come from?  Depending on the framework you are using, this may vary, but the general idea is that you describe what the data should look like, and the framework will generate random parameters to pass in.  This fact leads us to two more benefits of Property Based Testing. </p>\n<p>First, since all I need to do is describe what the data should look like, I’m not forced to think of the data I want to use to tests my function.  I don’t know about you, but my tendency is to create data that works with my function instead of trying to create data that will break my function.  By having the framework create random data, I’m more likely to test with data that will break my code. </p>\n<p>And that leads to the second benefit of random data.  I’m more likely to find the edge cases for my function under test. Now, one detail I’ve left out is that each test you create gets run multiple times with different random data.  So, it isn’t like one day your tests work great and another day they fail.  No.  The system I use generates 100 different sets of data per tests.  You can have it create more or less tests as needed.</p>\n<h2 id=\"Places-You-Might-Not-Use-Property-Based-Testing\"><a href=\"#Places-You-Might-Not-Use-Property-Based-Testing\" class=\"headerlink\" title=\"Places You Might Not Use Property Based Testing\"></a>Places You Might Not Use Property Based Testing</h2><p>Now, running 100 different permutations on a test that takes a long time to run may not be practical.  My first question would be, why does your code take that long?  Are you trying to unit test HTML code and the rendering is taking a long time?  That’s probably a poor use case. </p>\n<p>Another place where you might want to avoid property based tests is when you’ve already basically tested the component parts and you just need to do a sanity check in the integration of the parts.</p>\n<h2 id=\"Places-You-Might-Use-Property-Based-Testing-Anyhow\"><a href=\"#Places-You-Might-Use-Property-Based-Testing-Anyhow\" class=\"headerlink\" title=\"Places You Might Use Property Based Testing Anyhow\"></a>Places You Might Use Property Based Testing Anyhow</h2><p>On the other hand, not having to come up with my own parameter values makes the whole Property Based Testing pretty attractive, even when it doesn’t make a lot of sense.  And it might encourage you to write smaller functions.</p>\n<h2 id=\"Problems-I’ve-Run-Into\"><a href=\"#Problems-I’ve-Run-Into\" class=\"headerlink\" title=\"Problems I’ve Run Into\"></a>Problems I’ve Run Into</h2><p>I would say the biggest problem I’ve run into using Property Based Testing is learning how to write tests that don’t re-implement the logic in my code in order to test the logic in my code. </p>\n<p>Going back to the <code>add(a, b)</code> example above.  It is tempting to test that function by verifying that <code>add(a, b) === a + b</code>.  But that wouldn’t be a very good test because we used the same logic that is probably already being used inside the <code>add()</code> function.  In example based testing (classic unit testing), we have the same problem, we just don’t use code to implement it.  We add the numbers in our head and verify that <code>add(a, b) = c</code>.  But, <code>c</code> is just <code>a + b</code> done in our head. </p>\n<p>Which leads me back to, even though it is “harder” we end up with better tests.</p>\n<h2 id=\"I’m-Probably-Doing-it-Wrong\"><a href=\"#I’m-Probably-Doing-it-Wrong\" class=\"headerlink\" title=\"I’m Probably Doing it Wrong\"></a>I’m Probably Doing it Wrong</h2><p>I’m so new to this way of thinking, that I’m pretty sure I’m doing everything wrong.  But, I figure I can take advantage of what I understand and as I write more tests, I’ll find more and better ways of writing tests.  I encourage you to pick up a property based framework for your development environment and give it a try.</p>\n<h2 id=\"Resources\"><a href=\"#Resources\" class=\"headerlink\" title=\"Resources:\"></a>Resources:</h2><ul>\n<li><a href=\"//hypothesis.works/articles/what-is-property-based-testing/\">What is Property Based Testing?</a></li>\n<li><a href=\"//fsharpforfunandprofit.com/posts/property-based-testing/\">An Introduction to Property Based Testing</a></li>\n</ul>\n",
            "tags": [
                "tdd",
                "testing",
                "property based testing"
            ]
        },
        {
            "id": "http://davembush.github.com/the-myth-of-sloppy-code/",
            "url": "http://davembush.github.com/the-myth-of-sloppy-code/",
            "title": "The Myth of Sloppy Code",
            "date_published": "2016-10-18T10:30:00.000Z",
            "content_html": "<ul>\n<li>Tightly coupled code runs faster.</li>\n<li>Tightly coupled code is easier to write.</li>\n<li>Test Driven Development increases development time.</li>\n<li>Test Driven Development negatively impacts code design.</li>\n<li>Knowing the names of design patterns isn’t important as long as you can use them.</li>\n<li>All my customer cares about is how soon they can have the product, not how clean the code is.</li>\n</ul>\n<p>All of these statements, and others like them, are excuses for not writing code correctly. And you know what an excuse is, right?</p>\n<blockquote>\n<p>The skin of a reason stuffed with a lie.</p>\n</blockquote>\n<figure>![](/uploads/2016/10/image-1.png \"The Myth of Sloppy Code\")<figcaption>Photo credit: [dynamosquito](//www.flickr.com/photos/dynamosquito/5866244470/) via [Visualhunt.com](//visualhunt.com) / [CC BY-SA](//creativecommons.org/licenses/by-sa/2.0/)</figcaption></figure>\n\n<span id=\"more\"></span>  \n\n<p>Now, I could go through and argue each of the points above. But today, I want to look more at the attitude behind these statements.</p>\n<h2 id=\"It’s-All-in-Your-Head\"><a href=\"#It’s-All-in-Your-Head\" class=\"headerlink\" title=\"It’s All in Your Head\"></a>It’s All in Your Head</h2><p>Man is a funny being. We make decisions with our hearts and justify the decisions with our brains. Once you know this, you can hack it to your favor. But how does this relate to what we’ve been talking about? It is really quite simple. All of the best practices I’ve mentioned above require work to learn. We would rather not invest the time to learn how to do these well, and so rather than just saying, “this is not where I choose to spend my time right now” we say things like, “my management won’t let me do that” or “my way is more efficient” or at times, we even resort to vilifying the practice.</p>\n<p>I have the same issue when I try to convince management that their process needs to change. It took seven years for me to get one company to move their project management system from email to project management software. Why? Because what they were doing “worked” and they couldn’t see that doing something different would work better in any way.</p>\n<h2 id=\"A-Skin-of-a-Reason\"><a href=\"#A-Skin-of-a-Reason\" class=\"headerlink\" title=\"A Skin of a Reason\"></a>A Skin of a Reason</h2><p>So, let’s look at the parts of these myths that are true.</p>\n<p>First, it is true that while you are learning how to use any one of these best practices, it will in fact, take you longer to write your code. Tightly coupled code is easier to reason about and one could argue is therefore easier to write. Test Driven Development is one of the most difficult things to learn. And just like the myth that Agile&#x2F;Scrum&#x2F;Kanban doesn’t work, the myth that Test Driven Development doesn’t work is largely based on misconceptions about what Test Driven Development is. Initially, it will impact the time it takes for you to write your code. But the more interesting argument to me is that testing negatively impacts design. If you mean that you can’t use the design you are used to using and that design involves writing tightly coupled code. Yeah, I guess it does.</p>\n<p>Implementing design patterns is better than not. It is true. But that doesn’t mean you shouldn’t learn the names.</p>\n<p>Yes, your customer cares about how fast you can get the project done. But, that isn’t all they care about.</p>\n<h2 id=\"The-Lies\"><a href=\"#The-Lies\" class=\"headerlink\" title=\"The Lies\"></a>The Lies</h2><p>Just because something takes longer while you are learning how to do it, doesn’t mean it will always take longer. It probably took you a while to learn how to program proficiently too. That didn’t stop you did it? Does it take you as long to program now as when you first started? Of course not! Let’s look at this from another angle. As you’ve learned multiple languages, would you say that it made you a better or worse programmer? Unless you have a very strange perspective, you will probably answer better. Was the new language hard to learn? Of course. Did it take you longer to code using the new language than one you knew previously? Of course. Would you say the result of being proficient in both has made it easier or harder to code in both? Easier, right? Tightly coupled code is easier to write, but as the application grows, tightly coupled code becomes harder to add to and harder to maintain. It lends itself to code duplication and is more likely to be the code base that needs to be rewritten first.</p>\n<p>Tightly coupled code is also the hardest to tests and is probably the reason you don’t want to write test for your code. Because you write tightly coupled code, testing is MUCH harder than it should be. This leads you to have a firm belief that writing tests is hard as well. A vicious cycle.</p>\n<p>And if you believe that tightly coupled code is a proper design, you will believe that tightly coupled code hinders design. But in fact, writing tests will force you to write loosely coupled code. So, instead of hindering design, it actually helps it.</p>\n<p>I used to think not learning the correct names for design patterns didn’t matter. But the advantage of knowing the proper name for things is that we can all talk about something using the name rather than trying to explain what that thing is with lots of words. It saves time. But, there is another much more subtle reason why you need to learn the proper name for things. You might be calling a design pattern you are using by an incorrect name and confusing the people you are communicating with. And, finally, learning the names for all of the design patterns will expose you to design patterns you aren’t aware of, broadening your horizons.</p>\n<p>This last one is, or should be the most obvious. Getting the project done quickly isn’t ALL your customer cares about. It might be a relatively high priority, but I can assure you, if you explain to them that getting the project done as fast as possible will mean you have to rewrite the code if they want any changes, you’ll quickly find out that redoing work they’ve already paid for doesn’t sit well with them either.</p>\n<h2 id=\"Benefits\"><a href=\"#Benefits\" class=\"headerlink\" title=\"Benefits\"></a>Benefits</h2><p>It is a sad, sad truth that by convincing yourself that not investing in these best practices really is best for you and the clients you work for, you’ve also limited yourself to the quality of client you can work for. The places that pay well expect you to know how to do this stuff. They believe in good design. They believe in testing. They know how to implement design patterns.</p>\n<p>And guess what, these places also pay better too. It raises you beyond the level of “commodity programmer” and into the level of “rare gem” How do I know? This past year I’ve been doing a lot of interviewing. For various reasons, I decided to interview for jobs that pay 25% better than what I currently make. In the beginning, I did this because I figured it would expose me to people more like myself who wanted to be better. In the process, I discovered that the interview process is a little harder, but not impossible. I figured out what I still need to learn. And, I managed to beat my goal. Time to notch it up a bit more.</p>\n<h2 id=\"Are-You-Dead\"><a href=\"#Are-You-Dead\" class=\"headerlink\" title=\"Are You Dead?\"></a>Are You Dead?</h2><p>You hear stories all the time about people who can’t find work in our industry. When you ask, you find out that all they know is something that was hot 10 years ago or longer. Well, of course you can’t find a job. And it is no wonder the last company got rid of you. You provide no value.</p>\n<p>This past week I heard someone tell me the equivalent of, “I’m not going to learn anything new. Every time I do, it ends up being hot for a few years and then it is gone.” I was stunned. I fear for this guy. You might as well say, “I’m planning to retire in 10 years or less.” because that is what will happen to you. Worse, if you stop learning completely, you could end up with dementia or worse.</p>\n<p>My plan is to program until I’m at least 75. Longer if I stay healthy enough. Even if I could retire, I won’t. What would I do? I love programming. I love mentoring other programmers. I love learning new stuff.</p>\n<h2 id=\"Do-hard-stuff\"><a href=\"#Do-hard-stuff\" class=\"headerlink\" title=\"Do hard stuff\"></a>Do hard stuff</h2><p>And so what’s the point of all this? Do hard stuff. It will make you a better programmer.</p>\n",
            "tags": [
                "tdd",
                "agile",
                "design patterns"
            ]
        },
        {
            "id": "http://davembush.github.com/4-reasons-to-write-loosely-coupled-code/",
            "url": "http://davembush.github.com/4-reasons-to-write-loosely-coupled-code/",
            "title": "4 Reasons to Write Loosely Coupled Code",
            "date_published": "2016-09-27T10:30:00.000Z",
            "content_html": "<p>This past week I got into a small discussion about the importance of loosely coupled code.  Specifically, I was looking at event handler code that did nothing more than change the size of another element on the screen.  But the event handler code was in the controller which in the particular implementation we are using was the event handler portion of our Model in a MVVM architecture.  The question becomes does this code belong in the view, or does it belong in the controller? The question of where code belongs leads eventually to arguments for loosely coupled code.  If I put code in my controller that is manipulating the view, then I either need to mock out my view in order to test my controller or I have to have an instance of my view available to test my controller.  Having coded enough systems to know that both of those choices are problematic, I opt for placing the view specific code in the view.  Another place where you might place this code would be in a View Specific event handler class.  But that would only be for the purposes of clean separation.  Something we might consider doing if the View were plain HTML.  But in our particular case, the view is generated from code, so placing the handlers in that same code seems to be the most appropriate location for it.</p>\n<p>But all of this leads to a larger question.  Why should your code be loosely coupled at all? <figure><img src=\"/uploads/2016/09/image-2.png\" title=\"4 Reasons to Write Loosely Coupled Code\"><figcaption>Photo credit: <a href=\"//www.flickr.com/photos/hernanpc/7115374283/\">Hernan Piñera</a> via <a href=\"//visualhunt.com\">VisualHunt.com</a> &#x2F; <a href=\"//creativecommons.org/licenses/by-sa/2.0/\">CC BY-SA</a></figcaption></figure></p>\n<span id=\"more\"></span>\n\n<h2 id=\"Refactoring\"><a href=\"#Refactoring\" class=\"headerlink\" title=\"Refactoring\"></a>Refactoring</h2><p>One of the main advantages of loosely coupled code is that this combined with granularity makes code refactoring easier.  Because my controller class only handles events that cause data to be manipulated and does not cause any changes to the view, I know that any changes I make to my controller will not cause any unexpected presentation layer changes.</p>\n<p>Similarly, and in this case, more importantly, any changes I make to the view will not force me to make changes to the controller class.  That is, all of the code that could be impacted by any one change happen in one and only one class.</p>\n<p>Loose coupling can also occur horizontally, and often does without us thinking too intensely about it.  Have you ever used a control from one vendor only to find another control works better?  The more easily those controls match each other’s programmable interface, the easier the job was to swap them out.  We can do the same type of thing in our own code.  The more granular the code is broken down; the easier any one part of the code can be replaced by something that works “better”.</p>\n<h2 id=\"More-Maintainable\"><a href=\"#More-Maintainable\" class=\"headerlink\" title=\"More Maintainable\"></a>More Maintainable</h2><p>But the argument might be make that this is a lot of work for something that isn’t very likely to happen.  But anyone who has been programming more than a few years on essentially the same system knows that it does.</p>\n<p>Here’s how it looks.  You start out writing a system and you care very little about coupling or not.  Hey, we’ve got code to write and very little time.  Full steam ahead and forget best practices.  And for now, let’s assume you have a small enough system that you actually pull it off.  You get the system delivered, and somehow it miraculously works.  Congratulations.</p>\n<p>A few months go by and you get a new requirement or a change request comes in for an existing requirement.  Either way, you manage to shoe horn the change in.</p>\n<p>More time goes by and a change to the last set of changes comes in.  And now you realize that what you have is a rather fragile architecture that can’t possibly sustain the new request.  A change that might have taken a month given a more loosely coupled architecture is now going to take three because of the amount of rework that is going to be required.</p>\n<p>Another way that loosely coupled code helps is when you are writing a very large system.  Let’s say the system is large.  You write this for a few months and everything seems to be going fine when you hit that first, “oops! we forgot” moment.  So you have to go back and retro fit the change into your tightly coupled code.  And then you progress some more and hit even more of those kind of changes.  Eventually, everyone learns to hate this system because it is so hard to work on and every change we make to existing code causes more and more bugs.</p>\n<h2 id=\"Cross-Platform\"><a href=\"#Cross-Platform\" class=\"headerlink\" title=\"Cross Platform\"></a>Cross Platform</h2><p>Refactoring and maintenance have some practical implications beyond just being able to work on your code.  In this world of multiple platforms, you may find yourself wanting to run some of what you’ve written on another platform.  There are multiple ways you might do this, but keeping your code isolated is going to make this easier.  Say you want to run your code on the web, as a desktop application, on the various mobile phones and tablets that are available.  Even if you do this all in the confines of HTML, JavaScript and CSS, you will most likely have different presentation layers.  If you have view specific code (to use our example again) that isn’t in the view, you’ll need to write code in the controller that detects which of the platforms you are running on.</p>\n<p>But if you’ve decided to use native components on each of the platforms, the view layer is actually going to change drastically.  And the view specific code you wrote might not even work on the new platform.  All the more reason to keep the view code isolated.</p>\n<h2 id=\"Cross-Framework\"><a href=\"#Cross-Framework\" class=\"headerlink\" title=\"Cross Framework\"></a>Cross Framework</h2><p>Or, maybe you are going to upgrade your framework.  Angular 2 just released and it is drastically different from Angular 1.  I can tell you right now, the organizations who wrote loosely coupled Angular 1 code are going to have a much easier time transitioning to Angular 2.  Or maybe you want to switch from Angular to React, or from any of the multitude of frameworks to another.  The more loosely coupled your code, the easier it will be to move.  And nowhere is this more obvious than in the fast moving JavaScript world.</p>\n<h2 id=\"Single-Responsibility\"><a href=\"#Single-Responsibility\" class=\"headerlink\" title=\"Single Responsibility\"></a>Single Responsibility</h2><p>Loosely coupled code is strongly related to the Single Responsibility principle.  You can’t have loosely coupled code unless the code follows the Single Responsibility principle.  And in the case above, putting view code in our controller actually violates both at the same time.  The controller is for manipulating view agnostic data.  The view is where your presentation layer code goes.  Of course, we could turn this around and remove the controller and put all of our code in the View.  Now that would definitely violate the single responsibility principle while giving the appearance of loose coupling.  But if we ever had to create multiple views we would quickly violate yet another principle.  Don’t Repeat Yourself.</p>\n<h2 id=\"Testing\"><a href=\"#Testing\" class=\"headerlink\" title=\"Testing?\"></a>Testing?</h2><p>Normally, I would lead off with testing.  But the argument could be made, “If I’m not going to write unit test, do I still need to do this?”  Actually, someone did make that argument.  And for now, ignoring that not writing unit test is a bad idea that I’ve written about before.  Writing unit test helps us think about these issues up front.  It isn’t that testing is the reason we write good code, although if that’s how you want to think about it I’m not going to stop you.  It is just that writing good test causes us to write good code.  Since it is the most visible benefit we tend to think of it first.  But testing isn’t at all why we do this.  We write test because it provides benefits much like loose coupling does.  Saying that we write loosely coupled code that follows the single responsibility principle so we can test would be like saying we don’t get lost so we can use our GPS.  It is the GPS that helps us to not get lost.  In the same way, it is the test that cause is to write good code.</p>\n<h2 id=\"Best-Practices\"><a href=\"#Best-Practices\" class=\"headerlink\" title=\"Best Practices\"></a>Best Practices</h2><p>I know I’ve been following best practices for so long that I often forget why I’m doing them.  They work.  I do them.  But every once in a while, I need to step back and take a look at what I’m doing and ask “Why?” once again.</p>\n",
            "tags": [
                "tdd",
                "DRY",
                "loose coupling",
                "single responsibility"
            ]
        },
        {
            "id": "http://davembush.github.com/8-reasons-johnny-does-not-write-bug-free-code/",
            "url": "http://davembush.github.com/8-reasons-johnny-does-not-write-bug-free-code/",
            "title": "8 Reasons Johnny Does Not Write Bug Free Code",
            "date_published": "2016-09-20T10:30:00.000Z",
            "content_html": "<p>There have been a number of things that have occurred over the last week that have prompted this particular post.  And for anyone I work with, this is not an indictment of our work place so much as it is an indictment of our industry.  PLEASE don’t take this personally.</p>\n<p>Some of those reasons will show up in this article.  But the question we need to examine today is why is it so hard to write bug free code.  And I’m not even talking about perfection.  Why is it that we miss the simple stuff?  The stuff that once it is found, we think, “how could we have missed that?!”.  I’m perfectly aware that all code has bugs some just haven’t been found yet.  I’m also aware that no matter how hard I try, the stupid bugs always make their way past my desk.</p>\n<figure>![](/uploads/2016/09/image-1.png \"8 Reasons Johnny Does Not Write Bug Free Code\")<figcaption>Photo credit: [~Pawsitive~Candie_N](//www.flickr.com/photos/scjn/3450910519/) via [Visualhunt](//visualhunt.com) / [CC BY](//creativecommons.org/licenses/by/2.0/)</figcaption></figure>\n\n<span id=\"more\"></span>\n\n<h2 id=\"No-Training\"><a href=\"#No-Training\" class=\"headerlink\" title=\"No Training\"></a>No Training</h2><p>Certainly not the only reason.  But at the same time I think this is a core reason.  Our industry really sucks when it comes to teaching computer science.  So much so, that I’ve written articles about how, for the most part, you don’t need a college education to become a programmer.  Maybe if we taught what programmers don’t already know how to do, a college education would be valuable.</p>\n<p>But what do we do instead?  We teach programmers how to program.</p>\n<p>Dumb! I think back to my education.  Here’s a basic summary of what I learned:</p>\n<ol>\n<li>COBOL, dBase III, JCS, CICS syntax.</li>\n<li>Break your code into functions</li>\n<li>A bit on how to do requirements analysis.</li>\n</ol>\n<p>Guess what?  I could have learned all of that on my own.  How do I know that?  Because I had already taught myself, Basic and C before.  I taught myself every language I’ve learned since.  I was already writing structured code, and still do.  And how we gather requirements has changed and somehow I managed to learn that on my own.  Programming is a learning profession.  It is one of the things that makes it attractive to me.</p>\n<p>But what didn’t I learn?  At no point did anyone ever teach me how to break my own code.  And while Test Driven Development wasn’t a thing when I was going to school.  I doubt they are teaching it today.  (Let me know if your school did or is.)</p>\n<h2 id=\"Happy-Path-Specs\"><a href=\"#Happy-Path-Specs\" class=\"headerlink\" title=\"Happy Path Specs\"></a>Happy Path Specs</h2><p>So, the programmers have no training.  But it isn’t just a programmer problem.</p>\n<p>When is the last time you got a specification from whoever creates them in your organization that had any more than a happy path set of requirements?  But, certainly there are things the system should not do.  I recently had to go asking for required fields and maximum field lengths in an application I was working on.  And that’s the simple stuff.</p>\n<h2 id=\"Not-My-Job\"><a href=\"#Not-My-Job\" class=\"headerlink\" title=\"Not My Job\"></a>Not My Job</h2><p>If you have a QA department, you might be tempted to leave testing to QA.  My personal goal is to make sure QA doesn’t find anything.  At least, not something really obvious.</p>\n<p>But I know that some programmers get sloppy about testing their code if they know the safety net of QA exist.</p>\n<p>There is also the problem of QA believing they are the only ones who test.  Strange, but true.  When QA found out I was writing unit test for a pretty complex piece of logic, I was asked, “Then what will be left for me to do?!”  Strange but true.</p>\n<p>But what if we started working as teams?  For example, what if I could get QA to help me develop my test plan?  What if developing software was a WE activity instead of several silo developers each doing their own thing?</p>\n<h2 id=\"Batch-Programming\"><a href=\"#Batch-Programming\" class=\"headerlink\" title=\"Batch Programming\"></a>Batch Programming</h2><p>This is one I really don’t understand.  But I know programmers who will write code for hours prior to running it.  Even if you did remember everything you coded, how can you possibly know where a bug is located if you wait that long?  You should be running your code every time you have something different that can be run so that you know what change caused a problem.  And don’t tell me you test every possible condition.  I know you don’t.</p>\n<p>Programmers who program like this are “Debbie Done” programmers.</p>\n<p>Why “Debbie Done”? There is this story about a programmer who used to work at one of the companies I worked at in the past.  She considered code done if it compiled and linked.</p>\n<p>I’m not as good at testing as I would like (yet) and I’m always embarrassed when someone finds a problem with my code.  So, I was shocked one day when I found out that a project manager wanted to give me some work because my code “always works.”  I knew that wasn’t true.  But when I reflected on what he was saying I realized that the difference in how I code and the other programmers he was comparing me to is that I write for a few minutes and then make sure that works before I continue on.</p>\n<h2 id=\"We-Don’t-Plan-to-Test\"><a href=\"#We-Don’t-Plan-to-Test\" class=\"headerlink\" title=\"We Don’t Plan to Test\"></a>We Don’t Plan to Test</h2><p>Ah.  And here we get a little closer to the truth.</p>\n<p>What do I mean by planning to test? For any spec you are working on, you should have, written out or coded, a repeatable set of steps that ensures that your code does what it should and doesn’t do what it shouldn’t.  This is what test driven development attempts to steer us toward.  I’m not going to go off on a rant about TDD again here.  But I will tell you that either having a written out test plan prior to coding enables me to ensure that my code does what the people who gave me the specification think it should.  It also forces me to think about ways I might break the code.  I know my code is delivered with less bugs because of this process.  Hopefully, I’ll get better at thinking of how to break my own code.</p>\n<p>Having a plan helps with the Debbie Done programmer as well as people who code more like me.</p>\n<p>Even though I code&#x2F;test incrementally, I still only test the code right after I’ve written it.  Once I think it is working, I don’t go back, even though something else I’ve written may have changed how the code is working.  Having repeatable tests has save me several times.</p>\n<h2 id=\"We-Don’t-Know-what-we-Don’t-Know\"><a href=\"#We-Don’t-Know-what-we-Don’t-Know\" class=\"headerlink\" title=\"We Don’t Know what we Don’t Know\"></a>We Don’t Know what we Don’t Know</h2><p>Even if we do everything right, we are still going to miss stuff.  One person can’t possibly figure out all that might go wrong.  It is how we deal with the problems once they are revealed that becomes the issue.  This is where we would, ideally, have the team come up with the test scenarios.</p>\n<h2 id=\"Shame-Driven-Development\"><a href=\"#Shame-Driven-Development\" class=\"headerlink\" title=\"Shame Driven Development\"></a>Shame Driven Development</h2><p>I actually heard a project manager say, “Shame on the developer if QA finds bugs.” Really?!  What about “Shame on the BA for not including that item in the requirements.”?  What about “Shame on the product owner for not mentioning it.”? Or what about no shame at all? While shame is a powerful motivator in the short term, it is a sure way to make sure your developers leave.</p>\n<p>That you only retain highly dysfunctional programmers.  Or that you can only retain programmers who can’t really code.</p>\n<p>Shame based development can only lead to even more bugs.  Not fewer.</p>\n<p>At some point I should probably write about the dangers of a shame based culture.   If your organization is using shame to manage personnel.  Get out!</p>\n<h2 id=\"Long-Hours\"><a href=\"#Long-Hours\" class=\"headerlink\" title=\"Long Hours\"></a>Long Hours</h2><p>Another way you can kill the overall effectiveness of your team is to make sure everyone works more than 45 hours a week for months or years at a time.  One of two things will happen, if not both.</p>\n<p>The code will suffer.  Want to introduce more bugs?  Keep everyone working overtime.  A week here or there is a different story.</p>\n<p>If the code doesn’t suffer, then you are likely to find a lot more socialization, social media activities, and just plain goofing off occurring.  People just can’t work that many hours.  Just because someone is at work for 10 hours doesn’t mean they are working 10 hours.  But hours are easy to measure, so this terrible practice continues.</p>\n<h2 id=\"We-Can’t-Fix-Everything\"><a href=\"#We-Can’t-Fix-Everything\" class=\"headerlink\" title=\"We Can’t Fix Everything\"></a>We Can’t Fix Everything</h2><p>I’m in a unique position in that I’m currently functioning as a Scrum coach.  This allows me to influence all the areas I’ve discussed.  As programmers, you can only influence your own stuff.  So, my recommendation to you is to concentrate on what you have control over.  Create a test plan prior to writing code.  Once you’ve learned how to do that, work on learning how to code those test so you don’t have to run them manually over and over again.  Do this slowly.  Maybe start with just one test.  Squeeze it into the cracks of your regular work.  Learning to test and learning to code test takes time, but it will make you a better programmer and will ultimately make you a more reliable and faster programmer.  Someday you might just hear that they want to give you an important job because “Johnny’s code always works.”</p>\n",
            "tags": [
                "tdd",
                "code",
                "agile",
                "scrum",
                "bug"
            ]
        },
        {
            "id": "http://davembush.github.com/test-driven-development-kata-roman-to-arabic-in-javascript/",
            "url": "http://davembush.github.com/test-driven-development-kata-roman-to-arabic-in-javascript/",
            "title": "Test Driven Development Kata - Roman to Arabic in JavaScript",
            "date_published": "2016-07-20T10:30:00.000Z",
            "content_html": "<p>Coding Katas are a way of developing your skills as a programmer.  I thought it might be informative to tackle one of the classics as a blog post. Depending on how this works, I may or may not do another one quite so publicly. The rules I’m going to try to adhere by.</p>\n<ol>\n<li>I will document what I am doing as I go.</li>\n<li>This is not a pre-coded blog post.  You’ll get to “see” me code as I go.</li>\n<li>I will write all tests first.</li>\n<li>I will only write enough code to make the current tests succeed.</li>\n</ol>\n<p>  <img src=\"/uploads/2016/07/image-3.png\" alt=\"Test Driven Kata - Roman to Arabic\" title=\"Test Driven Kata - Roman to Arabic\"></p>\n<h2 id=\"Today’s-problem\"><a href=\"#Today’s-problem\" class=\"headerlink\" title=\"Today’s problem:\"></a>Today’s problem:</h2><p>This is a pretty classic coding problem that shows up in interviews, home-work assignments, and code katas.</p>\n<p>As an interview problem, I find it lacking because it typically does not represent the kind of work you will be doing other than proving that you can solve problems in your chosen language.  It is also a standard coding problem, meaning the person interviewing you is using the most obvious problem to see if you can code.  Much like asking “What is your greatest strength?” and “What is your greatest weakness?”  Finally, it takes longer to complete than I believe interview coding problems should.  This is not to say, I don’t jump through these hoops myself.</p>\n<p>As a kata exercise, it is good because there are several ways you might solve the problem.  And for our purposes, it also demonstrates what Test Driven Development might look like using JavaScript.</p>\n<p>So, what is the problem? Write a function that converts Roman numbers into Arabic numbers and throws an error if the Roman number is in an invalid form.</p>\n<p>That sounds pretty easy.  But the first question we need to ask is, “What, exactly are the rules for converting Roman numbers into Arabic numbers?”</p>\n<ol>\n<li>The values for Roman numbers are as follows:</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Roman</th>\n<th align=\"center\">Arabic</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">I</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">V</td>\n<td align=\"center\">5</td>\n</tr>\n<tr>\n<td align=\"center\">X</td>\n<td align=\"center\">10</td>\n</tr>\n<tr>\n<td align=\"center\">L</td>\n<td align=\"center\">50</td>\n</tr>\n<tr>\n<td align=\"center\">C</td>\n<td align=\"center\">100</td>\n</tr>\n<tr>\n<td align=\"center\">D</td>\n<td align=\"center\">500</td>\n</tr>\n<tr>\n<td align=\"center\">M</td>\n<td align=\"center\">1000</td>\n</tr>\n</tbody></table>\n<ol start=\"2\">\n<li>Repeating a number up to three times adds that value three times.</li>\n<li>A Roman ‘digit’ can’t repeat more than three times.  Instead the previous 1, 10, or 100 equivalent value is used to subtract from the next ‘digit’.  That is,</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Roman</th>\n<th align=\"center\">Arabic</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">IV</td>\n<td align=\"center\">4</td>\n</tr>\n<tr>\n<td align=\"center\">IX</td>\n<td align=\"center\">9</td>\n</tr>\n<tr>\n<td align=\"center\">XL</td>\n<td align=\"center\">40</td>\n</tr>\n<tr>\n<td align=\"center\">XC</td>\n<td align=\"center\">90</td>\n</tr>\n<tr>\n<td align=\"center\">CD</td>\n<td align=\"center\">400</td>\n</tr>\n<tr>\n<td align=\"center\">CM</td>\n<td align=\"center\">900</td>\n</tr>\n</tbody></table>\n<ol start=\"4\">\n<li>With the exception of the subtraction rule above, all values must decrease in scale from left to right and are added together.</li>\n</ol>\n<h2 id=\"Test-1\"><a href=\"#Test-1\" class=\"headerlink\" title=\"Test 1\"></a>Test 1</h2><p>Since we will be using JavaScript, the testing framework we will be using is Jasmine.</p>\n<p>Our first test will simply test that when we pass in “I” we get back 1.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&quot;I&quot;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>And the code that passes this test is:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">romanToArabic</span>(<span class=\"params\">romanNumber</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>You might think, what’s the point?  Why just return 1 when you know you are going to have to do more?  Well, when you are doing TDD, you have to work off of what you are testing for now, not what you might test for later.  So, we return 1.</p>\n<h2 id=\"Test-2\"><a href=\"#Test-2\" class=\"headerlink\" title=\"Test 2\"></a>Test 2</h2><p>From here, we can go a couple of different directions.  How about testing for rule 3 next.  How would we do that? To start with, we might just make sure that if we pass in IV, we get back 4.  Now our code is getting a bit more complicated.  But sticking with our TDD principles, we’ll just test for IV.  Another happy path test.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&quot;I&quot;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&quot;IV&quot;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>And the code that implements it:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">romanToArabic</span>(<span class=\"params\">romanNumber</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">switch</span>(romanNumber)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;I&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;IV&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">4</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Test-3\"><a href=\"#Test-3\" class=\"headerlink\" title=\"Test 3\"></a>Test 3</h2><p>OK.  What happens if IV shows up twice?  That should be a failure.  IV should never show up more than once.  In fact, none of the codes that show up in rule three should show up more than once.  Let’s make sure they don’t.</p>\n<p>The tests for this will be pretty simple, and to save time, we will code for all of them at once.  In fact, we are going to eventually need the conversion tables above, so let’s go ahead and put them in now.</p>\n<p>Here is what our test file looks like now.  Notice that we’ve put several tests in at once.</p>\n<p>Notice that I didn’t have to write multiple tests to do this.  I just created one test and iterated over it.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>And the solution also iterates.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">romanToArabic</span>(<span class=\"params\">romanNumber</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// This block is probably inefficient, but it is</span></span><br><span class=\"line\">    <span class=\"comment\">// easy to reason about.</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">           <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(prop,<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">switch</span>(romanNumber)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;I&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;IV&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">4</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Test-4\"><a href=\"#Test-4\" class=\"headerlink\" title=\"Test 4\"></a>Test 4</h2><p>Just to make sure we aren’t counting how many times in a row this all shows up, let’s add a valid Roman Number in between.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27;I&#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy + <span class=\"string\">&#x27;I&#x27;</span> + propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Test-5\"><a href=\"#Test-5\" class=\"headerlink\" title=\"Test 5\"></a>Test 5</h2><p>Next, we need to make sure that none of the items in our base table show up more than 3 times.  We’ll write a similar test to what we’ve already written with a twist.  If any of those numerals show up more than 4 times, we know we have a problem either because they are out of order or because they show up all in a row.  So, we only need to check the count.  If there are four of any of them, we have a problem.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27;I&#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy + <span class=\"string\">&#x27;I&#x27;</span> + propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>And the code to implement it.function romanToArabic(romanNumber){<br>    var minusOneTable &#x3D; {<br>        IV: 4,<br>        IX: 9,<br>        XL: 40,<br>        XC: 90,<br>        CD: 400,<br>        CM: 900<br>    };<br>    var baseTable &#x3D; {<br>        I: 1,<br>        V: 5,<br>        X: 10,<br>        L: 50,<br>        C: 100,<br>        D: 500,<br>        M: 1000<br>    };</p>\n<pre><code>// This block is probably inefficient, but it is\n// easy to reason about.\nfor(var prop in minusOneTable)&#123;\n    if(!minusOneTable.hasOwnProperty(prop))&#123;\n       continue;\n    &#125;\n    var rx = new RegExp(prop,&#39;g&#39;);\n    if((romanNumber.match(rx) || []).length &gt; 1)&#123;\n        throw &#39;Poorly formed Roman number!&#39;;\n    &#125;\n\n&#125;\nfor(var prop in baseTable)&#123;\n    if(!baseTable.hasOwnProperty(prop))&#123;\n        continue;\n    &#125;\n    var rx = new RegExp(prop,&#39;g&#39;);\n    if((romanNumber.match(rx) || []).length &gt; 3)&#123;\n        throw &#39;Poorly formed Roman number!&#39;;\n    &#125;\n\n&#125;\n\nswitch(romanNumber)&#123;\n    case &#39;I&#39;:\n        return 1;\n    case &#39;IV&#39;:\n        return 4;\n&#125;\n</code></pre>\n<p>}</p>\n<h2 id=\"Test-6\"><a href=\"#Test-6\" class=\"headerlink\" title=\"Test 6\"></a>Test 6</h2><p>So, before we move on to actually computing the value of the Roman number, we should ask ourselves if there are any other ways a Roman number could be passed in incorrectly.</p>\n<p>The next one that occurs to me is this.  If you have a number that contains a ‘digit’ from the minusOneTable, the character that is used to subtract should never follow the digit.  For example, if “IV” shows up, there should not be an “I” immediately after it.  That is, we shouldn’t see “IVI” anywhere in our string.  So let’s add that to our tests.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27;I&#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy + <span class=\"string\">&#x27;I&#x27;</span> + propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> newProp = prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + newProp + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,newProp));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>And the code to implement it:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">romanToArabic</span>(<span class=\"params\">romanNumber</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// This block is probably inefficient, but it is</span></span><br><span class=\"line\">    <span class=\"comment\">// easy to reason about.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> rx;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">           <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(prop,<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>),<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(prop,<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">3</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">switch</span>(romanNumber)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;I&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;IV&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">4</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-7\"><a href=\"#Step-7\" class=\"headerlink\" title=\"Step 7\"></a>Step 7</h2><p>There is one more possible problem we could encounter.  What if someone passes in a character that isn’t a valid Roman number character.  We need to make sure that the only characters that show up are Roman number characters.</p>\n<p>Since testing for all of the characters isn’t practical, we are just going to test for a few and assume that if this were a real business problem we’d go to the trouble of testing more.  But, the basic test is going to look the same.  Toss in bad characters in an otherwise valid string and make sure we throw an error.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27;I&#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy + <span class=\"string\">&#x27;I&#x27;</span> + propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> newProp = prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + newProp + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,newProp));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> invalidCharacters = &#123;<span class=\"attr\">A</span>:<span class=\"number\">1</span>,<span class=\"attr\">a</span>:<span class=\"number\">1</span>,<span class=\"string\">&#x27;2&#x27;</span>: <span class=\"number\">1</span>, <span class=\"attr\">i</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> invalidCharacters)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!invalidCharacters.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>And the solution, which is pretty simple:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">romanToArabic</span>(<span class=\"params\">romanNumber</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// This block is probably inefficient, but it is</span></span><br><span class=\"line\">    <span class=\"comment\">// easy to reason about.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> rx;</span><br><span class=\"line\">    <span class=\"comment\">// make sure minusOne only shows up once</span></span><br><span class=\"line\">    <span class=\"comment\">// and first character isn&#x27;t also the last character. (IVI for example)</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">           <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(prop,<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>),<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> included = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">    <span class=\"comment\">// make sure digits only show up 3 times</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        included += prop;</span><br><span class=\"line\">        rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(prop,<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">3</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// make sure only I, V, X, L, C and D are the only characters that show up</span></span><br><span class=\"line\">    rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(<span class=\"string\">&#x27;[^&#x27;</span> + included + <span class=\"string\">&#x27;]&#x27;</span>,<span class=\"string\">&#x27;g&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">switch</span>(romanNumber)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;I&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;IV&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">4</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-8\"><a href=\"#Step-8\" class=\"headerlink\" title=\"Step 8\"></a>Step 8</h2><p>OK. I think that gets all of the validations except for ensuring that the numbers show up in numerical order.  To make this work, we are going to need to work through the array and assign each digit a value.  The test we need to write is going to put values in the wrong order.</p>\n<p>Our test will put the next value up after the value.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27;I&#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy + <span class=\"string\">&#x27;I&#x27;</span> + propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> newProp = prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + newProp + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,newProp));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> invalidCharacters = &#123;<span class=\"attr\">A</span>:<span class=\"number\">1</span>,<span class=\"attr\">a</span>:<span class=\"number\">1</span>,<span class=\"string\">&#x27;2&#x27;</span>: <span class=\"number\">1</span>, <span class=\"attr\">i</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> invalidCharacters)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!invalidCharacters.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> badOrderPairs = &#123;<span class=\"attr\">DM</span>: <span class=\"number\">1</span>, <span class=\"attr\">LC</span>: <span class=\"number\">1</span>, <span class=\"attr\">VX</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXXL</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXM</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> badOrderPairs)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!badOrderPairs.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>And the solution will put them in order and add them along the way.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">romanToArabic</span>(<span class=\"params\">romanNumber</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneSub = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"string\">&#x27;v&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"string\">&#x27;x&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"string\">&#x27;l&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"string\">&#x27;c&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"string\">&#x27;d&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"string\">&#x27;m&#x27;</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> compositeValueTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">v</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">x</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">l</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">c</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">d</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">m</span>: <span class=\"number\">900</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// This block is probably inefficient, but it is</span></span><br><span class=\"line\">    <span class=\"comment\">// easy to reason about.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> rx;</span><br><span class=\"line\">    <span class=\"comment\">// make sure minusOne only shows up once</span></span><br><span class=\"line\">    <span class=\"comment\">// and first character isn&#x27;t also the last character. (IVI for example)</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">           <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(prop,<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>),<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> included = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">    <span class=\"comment\">// make sure digits only show up 3 times</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        included += prop;</span><br><span class=\"line\">        rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(prop,<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">3</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// make sure only I, V, X, L, C and D are the only characters that show up</span></span><br><span class=\"line\">    rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(<span class=\"string\">&#x27;[^&#x27;</span> + included + <span class=\"string\">&#x27;]&#x27;</span>,<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>((romanNumber.<span class=\"title function_\">match</span>(rx) || []).<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// substitute the minusOnes with tokens we can use to compute value.</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        rx = <span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(prop,<span class=\"string\">&#x27;g&#x27;</span>);</span><br><span class=\"line\">        romanNumber = romanNumber.<span class=\"title function_\">replace</span>(rx,minusOneSub[prop]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> romanNumberArray = romanNumber.<span class=\"title function_\">split</span>(<span class=\"string\">&#x27;&#x27;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> lastValue = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> currentValue = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> numberIndex = <span class=\"number\">0</span>;numberIndex &lt; romanNumberArray.<span class=\"property\">length</span>;numberIndex++)&#123;</span><br><span class=\"line\">        currentValue = compositeValueTable[romanNumberArray[numberIndex]];</span><br><span class=\"line\">        returnValue += currentValue;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(numberIndex &gt; <span class=\"number\">0</span> &amp;&amp; currentValue &gt; lastValue)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        lastValue = currentValue;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> returnValue;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// switch(romanNumber)&#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//     case &#x27;I&#x27;:</span></span><br><span class=\"line\">    <span class=\"comment\">//         return 1;</span></span><br><span class=\"line\">    <span class=\"comment\">//     case &#x27;IV&#x27;:</span></span><br><span class=\"line\">    <span class=\"comment\">//         return 4;</span></span><br><span class=\"line\">    <span class=\"comment\">// &#125;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-9\"><a href=\"#Step-9\" class=\"headerlink\" title=\"Step 9\"></a>Step 9</h2><p>And finally we add some test to verify that we get the right result.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27;I&#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy + <span class=\"string\">&#x27;I&#x27;</span> + propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> newProp = prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + newProp + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,newProp));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> invalidCharacters = &#123;<span class=\"attr\">A</span>:<span class=\"number\">1</span>,<span class=\"attr\">a</span>:<span class=\"number\">1</span>,<span class=\"string\">&#x27;2&#x27;</span>: <span class=\"number\">1</span>, <span class=\"attr\">i</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> invalidCharacters)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!invalidCharacters.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> badOrderPairs = &#123;<span class=\"attr\">DM</span>: <span class=\"number\">1</span>, <span class=\"attr\">LC</span>: <span class=\"number\">1</span>, <span class=\"attr\">VX</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXXL</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXM</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> badOrderPairs)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!badOrderPairs.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> romanNumbers = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">II</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">        <span class=\"attr\">III</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">VI</span>: <span class=\"number\">6</span>,</span><br><span class=\"line\">        <span class=\"attr\">VII</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">VIII</span>: <span class=\"number\">8</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">XI</span>: <span class=\"number\">11</span>,</span><br><span class=\"line\">        <span class=\"attr\">XII</span>: <span class=\"number\">12</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIII</span>: <span class=\"number\">13</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIV</span>: <span class=\"number\">14</span>,</span><br><span class=\"line\">        <span class=\"attr\">XV</span>: <span class=\"number\">15</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVI</span>: <span class=\"number\">16</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVII</span>: <span class=\"number\">17</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVIII</span>: <span class=\"number\">18</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIX</span>: <span class=\"number\">19</span>,</span><br><span class=\"line\">        <span class=\"attr\">XX</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXI</span>: <span class=\"number\">21</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXII</span>: <span class=\"number\">22</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIII</span>: <span class=\"number\">23</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIV</span>: <span class=\"number\">24</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXV</span>: <span class=\"number\">25</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVI</span>: <span class=\"number\">26</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVII</span>: <span class=\"number\">27</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVIII</span>: <span class=\"number\">28</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIX</span>: <span class=\"number\">29</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXX</span>: <span class=\"number\">30</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLIV</span>: <span class=\"number\">44</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLV</span>: <span class=\"number\">45</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLVI</span>: <span class=\"number\">46</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">LIV</span>: <span class=\"number\">54</span>,</span><br><span class=\"line\">        <span class=\"attr\">LV</span>: <span class=\"number\">55</span>,</span><br><span class=\"line\">        <span class=\"attr\">LVI</span>: <span class=\"number\">56</span>,</span><br><span class=\"line\">        <span class=\"attr\">LX</span>: <span class=\"number\">60</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">CI</span>: <span class=\"number\">101</span>,</span><br><span class=\"line\">        <span class=\"attr\">CXI</span>: <span class=\"number\">111</span>,</span><br><span class=\"line\">        <span class=\"attr\">CMXCIX</span>: <span class=\"number\">999</span>,</span><br><span class=\"line\">        <span class=\"attr\">MDCLXVI</span>: <span class=\"number\">1666</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> romanNumbers)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!romanNumbers.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                returnValue = <span class=\"title function_\">romanToArabic</span>(propCopy);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(romanNumbers[propCopy]);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Review\"><a href=\"#Review\" class=\"headerlink\" title=\"Review\"></a>Review</h2><p>What?! I thought we were done? Well, we are and we aren’t.  We have code that works.  But is it the best code we can write? Here is what I like about this code:</p>\n<ol>\n<li>It is easy to reason about.</li>\n<li>It allows me to add additional roman numbers by expanding my tables.  No additional code would be needed. (And while it is hard to represent using Arabic letters, there are additional symbols.)</li>\n<li>It works reasonably fast.</li>\n</ol>\n<p>But, it does seem to me that we might make it a bit more efficient without sacrificing these advantages too much.  And the great news is, since we have our test in place, we can refactor with impunity.  No worries about breaking something because we will know as soon as we have and we can revert back to the code that was working.</p>\n<h2 id=\"Step-12\"><a href=\"#Step-12\" class=\"headerlink\" title=\"Step 12\"></a>Step 12</h2><p>One pretty simple change we can make is that our error message is scattered throughout our code.  Let’s make that a variable and just throw the variable.</p>\n<p>The other thing I wonder about is how much of our validations can be combined? One check we might safely eliminate at this point is the check to make sure the minus values only show up once.  If any of them were to show up more than once, they would either show up one after the other, which we still can check for, or they would be in the wrong value order which our final check will catch.  So, let’s eliminate that code as well and re-run our tests to make sure nothing broke.</p>\n<p>And now that we’ve eliminated that check, we can create one big string for checking conditions like “IVI” into one string and check it once instead of creating a new RegExp object multiple times.</p>\n<p>Here is the code we have so far:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27;I&#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy + <span class=\"string\">&#x27;I&#x27;</span> + propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> newProp = prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + newProp + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,newProp));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> invalidCharacters = &#123;<span class=\"attr\">A</span>:<span class=\"number\">1</span>,<span class=\"attr\">a</span>:<span class=\"number\">1</span>,<span class=\"string\">&#x27;2&#x27;</span>: <span class=\"number\">1</span>, <span class=\"attr\">i</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> invalidCharacters)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!invalidCharacters.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> badOrderPairs = &#123;<span class=\"attr\">DM</span>: <span class=\"number\">1</span>, <span class=\"attr\">LC</span>: <span class=\"number\">1</span>, <span class=\"attr\">VX</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXXL</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXM</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> badOrderPairs)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!badOrderPairs.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> romanNumbers = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">II</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">        <span class=\"attr\">III</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">VI</span>: <span class=\"number\">6</span>,</span><br><span class=\"line\">        <span class=\"attr\">VII</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">VIII</span>: <span class=\"number\">8</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">XI</span>: <span class=\"number\">11</span>,</span><br><span class=\"line\">        <span class=\"attr\">XII</span>: <span class=\"number\">12</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIII</span>: <span class=\"number\">13</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIV</span>: <span class=\"number\">14</span>,</span><br><span class=\"line\">        <span class=\"attr\">XV</span>: <span class=\"number\">15</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVI</span>: <span class=\"number\">16</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVII</span>: <span class=\"number\">17</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVIII</span>: <span class=\"number\">18</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIX</span>: <span class=\"number\">19</span>,</span><br><span class=\"line\">        <span class=\"attr\">XX</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXI</span>: <span class=\"number\">21</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXII</span>: <span class=\"number\">22</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIII</span>: <span class=\"number\">23</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIV</span>: <span class=\"number\">24</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXV</span>: <span class=\"number\">25</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVI</span>: <span class=\"number\">26</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVII</span>: <span class=\"number\">27</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVIII</span>: <span class=\"number\">28</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIX</span>: <span class=\"number\">29</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXX</span>: <span class=\"number\">30</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLIV</span>: <span class=\"number\">44</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLV</span>: <span class=\"number\">45</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLVI</span>: <span class=\"number\">46</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">LIV</span>: <span class=\"number\">54</span>,</span><br><span class=\"line\">        <span class=\"attr\">LV</span>: <span class=\"number\">55</span>,</span><br><span class=\"line\">        <span class=\"attr\">LVI</span>: <span class=\"number\">56</span>,</span><br><span class=\"line\">        <span class=\"attr\">LX</span>: <span class=\"number\">60</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">CI</span>: <span class=\"number\">101</span>,</span><br><span class=\"line\">        <span class=\"attr\">CXI</span>: <span class=\"number\">111</span>,</span><br><span class=\"line\">        <span class=\"attr\">CMXCIX</span>: <span class=\"number\">999</span>,</span><br><span class=\"line\">        <span class=\"attr\">MDCLXVI</span>: <span class=\"number\">1666</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> romanNumbers)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!romanNumbers.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                returnValue = <span class=\"title function_\">romanToArabic</span>(propCopy);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(romanNumbers[propCopy]);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-11\"><a href=\"#Step-11\" class=\"headerlink\" title=\"Step 11\"></a>Step 11</h2><p>Now that we have our IVI check down to one string, it occurs to me that we can combine this check with our invalid character check.  So, let’s do that next.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27;I&#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy + <span class=\"string\">&#x27;I&#x27;</span> + propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> newProp = prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + newProp + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,newProp));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> invalidCharacters = &#123;<span class=\"attr\">A</span>:<span class=\"number\">1</span>,<span class=\"attr\">a</span>:<span class=\"number\">1</span>,<span class=\"string\">&#x27;2&#x27;</span>: <span class=\"number\">1</span>, <span class=\"attr\">i</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> invalidCharacters)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!invalidCharacters.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> badOrderPairs = &#123;<span class=\"attr\">DM</span>: <span class=\"number\">1</span>, <span class=\"attr\">LC</span>: <span class=\"number\">1</span>, <span class=\"attr\">VX</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXXL</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXM</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> badOrderPairs)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!badOrderPairs.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> romanNumbers = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">II</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">        <span class=\"attr\">III</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">VI</span>: <span class=\"number\">6</span>,</span><br><span class=\"line\">        <span class=\"attr\">VII</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">VIII</span>: <span class=\"number\">8</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">XI</span>: <span class=\"number\">11</span>,</span><br><span class=\"line\">        <span class=\"attr\">XII</span>: <span class=\"number\">12</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIII</span>: <span class=\"number\">13</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIV</span>: <span class=\"number\">14</span>,</span><br><span class=\"line\">        <span class=\"attr\">XV</span>: <span class=\"number\">15</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVI</span>: <span class=\"number\">16</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVII</span>: <span class=\"number\">17</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVIII</span>: <span class=\"number\">18</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIX</span>: <span class=\"number\">19</span>,</span><br><span class=\"line\">        <span class=\"attr\">XX</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXI</span>: <span class=\"number\">21</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXII</span>: <span class=\"number\">22</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIII</span>: <span class=\"number\">23</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIV</span>: <span class=\"number\">24</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXV</span>: <span class=\"number\">25</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVI</span>: <span class=\"number\">26</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVII</span>: <span class=\"number\">27</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVIII</span>: <span class=\"number\">28</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIX</span>: <span class=\"number\">29</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXX</span>: <span class=\"number\">30</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLIV</span>: <span class=\"number\">44</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLV</span>: <span class=\"number\">45</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLVI</span>: <span class=\"number\">46</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">LIV</span>: <span class=\"number\">54</span>,</span><br><span class=\"line\">        <span class=\"attr\">LV</span>: <span class=\"number\">55</span>,</span><br><span class=\"line\">        <span class=\"attr\">LVI</span>: <span class=\"number\">56</span>,</span><br><span class=\"line\">        <span class=\"attr\">LX</span>: <span class=\"number\">60</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">CI</span>: <span class=\"number\">101</span>,</span><br><span class=\"line\">        <span class=\"attr\">CXI</span>: <span class=\"number\">111</span>,</span><br><span class=\"line\">        <span class=\"attr\">CMXCIX</span>: <span class=\"number\">999</span>,</span><br><span class=\"line\">        <span class=\"attr\">MDCLXVI</span>: <span class=\"number\">1666</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> romanNumbers)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!romanNumbers.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                returnValue = <span class=\"title function_\">romanToArabic</span>(propCopy);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(romanNumbers[propCopy]);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-12-1\"><a href=\"#Step-12-1\" class=\"headerlink\" title=\"Step 12\"></a>Step 12</h2><p>And the last place we can optimize is our three digit check.  But instead of limiting it to valid Roman numbers, let’s just check for any sequence of characters that repeats 4 times or more.</p>\n<p>And once we know that is working, we can combine it with our other Regular Expressions.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27;I&#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy + <span class=\"string\">&#x27;I&#x27;</span> + propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> newProp = prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + newProp + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,newProp));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> invalidCharacters = &#123;<span class=\"attr\">A</span>:<span class=\"number\">1</span>,<span class=\"attr\">a</span>:<span class=\"number\">1</span>,<span class=\"string\">&#x27;2&#x27;</span>: <span class=\"number\">1</span>, <span class=\"attr\">i</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> invalidCharacters)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!invalidCharacters.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> badOrderPairs = &#123;<span class=\"attr\">DM</span>: <span class=\"number\">1</span>, <span class=\"attr\">LC</span>: <span class=\"number\">1</span>, <span class=\"attr\">VX</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXXL</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXM</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> badOrderPairs)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!badOrderPairs.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> romanNumbers = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">II</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">        <span class=\"attr\">III</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">VI</span>: <span class=\"number\">6</span>,</span><br><span class=\"line\">        <span class=\"attr\">VII</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">VIII</span>: <span class=\"number\">8</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">XI</span>: <span class=\"number\">11</span>,</span><br><span class=\"line\">        <span class=\"attr\">XII</span>: <span class=\"number\">12</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIII</span>: <span class=\"number\">13</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIV</span>: <span class=\"number\">14</span>,</span><br><span class=\"line\">        <span class=\"attr\">XV</span>: <span class=\"number\">15</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVI</span>: <span class=\"number\">16</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVII</span>: <span class=\"number\">17</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVIII</span>: <span class=\"number\">18</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIX</span>: <span class=\"number\">19</span>,</span><br><span class=\"line\">        <span class=\"attr\">XX</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXI</span>: <span class=\"number\">21</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXII</span>: <span class=\"number\">22</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIII</span>: <span class=\"number\">23</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIV</span>: <span class=\"number\">24</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXV</span>: <span class=\"number\">25</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVI</span>: <span class=\"number\">26</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVII</span>: <span class=\"number\">27</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVIII</span>: <span class=\"number\">28</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIX</span>: <span class=\"number\">29</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXX</span>: <span class=\"number\">30</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLIV</span>: <span class=\"number\">44</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLV</span>: <span class=\"number\">45</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLVI</span>: <span class=\"number\">46</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">LIV</span>: <span class=\"number\">54</span>,</span><br><span class=\"line\">        <span class=\"attr\">LV</span>: <span class=\"number\">55</span>,</span><br><span class=\"line\">        <span class=\"attr\">LVI</span>: <span class=\"number\">56</span>,</span><br><span class=\"line\">        <span class=\"attr\">LX</span>: <span class=\"number\">60</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">CI</span>: <span class=\"number\">101</span>,</span><br><span class=\"line\">        <span class=\"attr\">CXI</span>: <span class=\"number\">111</span>,</span><br><span class=\"line\">        <span class=\"attr\">CMXCIX</span>: <span class=\"number\">999</span>,</span><br><span class=\"line\">        <span class=\"attr\">MDCLXVI</span>: <span class=\"number\">1666</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> romanNumbers)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!romanNumbers.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                returnValue = <span class=\"title function_\">romanToArabic</span>(propCopy);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(romanNumbers[propCopy]);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-13\"><a href=\"#Step-13\" class=\"headerlink\" title=\"Step 13\"></a>Step 13</h2><p>We’ve cleaned up about all of the logic we can without hard coding the values.  But I would like to combine the lookup tables next.  I don’t like having three tables.  Let’s see if we can pull those into one table.</p>\n<p>The first step to doing this is combining the minusOneTable and baseTable into one table.  To differentiate in the code that is using those tables, we’ll just look at the length of the property.</p>\n<p>In the process of doing this, we notice that it would also make sense to combine the substitution table.  And since the values we’ve assigned to the table aren’t even being used at this point, we’ll just use the substitutions instead of the values.</p>\n<p>And if we make the value of each element in the baseTable an array, we could combine the values into that table as well.  But that would over complicate our lookup logic when we compute the value.  So, I think we’ll just leave that as it is.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27;I&#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy + <span class=\"string\">&#x27;I&#x27;</span> + propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> newProp = prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + newProp + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,newProp));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> invalidCharacters = &#123;<span class=\"attr\">A</span>:<span class=\"number\">1</span>,<span class=\"attr\">a</span>:<span class=\"number\">1</span>,<span class=\"string\">&#x27;2&#x27;</span>: <span class=\"number\">1</span>, <span class=\"attr\">i</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> invalidCharacters)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!invalidCharacters.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> badOrderPairs = &#123;<span class=\"attr\">DM</span>: <span class=\"number\">1</span>, <span class=\"attr\">LC</span>: <span class=\"number\">1</span>, <span class=\"attr\">VX</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXXL</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXM</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> badOrderPairs)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!badOrderPairs.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> romanNumbers = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">II</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">        <span class=\"attr\">III</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">VI</span>: <span class=\"number\">6</span>,</span><br><span class=\"line\">        <span class=\"attr\">VII</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">VIII</span>: <span class=\"number\">8</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">XI</span>: <span class=\"number\">11</span>,</span><br><span class=\"line\">        <span class=\"attr\">XII</span>: <span class=\"number\">12</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIII</span>: <span class=\"number\">13</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIV</span>: <span class=\"number\">14</span>,</span><br><span class=\"line\">        <span class=\"attr\">XV</span>: <span class=\"number\">15</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVI</span>: <span class=\"number\">16</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVII</span>: <span class=\"number\">17</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVIII</span>: <span class=\"number\">18</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIX</span>: <span class=\"number\">19</span>,</span><br><span class=\"line\">        <span class=\"attr\">XX</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXI</span>: <span class=\"number\">21</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXII</span>: <span class=\"number\">22</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIII</span>: <span class=\"number\">23</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIV</span>: <span class=\"number\">24</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXV</span>: <span class=\"number\">25</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVI</span>: <span class=\"number\">26</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVII</span>: <span class=\"number\">27</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVIII</span>: <span class=\"number\">28</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIX</span>: <span class=\"number\">29</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXX</span>: <span class=\"number\">30</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLIV</span>: <span class=\"number\">44</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLV</span>: <span class=\"number\">45</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLVI</span>: <span class=\"number\">46</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">LIV</span>: <span class=\"number\">54</span>,</span><br><span class=\"line\">        <span class=\"attr\">LV</span>: <span class=\"number\">55</span>,</span><br><span class=\"line\">        <span class=\"attr\">LVI</span>: <span class=\"number\">56</span>,</span><br><span class=\"line\">        <span class=\"attr\">LX</span>: <span class=\"number\">60</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">CI</span>: <span class=\"number\">101</span>,</span><br><span class=\"line\">        <span class=\"attr\">CXI</span>: <span class=\"number\">111</span>,</span><br><span class=\"line\">        <span class=\"attr\">CMXCIX</span>: <span class=\"number\">999</span>,</span><br><span class=\"line\">        <span class=\"attr\">MDCLXVI</span>: <span class=\"number\">1666</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> romanNumbers)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!romanNumbers.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                returnValue = <span class=\"title function_\">romanToArabic</span>(propCopy);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(romanNumbers[propCopy]);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-14\"><a href=\"#Step-14\" class=\"headerlink\" title=\"Step 14\"></a>Step 14</h2><p>Finally, I think we want to consolidate the loops into one loop.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> returnValue;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> minusOneTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">CD</span>: <span class=\"number\">400</span>,</span><br><span class=\"line\">        <span class=\"attr\">CM</span>: <span class=\"number\">900</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> baseTable = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">D</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">        <span class=\"attr\">M</span>: <span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When I is passed in&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;I&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When IV is passed in&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            returnValue = <span class=\"title function_\">romanToArabic</span>(<span class=\"string\">&#x27;IV&#x27;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return 4&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(<span class=\"number\">4</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prop;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27;I&#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy + <span class=\"string\">&#x27;I&#x27;</span> + propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> baseTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!baseTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> minusOneTable)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!minusOneTable.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> newProp = prop + prop.<span class=\"title function_\">substr</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + newProp + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,newProp));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> invalidCharacters = &#123;<span class=\"attr\">A</span>:<span class=\"number\">1</span>,<span class=\"attr\">a</span>:<span class=\"number\">1</span>,<span class=\"string\">&#x27;2&#x27;</span>: <span class=\"number\">1</span>, <span class=\"attr\">i</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> invalidCharacters)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!invalidCharacters.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> badOrderPairs = &#123;<span class=\"attr\">DM</span>: <span class=\"number\">1</span>, <span class=\"attr\">LC</span>: <span class=\"number\">1</span>, <span class=\"attr\">VX</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXXL</span>: <span class=\"number\">1</span>, <span class=\"attr\">IXM</span>: <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> badOrderPairs)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!badOrderPairs.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should throw an exception&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;<span class=\"title function_\">romanToArabic</span>(propCopy)&#125;).<span class=\"title function_\">toThrow</span>();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> romanNumbers = &#123;</span><br><span class=\"line\">        <span class=\"attr\">I</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">II</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">        <span class=\"attr\">III</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">        <span class=\"attr\">IV</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">        <span class=\"attr\">V</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">VI</span>: <span class=\"number\">6</span>,</span><br><span class=\"line\">        <span class=\"attr\">VII</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">VIII</span>: <span class=\"number\">8</span>,</span><br><span class=\"line\">        <span class=\"attr\">IX</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">        <span class=\"attr\">X</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">XI</span>: <span class=\"number\">11</span>,</span><br><span class=\"line\">        <span class=\"attr\">XII</span>: <span class=\"number\">12</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIII</span>: <span class=\"number\">13</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIV</span>: <span class=\"number\">14</span>,</span><br><span class=\"line\">        <span class=\"attr\">XV</span>: <span class=\"number\">15</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVI</span>: <span class=\"number\">16</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVII</span>: <span class=\"number\">17</span>,</span><br><span class=\"line\">        <span class=\"attr\">XVIII</span>: <span class=\"number\">18</span>,</span><br><span class=\"line\">        <span class=\"attr\">XIX</span>: <span class=\"number\">19</span>,</span><br><span class=\"line\">        <span class=\"attr\">XX</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXI</span>: <span class=\"number\">21</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXII</span>: <span class=\"number\">22</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIII</span>: <span class=\"number\">23</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIV</span>: <span class=\"number\">24</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXV</span>: <span class=\"number\">25</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVI</span>: <span class=\"number\">26</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVII</span>: <span class=\"number\">27</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXVIII</span>: <span class=\"number\">28</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXIX</span>: <span class=\"number\">29</span>,</span><br><span class=\"line\">        <span class=\"attr\">XXX</span>: <span class=\"number\">30</span>,</span><br><span class=\"line\">        <span class=\"attr\">XL</span>: <span class=\"number\">40</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLIV</span>: <span class=\"number\">44</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLV</span>: <span class=\"number\">45</span>,</span><br><span class=\"line\">        <span class=\"attr\">XLVI</span>: <span class=\"number\">46</span>,</span><br><span class=\"line\">        <span class=\"attr\">L</span>: <span class=\"number\">50</span>,</span><br><span class=\"line\">        <span class=\"attr\">LIV</span>: <span class=\"number\">54</span>,</span><br><span class=\"line\">        <span class=\"attr\">LV</span>: <span class=\"number\">55</span>,</span><br><span class=\"line\">        <span class=\"attr\">LVI</span>: <span class=\"number\">56</span>,</span><br><span class=\"line\">        <span class=\"attr\">LX</span>: <span class=\"number\">60</span>,</span><br><span class=\"line\">        <span class=\"attr\">XC</span>: <span class=\"number\">90</span>,</span><br><span class=\"line\">        <span class=\"attr\">C</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">        <span class=\"attr\">CI</span>: <span class=\"number\">101</span>,</span><br><span class=\"line\">        <span class=\"attr\">CXI</span>: <span class=\"number\">111</span>,</span><br><span class=\"line\">        <span class=\"attr\">CMXCIX</span>: <span class=\"number\">999</span>,</span><br><span class=\"line\">        <span class=\"attr\">MDCLXVI</span>: <span class=\"number\">1666</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(prop <span class=\"keyword\">in</span> romanNumbers)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!romanNumbers.<span class=\"title function_\">hasOwnProperty</span>(prop))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"title function_\">describe</span>(<span class=\"string\">&#x27;When &#x27;</span> + prop + <span class=\"string\">&#x27; is added&#x27;</span>,(<span class=\"keyword\">function</span>(<span class=\"params\">propCopy</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">beforeEach</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">                returnValue = <span class=\"title function_\">romanToArabic</span>(propCopy);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"title function_\">it</span>(<span class=\"string\">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">expect</span>(returnValue).<span class=\"title function_\">toBe</span>(romanNumbers[propCopy]);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>,prop));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Review-1\"><a href=\"#Review-1\" class=\"headerlink\" title=\"Review\"></a>Review</h2><p>There are probably a few other optimizations that could be made here.  But I’m afraid that each would sacrifice either the flexibility.  That is, we could hard code the regular expression validations, which would significantly reduce the number of lines of code.  Or we would sacrifice the readability.  Neither of which I am willing to do.</p>\n<p>If you are only interested in the result, you can find the finished project at <a href=\"//github.com/DaveMBush/JavaScriptKatas\" title=\"https://github.com/DaveMBush/JavaScriptKatas\">https://github.com/DaveMBush/JavaScriptKatas</a></p>\n",
            "tags": [
                "tdd",
                "javascript",
                "kata"
            ]
        },
        {
            "id": "http://davembush.github.com/3-reasons-you-believe-100-code-coverage-is-impossible/",
            "url": "http://davembush.github.com/3-reasons-you-believe-100-code-coverage-is-impossible/",
            "title": "3 Reasons You Believe 100% Code Coverage Is Impossible",
            "date_published": "2016-05-26T10:30:00.000Z",
            "content_html": "<p>I’ve written about <a href=\"/categories/TDD/\">Test Driven Development</a> before.  I’ve even written about <a href=\"/100-code-coverage/\">100% code coverage</a> before.  And I haven’t written much about it recently because I’ve been focused on JavaScript.  But, I’ve been thinking about the 100% code coverage debate more and I have a few more thoughts on the subject.</p>\n<p>You see, the more I practice Test Driven Development, the more inclined I am to believe that there are only three reasons for arguing against 100% code coverage.</p>\n<p><img src=\"/uploads/2016/05/image-2.png\" alt=\"100% Code Coverage\" title=\"100% Code Coverage\"></p>\n<h2 id=\"There-is-Something-Wrong-with-Your-Framework\"><a href=\"#There-is-Something-Wrong-with-Your-Framework\" class=\"headerlink\" title=\"There is Something Wrong with Your Framework\"></a>There is Something Wrong with Your Framework</h2><p>This will be the easiest one for most people to accept.  It isn’t so personal.</p>\n<p>You see, I’ve been learning <a href=\"/tags/react-js/\">React JS</a> and, as I’ve mentioned before, I decided to learn React AND learn to test it at the same time.  The thing that has impressed me from the outset is that ALL the code that I write is testable.  Where a lot of other frameworks are testable except for the View, React JS is ALL testable.</p>\n<p>And this got me to thinking, if all the code you write is testable, why wouldn’t you write tests?  In fact, as I wrote in “<a href=\"/test-driven-learning-an-experiment/\">Test Driven Learning, an Experiment</a>”, the process of writing the tests as I go has helped me understand React JS better than if I had not.</p>\n<p>But compare this to other frameworks where the View is basically HTML.  There is no really easy way to write tests for HTML.  At least, none that I know about.</p>\n<p>And then there are frameworks that seem to do all they can to make it hard to test.  When I was using Ext JS 4.x, I spent two years looking for a way to make my code testable without having to have the View rendered because the way they had implemented “MVC” made loading the view mandatory.  Talk about tight coupling!  Fortunately, now that they’ve implemented MVVM, if you do this correctly, it solves these problems.</p>\n<p>Another place where I found testing difficult was with Angular 1.  Most of Angular 1 is quite testable.  It was created with testing in mind.  But as I was trying to add a <a href=\"//docs.angularjs.org/guide/decorators\">decorator</a> to the <a href=\"//ui-grid.info/\">UI Grid</a> component, I found that testing the decorator was quite difficult.  This, I believe, said more about how the UI Grid component had been created than about how the Angular framework was put together.  But this just illustrates my point.  Sometimes, the reason you can’t test has more to do with the tools you are using than any other reason.</p>\n<p>Then again, the problem may be you.</p>\n<h2 id=\"There-is-Something-Wrong-with-Your-Code\"><a href=\"#There-is-Something-Wrong-with-Your-Code\" class=\"headerlink\" title=\"There is Something Wrong with Your Code\"></a>There is Something Wrong with Your Code</h2><p>Now, arguably, in my last example, the reason I was not able to test the decorator for my Grid was because I was missing some fundamental concept related to testing decorators in general or how that related to the Grid.</p>\n<p>The reason I say this is because the one thing I’ve noticed the more I test is this.  The more I practice TDD, the easier TDD becomes.</p>\n<p>As I introduce testing into the organizations I work with and as I’ve grown in my own TDD skills, the one thing I’ve noticed is that when we start out learning TDD, it almost always starts out as DDT.  That is, Development Driven Testing.</p>\n<p>This is, of course, better than not testing at all, but if you wait until after you’ve written your code, or you develop your code without thinking about how you will test it, you will almost always end up in a situation where you will have to rearrange your code to make it testable.  Untestable code is probably the single biggest reason why code doesn’t get tested.</p>\n<p>If you were able to make yourself write your tests first, you would be much more likely to write test for everything you wrote.</p>\n<p>This doesn’t help you though if you’ve been tasked with writing tests for all pre-existing code.  Yours on someone else’s.  In this case, the best help I can give you is to recommend the book “<a href=\"/qayn\">Working Effectively With Legacy Code</a>” where Michael Feathers illustrates how to handle a lot of the common scenarios he has run into with various languages and how to untangle the mess so that it can be tested.  I will admit it is a tedious read, but there really is no better resource on the topic.</p>\n<h2 id=\"Lack-of-Experience\"><a href=\"#Lack-of-Experience\" class=\"headerlink\" title=\"Lack of Experience\"></a>Lack of Experience</h2><p>The final reason you might want to think that 100% code coverage is impossible is that you simply don’t have enough experience.</p>\n<p>As I mentioned above, my own experience has been that the more I practice TDD, the easier it gets.  When I started out, I struggled to write test at all.  Then I got to a point where I would at least attempt to write tests after I’d written some code.  I’m now at the point where I’m writing tests as I code.  Soon, I hope to achieve the ultimate goal of writing test prior to writing the real code.  But even though I wasn’t writing the tests first, I can still say that the tests were driving my development because I knew at some point, I was going to have to test the code with unit tests.</p>\n<p>But as I’ve monitored the noise on the Internet about using TDD or not.  As people have discussed how much of their code should be tested.  I wonder, “Just how long has this person been trying to tests?”  Along with that, I wonder, “Do they even want to test?”  My dad used to say, “It is amazing how much I don’t understand when it doesn’t fit my plan.” Let’s face it, for most programmers, writing tests is not nearly as much fun as writing the application.  If this is true, then aren’t you already biased against writing tests for your application?  Wouldn’t you much rather write the app and toss it over the fence for someone else to tests?  I know I would.</p>\n<p>Now combine that with the fact that testing is hard, and you have a recipe for excusing yourself from testing as much of your code as possible.</p>\n<p>But, if you stick with it.  If you make writing bug free code a personal challenge, you will find that the rewards are worth it.</p>\n<p>What would it be like to be THE developer who was always working on new features because no one could find bugs in the features you programmed in the past?  What would that do for your career?</p>\n<h2 id=\"The-100-Code-Coverage-Payoff\"><a href=\"#The-100-Code-Coverage-Payoff\" class=\"headerlink\" title=\"The 100% Code Coverage Payoff\"></a>The 100% Code Coverage Payoff</h2><p>I want to conclude with another story that illustrates how writing tests paid off.</p>\n<p>I’ve been working on a resource scheduling component for the last several weeks.  The bulk of the logic is that if two resources are scheduled for the same time, I need to be able to display that there is a conflict.  It sounds pretty straight forward until you look at all the various ways items can overlap.  I’ve isolated the logic for this into a class that is quite testable and I had created a test suite with about 400 tests when I was told that along with that requirement, there were a particular set of conditions where what looked like a conflict wasn’t really a conflict.  I needed to show that there was an overlap, but I need to display it in such a way as to indicate that it isn’t a conflict.</p>\n<p>As I sat down to add in the new logic, I realized that the path I had been going down wasn’t going to work well given this new scenario.  What I really needed to do is to do some major refactoring.  In fact, you might even say I had to rewrite most of the code I had in place.  Now, in the past, I would have been afraid to tear up all that I had done and start over because it would have meant I would have to retest all that I had already worked on … manually!  But, since I already had tests in place, I was able to 1) commit what I had done so far to version control so I could get it back if I needed and 2) rip up what I had done, rewrite and refactor so that it would work well with the new requirement and 3) retest with the tests I ALREADY had in place.  I’ve added another 100 tests for the new scenarios and I’m pretty confident that the code I’ve written does what it should and doesn’t do what it shouldn’t.</p>\n<p>And that whole refactoring exercise took less than 7 hours.</p>\n<p>Oh.  And I have 100% code coverage!</p>\n",
            "tags": [
                "code coverage",
                "tdd",
                "test driven development"
            ]
        },
        {
            "id": "http://davembush.github.com/are-you-average-or-awesome-9-ways-to-improve/",
            "url": "http://davembush.github.com/are-you-average-or-awesome-9-ways-to-improve/",
            "title": "Are You Average or Awesome? 9 Ways to Improve.",
            "date_published": "2016-05-12T11:30:00.000Z",
            "content_html": "<p>The story goes that there were two men, Joe and Frank, who were camping out in the woods when a bear showed up in the camp.  Terrified, they decided the best they could do would be to stay perfectly still until the bear left.  Hopefully, the bear wouldn’t notice them.  As the bear was poking around, Joe says to Frank, “What are we going to do if this doesn’t work?”  Frank says, “Run!”  Joe says, “You really think we can out run a bear?”  Frank says, “I don’t need to out run the bear.  I only need to out run you.”</p>\n<figure>![](/uploads/2016/05/image.png \"9 Ways to Improve\")<figcaption>Photo credit: [Internet Archive Book Images](//www.flickr.com/photos/internetarchivebookimages/14767148885/) via [VisualHunt.com](//visualhunt.com) / [No known copyright restrictions](//flickr.com/commons/usage/)</figcaption></figure>\n\n<span id=\"more\"></span>\n\n<p>For years I have used this story to encourage my kids to be better than their peers.  Right now, most people are so “out of shape” that “running faster” than the competition is easy.  By comparison, my kids look awesome when by any other measure, they are probably only doing the bare minimum necessary.  This is not to say they aren’t REALLY good at what they do but, there is always room for improvement.</p>\n<h2 id=\"Average-Programmers\"><a href=\"#Average-Programmers\" class=\"headerlink\" title=\"Average Programmers\"></a>Average Programmers</h2><p>And then there are conversations I have with other programmers.  So many think they are great when they are only slightly better than the people they are working with.  The lack of desire to learn more, to be any better than adequate, is appalling.  And this is to say nothing of the programmers who never make the cut.  The ones I never work with because the people I work with and for won’t hire them.  I’ve been a part of some of those interviews.</p>\n<p>People who can’t answer the most basic of <a href=\"/7-c-interview-questions-that-weed-out-the-losers/\">C#</a>, ASP.NET, or <a href=\"/7-javascript-interview-questions-to-weed-out-imposters/\">JavaScript questions</a>.  This is to say nothing of <a href=\"/5-reasons-learning-terminology-increases-your-effectiveness-as-a-programmer/\">people who believe knowing concepts trumps knowing the terms</a> that specify them.</p>\n<h2 id=\"Average-Organizations\"><a href=\"#Average-Organizations\" class=\"headerlink\" title=\"Average Organizations\"></a>Average Organizations</h2><p>And then there are the organizations who settle for frameworks that provide “Silver Bullet” answers to problems.  Not because this is technically, the best solutions, but because this is the solution the requires the least from the developers they have working for them.  The problem with this approach is that it doesn’t demand excellence from the programming team that works for them.  And don’t get me started on managers who think they are “doing Agile” who obviously don’t even recognize that “Agile” is not a noun.</p>\n<p>The problem with comparing ourselves to our peers is that you can always find someone worse than yourself.  Not only is this true because you will always find someone who just doesn’t care, but even if we all cared, there will always be someone, who for any number of reasons, can’t be as good as you are.</p>\n<h2 id=\"Be-Awesome\"><a href=\"#Be-Awesome\" class=\"headerlink\" title=\"Be Awesome\"></a>Be Awesome</h2><p>But we can all strive to be the best.</p>\n<p>As programmers, what if we all decided to make as our goal code so bug free that no one could find problems with the code we wrote?  Maybe there is some part of the language you program in, or the framework that you use, that you’ve never tried.  How about learning it?  Is there a tool you could start using that would help you program better?  Maybe you’ve exhausted everything there is to learn about the language or framework that you use.  Maybe it is time to learn some other language.</p>\n<p>Who do you want to be? What do you want to be known for? These are interesting questions because they cause us to focus.  Do you want to be known as mediocre?  Keep coasting.  Do you want to be the person who gets the challenging problems because you are the only person who is reliable enough to give the project to? The problem with out-running your peers is that eventually, the bear will be the only thing behind you.  Where will you be?</p>\n<h2 id=\"Action-Steps\"><a href=\"#Action-Steps\" class=\"headerlink\" title=\"Action Steps\"></a>Action Steps</h2><p>OK, fine.  How do we get from mediocre to awesome?</p>\n<h3 id=\"1-Decide-to-Master-a-Skill\"><a href=\"#1-Decide-to-Master-a-Skill\" class=\"headerlink\" title=\"1. Decide to Master a Skill\"></a>1. Decide to Master a Skill</h3><p>I don’t care who you are or how good you are, there is still something you don’t know.  The great thing about being a programmer is that there is always something to master.  Do some sort of self-evaluation on your skills and determine to master some skill.</p>\n<p>Just by way of example, here are some possible skills you might learn.</p>\n<ul>\n<li>Test Driven Development</li>\n<li>Deep Dive a Language you “Know”</li>\n<li>Learn a Language You Don’t Know</li>\n<li>Design Patterns</li>\n</ul>\n<h3 id=\"2-Teach\"><a href=\"#2-Teach\" class=\"headerlink\" title=\"2. Teach\"></a>2. Teach</h3><p>The best way to learn a topic is to teach the topic.  There are at least two reasons for this.  First, preparing to teach makes you organize all of those scattered bits of information in your brain in a way that someone else can grasp.  Second, it will raise questions you didn’t even know you should ask.  I can’t tell you how many times I’ve explained something and the person I am teaching ask a question I’ve never considered before.  If you don’t know the answer, find the answer.  You obviously don’t know your subject as well as you think you do.</p>\n<p>Here are some possible ways to teach.</p>\n<ul>\n<li>Host a “Lunch and Learn”</li>\n<li>Start a Blog</li>\n<li>Write a Book</li>\n<li>Mentor a Younger Programmer</li>\n<li>Present Something at a Users Group or Meet-up.</li>\n</ul>\n<h3 id=\"3-Track-Progress\"><a href=\"#3-Track-Progress\" class=\"headerlink\" title=\"3. Track Progress\"></a>3. Track Progress</h3><p>In the business world, they say, “what you measure, grows.”  So, measure:</p>\n<ul>\n<li>Decrease in bugs reported.</li>\n<li>Elapse time from start of project to bug free code.</li>\n<li>Cyclomatic complexity of your methods.</li>\n</ul>\n<h3 id=\"4-Interview-for-a-New-Job\"><a href=\"#4-Interview-for-a-New-Job\" class=\"headerlink\" title=\"4. Interview for a New Job\"></a>4. Interview for a New Job</h3><p>One of the things I’ve found that interviewing for new gigs does for me is that it reveals things I should know.  I find out quickly what I should know that I don’t.  And don’t be the guy who says, “If my 30 years of experience isn’t good enough for you, I don’t want your stinking job.”  Answer the questions, not matter how much experience you have.  You might just learn something.  If you don’t know the answer, after the interview, go find the answer.  Don’t be like, “why should I keep that in my brain?”  I mean, that might be true, but go find the answer too.</p>\n<p>I had one of those interviews.  I wrote a whole post about it that I deleted.  They had me doing something I was unable to do and that I felt the rest of my knowledge and skills more than compensated for.  But, after the interview, I went and found out how to do what they had asked.</p>\n<h3 id=\"5-Change-Jobs\"><a href=\"#5-Change-Jobs\" class=\"headerlink\" title=\"5. Change Jobs\"></a>5. Change Jobs</h3><p>This probably sounds like odd advice, but as a contract programmer, I’ve been on assignments that have lasted as long as 8 years and I’ve been on assignments that were as short as 4 months.  What I’ve learned is that the longer I stay on an assignment, the staler my skills become.  That 8-year gig nearly made me unmarketable.  Why?  Because I never had to learn something new.  The only reason I am still marketable is because I started learning newer stuff toward then end of that gig.  When the gig was changing every 2 years or so, I was a lot more capable of moving into a new position.  Now, I’m learning all the time.  Learning what I think will make me more marketable as well as what I would really like to be doing next.  Some of that makes its way into what I’m doing today.  Some of it will have to wait.  But it is all experience and it is all valuable.  The point is, don’t get stuck knowing what you know.  Switching jobs is the fast way to achieve that.</p>\n<h3 id=\"6-Ask-for-a-Code-Review\"><a href=\"#6-Ask-for-a-Code-Review\" class=\"headerlink\" title=\"6. Ask for a Code Review\"></a>6. Ask for a Code Review</h3><p>To be clear, what you are asking for is a review of your code, not how pretty it is.  Although, depending on how much experience you have, there may be some benefit in having your code reviewed for formatting as well as clarity.</p>\n<p>What I would hope you would get out of this exercise is several, “Have you considered doing it this way…” kind of comments.  If you can’t get someone to review your code, there are some great code cop kind of tools available for every language that you can have review your code for common mistakes.  But even better if you can get another human to look at your code.</p>\n<p>It is interesting, I’ve been coding for 28 years and I’ve lost track of how many companies I’ve worked for.  There was only one company that I’ve ever worked for that did code reviews.</p>\n<h3 id=\"7-Change-Your-Body-Language\"><a href=\"#7-Change-Your-Body-Language\" class=\"headerlink\" title=\"7. Change Your Body Language\"></a>7. Change Your Body Language</h3><p>This probably seems like really odd advice so let me explain.  Or maybe you’ve already seen the <a href=\"//www.ted.com/speakers/amy_cuddy\">Ted talk</a> by Amy Cuddy that says the research shows that if you assume a body position that says, “I’m awesome” you are more likely to feel awesome.  But you may wonder what feeling awesome has to do with BEING awesome.</p>\n<p>Well, in my experience, you end up being who you believe yourself to be.  One way of hacking yourself into being awesome is to convince yourself that you are.  The best way to do that is to assume body positions that communicate that you are.</p>\n<p>Don’t think this is possible?  I grew up walking toe out.  At some point in High School or College, I read that it was more efficient to walk with my feet parallel to each other.  I started concentrating on changing how I walk.  Now I no longer think about it.  I haven’t thought about it for years.</p>\n<p>I’ve done the same thing with my body position.  Not as hard a modification, but I’ve noticed that it DOES work.</p>\n<h3 id=\"8-Don’t-Brag\"><a href=\"#8-Don’t-Brag\" class=\"headerlink\" title=\"8. Don’t Brag\"></a>8. Don’t Brag</h3><p>The other thing that changing your body language will do is that it will communicate that you are confident and you’ll never have to say a word.  I believe I’m pretty good at what I do, but my general practice is to let what I know be discovered.  As I’ve observed my peers, I’ve found that the more they proclaim how great they are, the less confident they are that they really are, and generally, they aren’t.  You don’t want to be that person.  You want to portray confidence to be confident, but you want to be discovered.  “Even a fool, when he is silent, is considered wise.” and “Better to be silent and be thought a fool than to open your mouth and remove all doubt.”</p>\n<h3 id=\"9-Focus-On-One-Thing\"><a href=\"#9-Focus-On-One-Thing\" class=\"headerlink\" title=\"9. Focus On One Thing\"></a>9. Focus On One Thing</h3><p>The temptation, if you are motivated at all, is to try to improve in every area all at once.  That is a recipe for disaster.  Focus on one thing.  I didn’t change how I walked and how I talked and how I ran and how I sat and… you get the picture.  I focused on how I walked.  Sometime later I focused on how I sat.  I learned how to code well and then how to do Test Driven Development.  I’m often asked how I learned all I know.  It is easy, I learned one thing at a time.</p>\n",
            "tags": [
                "tdd",
                "interview",
                "best practices",
                "design patterns"
            ]
        },
        {
            "id": "http://davembush.github.com/test-driven-learning-an-experiment/",
            "url": "http://davembush.github.com/test-driven-learning-an-experiment/",
            "title": "Test Driven Learning - An Experiment",
            "date_published": "2016-03-24T11:30:00.000Z",
            "content_html": "<p>As I mentioned last week, <a href=\"/react-js-and-associated-bits/\">I’ve been learning React JS over the last month or so</a>. Up until the start of this project, I would learn a new framework, and then I would try to paste in Test Driven Development after the fact.  I would use the excuse that because I didn’t know the framework well enough, I wouldn’t be able to properly write tests for it.</p>\n<p>But this time, I decided to do something different.  What if I wrote tests for my demo application as I was learning this new framework?  My reasoning was that learning how to test code written in the framework was just as important as learning the framework.</p>\n<p>What follows are the lessons I learned from this wildly successful experiment.</p>\n<p><img src=\"/uploads/2016/03/image-4.png\" alt=\"image\" title=\"Test Driven Learning\"> Photo credit: <a href=\"//www.flickr.com/photos/tom-margie/1538953234/\">twm1340</a> via <a href=\"//visualhunt.com\">Visualhunt.com</a> &#x2F; <a href=\"//creativecommons.org/licenses/by-sa/2.0/\">CC BY-SA</a></p>\n<span id=\"more\"></span>\n\n<h2 id=\"I-Learned-the-Framework-Better\"><a href=\"#I-Learned-the-Framework-Better\" class=\"headerlink\" title=\"I Learned the Framework Better\"></a>I Learned the Framework Better</h2><p>As I’ve written before, most people don’t test because they’ve never learned how.  When you are learning a new framework, in a lot of ways you start out at that same place all over again.  Yes, you’ve got all of your previous testing experience to fall back on, but in a lot of ways, because you don’t know the framework, you don’t really know how to properly test the code you are writing.  So, doing anything takes a lot more time than it would if you just wrote the code and ignored testing.</p>\n<p>But what I learned by forcing myself to write test as I wrote the demo – either before, as TDD should be practiced, or immediately after – is that this all helped me learn the framework better than if I hadn’t.</p>\n<p>For example,</p>\n<ul>\n<li>I stopped thinking of JSX as HTML and instead saw it as code with objects that can be mocked.</li>\n<li>I saw that the Flux system worked best as a “notify with data” system rather than a “notify and pull” system.</li>\n<li>I was forced to fully understand Flux</li>\n<li>I was more inclined to enforce the Single Responsibility Principle both at the View level and with Flux</li>\n</ul>\n<h2 id=\"I-Learned-How-to-Test-the-Framework\"><a href=\"#I-Learned-How-to-Test-the-Framework\" class=\"headerlink\" title=\"I Learned How to Test the Framework\"></a>I Learned How to Test the Framework</h2><p>This probably seems obvious.  But this gets back to the problem with my normal way of learning a framework.  Let’s take something like Angular as an example.  I know Angular 1.  I can get a pretty respectable application put together in it.  But, because I didn’t learn it using TDD, I would be the first to admit that my ability to unit test an Angular application is pretty weak.  I’m actually planning to go back and rework my Angular 1 and Angular 2 reference applications using TDD just to get that experience.</p>\n<p>I recently started working with EXT again.  This time with version 6.  Guess what I spent the first couple of days learning how to do?  That’s right.  “What’s the best way to write code using EXT 6 that makes the code testable?”  How did I answer that question?  I wrote tests.</p>\n<p>I learned:</p>\n<ul>\n<li>If you use the ViewModel and ViewController and never have either call the View directly, you can create highly testable code.</li>\n<li>Unit tests in EXT are best written using PhantomJS instead of JSDom.  Although, I’d still like to go back and try to make JSDom work.</li>\n</ul>\n<p>In React JS, I learned:</p>\n<ul>\n<li>View components are easier to test if they only do one thing.  Favor composition over monolithic view component.</li>\n<li>Stores (the part responsible for CRUD actions) can also be EventEmitters</li>\n</ul>\n<h2 id=\"I-Didn’t-Develop-Bad-Habits\"><a href=\"#I-Didn’t-Develop-Bad-Habits\" class=\"headerlink\" title=\"I Didn’t Develop Bad Habits\"></a>I Didn’t Develop Bad Habits</h2><p>This one, to me, is probably the most significant reason for me to repeat this process in the future.</p>\n<p>Here’s the deal.  Every other time I’ve learned a new framework or language, I’ve learned it from a “let’s just get something working” perspective.  If I concentrated on testing at all, it was after I got it all working.</p>\n<p>The problem with this method is now I’ve learned how to get something working, but I haven’t really learned the best way to organize my code so that it can be tested or swapped out later if I need to.</p>\n<p>By writing my code using TDD, I will have to write the code in a way that is testable the first time.  This means that while it may have taken you over twice as long to get that first demo application up and running, all future applications will be written in a more efficient, more testable, and easier to maintain.</p>\n<h2 id=\"I-Learned-How-Testable-the-Framework-Really-Is\"><a href=\"#I-Learned-How-Testable-the-Framework-Really-Is\" class=\"headerlink\" title=\"I Learned How Testable the Framework Really Is\"></a>I Learned How Testable the Framework Really Is</h2><p>If you read last week’’s article, you know that the testability story for React JS is what really got me excited.  None of the other frameworks I have used have been testable starting at the view level.  This is one of the areas where Angular could improve.  I wish I had leaned Angular 1 using TDD because then I would have either figured out how to test decorators on directives or I would have found out that it is only possible under the certain conditions.</p>\n<p>So far, I think React is incredibly testable.  Although I have not had a chance to do some of the things I’ve done with Angular yet.</p>\n<h2 id=\"I-Learned-Where-the-Holes-Are\"><a href=\"#I-Learned-Where-the-Holes-Are\" class=\"headerlink\" title=\"I Learned Where the Holes Are\"></a>I Learned Where the Holes Are</h2><p>This goes back to learning the framework better.  Because I was testing along the way.  Because I implemented code coverage.  I discovered that the code coverage story is the weakest link right now.  This is because Istanbul in combination with ES2015 syntax, which is the preferred React JS JavaScript syntax, does not work well together yet.  So, you’ll never get 100% code coverage no matter how hard you try because the transpilers that convert your ES2015 code to ES5 code add in conditions that will never get triggered, which show up in Istanbul as uncovered conditions.  This is probably more a reflection of the state of JavaScript right now than any of the tools involved.  Had I been willing to convert all of my React JS code to ES5, I would have been able to get 100% code coverage all the way down from the view to the server.</p>\n<h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion\"></a>Conclusion</h2><p>So, I invite you to try it yourself.  The next time you are learning a framework, learn ALL of it by testing it along the way.</p>\n",
            "tags": [
                "tdd",
                "learning"
            ]
        },
        {
            "id": "http://davembush.github.com/the-fallacy-of-motion/",
            "url": "http://davembush.github.com/the-fallacy-of-motion/",
            "title": "The Fallacy of Motion",
            "date_published": "2015-07-23T10:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/07/image1.png\" alt=\"image\" title=\"image\"></p>\n<p>I had this thought this past week that we tend to believe that if we are in motion, we are accomplishing something.  That being busy somehow equals being productive.  And then I started thinking about how this is almost universal.  It doesn’t just impact how we program, which I’ll get to eventually, but it impacts all of our life.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Let-Me-Illustrate\"><a href=\"#Let-Me-Illustrate\" class=\"headerlink\" title=\"Let Me Illustrate\"></a>Let Me Illustrate</h2><p>Have you ever driven to some location and had your favorite GPS system route you multiple ways?  How many of you take the route that is, according to your GPS, longer, just because the roads are 65mph instead of 45mph?  Or an even better example.  You hit a traffic jam and, even though ever indication is that you’ll be out of the traffic in a few minutes, you take an alternate route simply because the traffic is moving on that other road.  In both cases you probably know that you won’t get to your destination any faster, in fact you may get to your destination slower, but you still opt to take the moving route instead of the one that isn’t moving or is moving relatively slowly.  I’ve even heard people say… shoot I’ve even said… “I want to take this route because it moves faster.”  I like FEELING like I’m getting to my destination faster even if the reality is that I’m not.</p>\n<p>And then there is the issue of your job.  How many of you have to look busy for your peers to think that you ARE busy?  But as programmers, how true is that?  Unless you do some kind of unskilled labor, I doubt it is true of most people who work.  And yet, because we are all paid by the hour (yes, even those of you who are salaried are still trading hours for dollars) there is a perception that, somehow, if we are not in motion, we are not really working.  But is that true? I remember hearing a story about a programmer who spent half his day “staring at the ceiling” who was twice as productive as any of his peers.  Why is that?  Because he spent half his day thinking about the problem before he ever started writing a line of code.</p>\n<p>I remember back in the day when I was coding on 8088 computers, a compile and link cycle could take up to 10 minutes.  Because I recompile and test every time I’m made a runnable change, I had a lot of 10 minute breaks.  I used this time to think about the problem I was working on.  This was not intentional, it just happened naturally.  I think it made me more productive than if I were just churning code all day long at the speed our computers work today.</p>\n<p>And then there is this side project I’m working on.  I tend to work on it a half hour at a time as I have time.  Between my main gig that takes up 40 hours a week, and some side gigs that I have, I have a very small amount of time to work on this project.  Some days I don’t work on it simply because I’m too tired.  But sometimes, even when I’m not sitting in front of my computer, I’ll sit on my sofa doing nothing and think about the project.  It is in those times that I figure out where I want to take the project next, or how to solve a problem I’ve run into.  That time thinking, even though there is no motion, has made the resulting code that much better.</p>\n<h2 id=\"The-Fallacy-of-Motion-and-Testing\"><a href=\"#The-Fallacy-of-Motion-and-Testing\" class=\"headerlink\" title=\"The Fallacy of Motion and Testing\"></a>The Fallacy of Motion and Testing</h2><p>I’m sure you saw this coming, but one has to ask, is it the fallacy of motion that prevents us from testing our code? At my main gig, I have to admit, I’m bored.  There are a lot of reasons for this.  But one of them is that I spend a lot of time waiting for integrations tests to run to verify that my code is still working.  To be clear, I have way more unit test than integration test at this point.  But with the changes I’m currently making to the system, I’m more likely to find issues via the integration tests than I am from the unit tests.</p>\n<p>Compare this to a project I’m working on for another client where I’m primarily writing new code.  I’m a lot less bored.  The day zips by.  I FEEL more productive.</p>\n<p>And yet, the degree of certainty I have that the code I wrote for my main gig works as I designed it to work is a lot higher than the code I’m currently writing because I have more tests.</p>\n<p>This past week those tests actually showed me that my change wasn’t working entirely the way I wanted it to.  I probably would not have found it any other way.  I’m not even sure the people testing my code would have found it.  They aren’t those kind of testers.  And so I’ve proven to myself one more time that testing, while it feels slower, really is not just the right thing to do, but ultimately the faster thing to do.</p>\n<p>Think about what would have happened if I didn’t have these tests in place.  I would have released the code, eventually the bug would have revealed itself, and I would be left scrambling to fix the bug.  As it is, I was able to fix the bug in a somewhat leisurely manner because I found it early.</p>\n<p>And yet, I don’t FEEL productive.  As much as I’m convinced that Test Driven Development is the right way to go, I still struggle with this Fallacy of Motion.</p>\n<h2 id=\"We-Don’t-Have-Time-to-Test\"><a href=\"#We-Don’t-Have-Time-to-Test\" class=\"headerlink\" title=\"We Don’t Have Time to Test\"></a>We Don’t Have Time to Test</h2><p>I heard this again this past week.  “When you are working on a project with a tight deadline, you can’t always test because you don’t have enough time.” What?! Is this the Fallacy of Motion at work again? I would argue that it is precisely BECAUSE you are working under a tight deadline that you NEED to write test.</p>\n<p>Think about this, you have this tight deadline.  Great.  So you are not going to think clearly.  You are going to rush.  You will write incomplete code.  Your methods won’t verify input parameters.  You’ll have null pointer exceptions.  Your code will do what it is supposed to do, but will it not do what it shouldn’t do?  How will you know?  And who is going to catch the bug? Well we know the answer to that last question.  The people using your code will catch the bug.  This will make you look like an idiot.  You are because it is something that should have been caught.  It will also mean that you’ll need to track down the problem, fix the problem, and re-deploy the software.  And this is faster?  Faster than what?! Of course, “We don’t have time to do it right, but we always have time to do it over.”</p>\n<h2 id=\"Slow-and-Steady\"><a href=\"#Slow-and-Steady\" class=\"headerlink\" title=\"Slow and Steady\"></a>Slow and Steady</h2><p>So, slow down.  Do things right.  Remember the story of the tortoise and the hare.  The race doesn’t always go to the fastest but the one who is steady and persistent.  The one who doesn’t cut corners.  The one who consistently produces solid code.</p>\n",
            "tags": [
                "tdd",
                "testing",
                "productivity"
            ]
        },
        {
            "id": "http://davembush.github.com/the-parable-of-the-road-line-painter/",
            "url": "http://davembush.github.com/the-parable-of-the-road-line-painter/",
            "title": "The Parable of The Road Line Painter",
            "date_published": "2015-05-28T10:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/05/land-0125.jpg\" alt=\"land-0125\" title=\"land-0125\"></p>\n<p>Way back in the day when lines were first being painted on roads.  The early lines were painted by hand.  In those days, a painter was hired and given a stretch of road to paint.  The first day he got on very well.  In fact, he was one of the best line painters they had ever had.  His lines were perfectly aligned, there were no unpainted areas in the space where there should be paint, and he managed to get 500 yards of road painted.  The average line painter normally did 250 yards in the first day.  The managers who had hired him were quite pleased.</p>\n<span id=\"more\"></span>\n\n<p>Well, the next day, he came to work and set off on his task of painting the road.  He still had another 500 yards of road to paint.  And yet, for as fast as he was, he was only able to get 350 yards painted that day.  Not quite what his managers expected given his performance on the first day.  But still, better than their average painter, and so they reasoned to themselves, “Maybe he hit an extra hilly patch of road or some other unforeseen obstacle got in his way.”</p>\n<p>Finally, the third day, he came in and finished the patch of road he had been given.</p>\n<p>Since he had done so well on the first 1000 yards of road, management decided to put him on a job of a 1 mile stretch of road.  They also decided to make him the lead painter with a crew of 10 other painters who they had just hired.  He taught these new hires how to paint the road as he had been painting the road to date and they set off.  The first day was a great day.  They managed to get an average of 300 yards per person completed the first day.  Not quite what management had expected, but still better than the average line painter could do.</p>\n<p>The next day they all came to work and continued their painting.  Yet, this time, all they were able to accomplish was 200 yards per person.</p>\n<p>Predictably the next day they all came to work and continued their painting but only got 100 yards per person done.</p>\n<p>Of course management got concerned and since this was a rather easy job, they couldn’t understand how the painting could keep getting slower every day.  But obviously, since they had deadlines to meet, it was time to hire some more painters.  So they added another 10 painters to the job.  This had the impact of turning the lead painter into a manager, without the pay of a manager, and in the end, it actually slowed the painting down even more because all of the painters were getting in each other’s way.</p>\n<h2 id=\"A-Good-Idea\"><a href=\"#A-Good-Idea\" class=\"headerlink\" title=\"A Good Idea\"></a>A Good Idea</h2><p>One day, as they were painting, one of the painters mentioned that he had been reading that if they paired up and had one of the painters move the paint while the other painted the line and then they switched off painting or moving the paint, that the end result would be that they would actually end up completing the painting faster.  But his peer replied with several objections, the first being that they didn’t have permission to move the paint can.  If management had wanted them to move the paint can then that would have been part of the training they had received on the first day.  Others pointed out that obviously if they only had half of the people painting, it would take even longer to get the painting done.  Others were a lot more honest and just said, “I’m really not sure how we could move the paint.  The paint bucket is so heavy.</p>\n<h2 id=\"Tell-The-Boss\"><a href=\"#Tell-The-Boss\" class=\"headerlink\" title=\"Tell The Boss?\"></a>Tell The Boss?</h2><p>Well, you know the type.  Guys with good ideas are hard to stop.  So at the end of the day as they were cleaning up, he mentioned to the lead painter that he had an idea that might make the job move a little faster.  What if we rigged the paint so that it could be moved along as we painted?  Then we wouldn’t have to keep walking back to the paint can.  In fact, we could pair up and have one guy move the paint while the other spent his time continuously painting.  And by switching back and forth between painting and moving paint, no one would get excessively tired doing one or the other.</p>\n<p>Well, the lead painter was of course feeling threatened at this point and so he told this young up-start painter that he was hired to paint.  Not to innovate with stupid ideas that would obviously make the job take even longer.</p>\n<h2 id=\"Quit\"><a href=\"#Quit\" class=\"headerlink\" title=\"Quit\"></a>Quit</h2><p>Well, now.  Not being content to keep doing things the hard way, the innovative young painter quit this crew and went to work for a new road crew who advertised themselves as “innovative, fun and open to suggestions.”  Well, I’m sure you can predict exactly what happened next.</p>\n<p>The day he started on the job he found that they were painting the road exactly the same place as the last crew he worked on.  Of course, he mentioned his innovative idea, and of course, he got the same responses.</p>\n<p>Frustrated, he kept moving from company to company only to find out that they nearly all had the same attitude.  And so, he decided that since at each company he was pretty well left on his own to paint the lines, it wouldn’t hurt if he rigged up a wheel barrow with some paint cans so that he could fill the paint cans from the main paint receptacle and then carry the paint to the location he was painting.  This would reduce the amount of trips back to the main paint container and it really wouldn’t disrupt the work of anyone else.</p>\n<h2 id=\"It-Is-The-Same-Everywhere\"><a href=\"#It-Is-The-Same-Everywhere\" class=\"headerlink\" title=\"It Is The Same Everywhere\"></a>It Is The Same Everywhere</h2><p>There was just one problem with this.  As he started out on the new job, he found that all the nay-sayers were right.  It really did slow things down.  While before he was able to get 500 yards of road done on the first day, this time he was only able to get 300 yards of road done.  He was feeling a bit discouraged, and yet convinced that if he persisted the next day would prove him right, he continued.  Sure enough, while the average painter was able to get 200 yards done on the second day, he was able to continue with 300 yards on the second day as well.  In fact, as everyone else seemed to get slower, the innovative painter was able to get 300 yards of road done every day he painted.</p>\n<h2 id=\"The-Promotion\"><a href=\"#The-Promotion\" class=\"headerlink\" title=\"The Promotion\"></a>The Promotion</h2><p>Well, now he has management’s attention.  Let’s promote him.</p>\n<p>Well sir, he got promoted sure enough.  You know what the first thing he tried to implement?  Yep, how about if we change our whole process to move the paint can.  Well, I’m sure you know how well that went off. </p>\n<p>“We’ve been painting roads like this for 10 years and it works just fine.”</p>\n<h2 id=\"More-Frustration\"><a href=\"#More-Frustration\" class=\"headerlink\" title=\"More Frustration\"></a>More Frustration</h2><p>Even with his own team, he couldn’t get the “move the paint” method of painting roads fully implemented, no matter how hard he tried.  Yeah, there were a few pockets of painters who gave it a try, but ultimately, since it felt slower than what they had always done, they fell back to the old method they knew so well.</p>\n<p>And then, one day, a new painter came on the team who believed in the move the paint method.  He used it and found another guy on the team who was willing to pair with him so that one would move the paint and the other would paint.  Wow!  The progress they made!</p>\n<p>As they were working, one of them said, “I wonder if we can rig the wheelbarrow to drip the paint out so that we only have to spread it instead of having to dip the brush into the paint…</p>\n",
            "tags": [
                "tdd",
                "extreme programming",
                "paired programming"
            ]
        },
        {
            "id": "http://davembush.github.com/setting-up-specflow/",
            "url": "http://davembush.github.com/setting-up-specflow/",
            "title": "Setting up SpecFlow",
            "date_published": "2015-05-21T10:00:00.000Z",
            "content_html": "<p>I’ve been asked to train a group of developers in the use of <a href=\"//www.specflow.org/\">SpecFlow</a> so that they can use it to write Selenium Tests.  So, in an attempt to “kill two birds with one stone” I thought today’s post would cover how to get the SpecFlow environment setup.  Not only will it help me prepare for the training session I will be leading, but it will help me when I need to set this up the next time because it tends to be a bit confusing when you setup a new project.  You’ll see why in a bit.</p>\n<h2 id=\"Installing-SpecFlow\"><a href=\"#Installing-SpecFlow\" class=\"headerlink\" title=\"Installing SpecFlow\"></a>Installing SpecFlow</h2><span id=\"more\"></span>\n\n<p>The first thing you’ll want to do is to install the SpecFlow Visual Studio integration.  You do this by navigating to “Tools” –&gt; “Extension and Updates …” <img src=\"/uploads/2015/05/image.png\" alt=\"image\" title=\"image\"> This will bring up a dialog box where you’ll want to select the “Online” branch <img src=\"/uploads/2015/05/image1.png\" alt=\"image\" title=\"image\"> You will notice in the upper right corner of this dialog, a search box.  Type in “SpecFlow” to find the SpecFlow extensions.</p>\n<p><img src=\"/uploads/2015/05/image2.png\" alt=\"image\" title=\"image\"> In the image above, I’ve already installed it, so there is a check box.  You’ll want to click the “Download” or “Install” button that displays when it isn’t installed.</p>\n<h2 id=\"Creating-a-Test-Project\"><a href=\"#Creating-a-Test-Project\" class=\"headerlink\" title=\"Creating a Test Project\"></a>Creating a Test Project</h2><p>Now that you’ve installed the extension, you can create a new test project.  You might expect a SpecFlow template to appear somewhere in the project list.  Sorry, that’s not what you get.  You could create one yourself if you really wanted.  To create a SpecFlow project, all you really need to do is to create a Class Library project.</p>\n<p><img src=\"/uploads/2015/05/image3.png\" alt=\"image\" title=\"image\"></p>\n<h2 id=\"Adding-a-Reference\"><a href=\"#Adding-a-Reference\" class=\"headerlink\" title=\"Adding a Reference\"></a>Adding a Reference</h2><p>And now, this is where I always get tripped up for a minute.  You can create a new feature file, but there is a menu item you should see that will allow you to add feature steps to a class file and you won’t see that until you add a reference to SpecFlow.  To do that, you will need to go back to NuGet.  This time use the menu option, “Tools” –&gt; “NuGet Package Manager” –&gt; “Manage NuGet Packages for Solution…”</p>\n<p><img src=\"/uploads/2015/05/image4.png\" alt=\"image\" title=\"image\"></p>\n<p>Once again a dialog will display.  Make sure you are in the “Online” branch on the left and type “SpecFlow” into the search area in the upper right corner of the dialog.</p>\n<p><img src=\"/uploads/2015/05/image5.png\" alt=\"image\" title=\"image\"></p>\n<p>I always use SpecFlow with NUnit, if you install SpecFlow.NUnit it will automatically install the SpecFlow dependencies with it.  If you prefer to use xUnit, you can install that and the SpecFlow dependencies will install automatically.</p>\n<h2 id=\"Create-Your-First-Feature-File\"><a href=\"#Create-Your-First-Feature-File\" class=\"headerlink\" title=\"Create Your First Feature File\"></a>Create Your First Feature File</h2><p>Now that you have the environment setup, you can actually use SpecFlow.  To create your first feature file, you can right click on the project and select “Add” –&gt; “New Item…” from the context menu.  Just like you would add a new file to the project any other time.  From the resulting dialog, select “SpecFlow Feature File”, give it an appropriate file name, and click the “Add” button.  When I name my SpecFlow feature files, I try to name them similar to the feature it will be testing.</p>\n<p><img src=\"/uploads/2015/05/image6.png\" alt=\"image\" title=\"image\"></p>\n<p>The resulting feature file will have a sample of how your feature will be setup.  You will want to change this to test whatever it is you are testing.  The next thing you will want to do is to create a Step Definition file.  This is a regular C# file with a Binding attribute added.  The file that SpecFlow will generate for you will match the template they provided in the feature file.  What I want you to do next is the delete all of the methods in the class so that I can show you how to add additional methods.  I’m not going to go to the trouble of showing you the screen shots.  I figure you know how to get to it and the image above shows it listed in the “Add File” dialog.</p>\n<p>Next, go back to your feature file and right click on the provided “Given” line, you should see a menu option that says, “Generate Step Definitions”</p>\n<p><img src=\"/uploads/2015/05/image7.png\" alt=\"image\" title=\"image\"></p>\n<p>If you click this, you’ll get a dialog like this:</p>\n<p><img src=\"/uploads/2015/05/image8.png\" alt=\"image\" title=\"image\"></p>\n<p>A couple of things you should notice.  One is the name of the class you are going to create if you click the “Generate” button.  I would advise against using the generate button.  Instead, we are going to use the “Copy methods to clipboard” method.  If you want to try to keep things segmented, you might choose to copy some of the steps to the clipboard and paste them into one file and copy others and paste them into another file.  This list will only list steps that you don’t already have definitions for, so you don’t need to worry about producing duplicate definitions.</p>\n<p>If you copy the methods onto the clipboard and paste them into the step file, you should end up with code that is functionally equivalent to what the new file template created for you.</p>\n<h2 id=\"Just-A-Start\"><a href=\"#Just-A-Start\" class=\"headerlink\" title=\"Just A Start\"></a>Just A Start</h2><p>This is enough to get you setup, but there is more to cover, so make sure you subscribe to the mailing list to get notified when I post another article about SpecFlow.</p>\n",
            "tags": [
                "tdd",
                "testing",
                "bdd",
                "specflow"
            ]
        },
        {
            "id": "http://davembush.github.com/tdd-gamification-turning-test-driven-development-into-a-game/",
            "url": "http://davembush.github.com/tdd-gamification-turning-test-driven-development-into-a-game/",
            "title": "TDD Gamification - Turning Test Driven Development into a Game",
            "date_published": "2015-04-23T10:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/04/ge-gam-018.jpg\" alt=\"ge-gam-018\" title=\"Test Driven Development Gamification\"></p>\n<p>When I was in college, there were some guys I hung out with who played this game called “Questions” which they got from some book.  <a href=\"//en.wikipedia.org/wiki/Questions_(game)\">Actually, it was a play</a>. Anyhow, the basic rules are:</p>\n<ul>\n<li>You can’t answer a question with a statement</li>\n<li>You can’t hesitate or make a false start</li>\n<li>You can’t repeat a question that has already been used</li>\n<li>You can’t ask a rhetorical question</li>\n<li>You can’t ask an unrelated question.</li>\n</ul>\n<p>There was also <a href=\"//dotnetrocks.com/default.aspx?showNum=1111\">this podcast at DotNetRocks</a> where they were talking about a beer app and how they had added game elements to the app by adding badges for various types of beer to get you out of your comfort zone.  Maybe there is one for “My first beer that I liked” because I’ve yet to find something I like.  But give me a good Merlot! All of this got me to thinking about how we might turn Test Driven Development into something of a game. There are several people who have already addressed the Gamification of TDD</p>\n<span id=\"more\"></span>\n\n<h2 id=\"TDD-and-the-Gamification-of-Testing\"><a href=\"#TDD-and-the-Gamification-of-Testing\" class=\"headerlink\" title=\"TDD and the Gamification of Testing\"></a><a href=\"//effectivesoftwaredesign.com/2011/11/21/tdd-and-the-gamification-of-testing/\">TDD and the Gamification of Testing</a></h2><p>This article talks mostly about how TDD has many elements of good gaming inherent in it.</p>\n<ul>\n<li>Because it makes testing more like programming.  Well, what he actually says is that it raises testing to the level of complexity the programmer is familiar with.  But in reality, I think this is because it makes testing something that can be coded.</li>\n<li>Because TDD is measurable.  The test either succeeds or fails.</li>\n<li>Because TDD gives you immediate feedback.  Or at least a well written test gives you immediate feedback.</li>\n</ul>\n<h2 id=\"TDD-The-Gamification-of-Programming\"><a href=\"#TDD-The-Gamification-of-Programming\" class=\"headerlink\" title=\"TDD: The Gamification of Programming\"></a><a href=\"//benvanik.tumblr.com/post/20702406947/tdd-the-gamification-of-programming\">TDD: The Gamification of Programming</a></h2><p>This article provides an interesting perspective of someone trying to program using TDD for the first time.  You get the normal complaints, like “this takes too long” along with acknowledgement of some of the benefits.  But what he realizes is that the process has made programming more like a game than about the creative problem solving most of us got in to programming for in the first place.</p>\n<h2 id=\"Gamify-TDD\"><a href=\"#Gamify-TDD\" class=\"headerlink\" title=\"Gamify TDD\"></a><a href=\"//www.tdddev.com/2014/09/gamify-tdd.html\">Gamify TDD</a></h2><p>This is the first article I found that, instead of saying that TDD is already a game, like the two above, actually ask how we might formally turn TDD into a game because it already has many elements of a game.  But he never actually says HOW he would do that.</p>\n<h2 id=\"TDD-Gamification\"><a href=\"#TDD-Gamification\" class=\"headerlink\" title=\"TDD Gamification\"></a>TDD Gamification</h2><p>Putting this all together.  Here is how I would actually make TDD into a game.</p>\n<h4 id=\"The-rules\"><a href=\"#The-rules\" class=\"headerlink\" title=\"The rules:\"></a>The rules:</h4><ul>\n<li>The game is played in pairs.  (Paired programming)</li>\n<li>Game starts when programmer 1 writes the first test.</li>\n<li>Once a failing test is written, programmer 2 writes JUST ENOUGH to make the test succeed.</li>\n<li>Once a test succeeds, programmer 2 writes another test, and programmer 1 writes just enough to make it succeed.</li>\n<li>Play alternates until no one can think of another test that will force more code to be written.</li>\n<li>Programmer loses points if he is caught writing more code than is necessary to pass the test.</li>\n<li>Programmer loses points if he is caught writing code that has dependencies embedded in it.</li>\n<li>If a dependency is required, the test writer and the code implementer will collaborate in the method of dependency injection to be used.</li>\n<li>All points lost by one programmer go to the programmer who caught the mistake.</li>\n</ul>\n<h4 id=\"Embellishment\"><a href=\"#Embellishment\" class=\"headerlink\" title=\"Embellishment:\"></a>Embellishment:</h4><p>If code is found to have a bug in production, both programmers responsible for the code loose a point, regardless of how many lines of code are impacted.  One point per recorded bug.</p>\n<p>I’m assuming that most shops have more than 2 programmers.  On any given day, programmers would be paired up for the day of programming.  They are responsible for turning out bug free code.  Because we are tracking the code over the long term, we will be able to see just how effective each programmer is at eliminating bugs.</p>\n<p>In fact, if you are in an environment that can’t quite stomach having your programmers paired up, I would suggest keeping track of the code that wasn’t done under the game.  This would be the “house score” compared to an individual programmer’s score.</p>\n<p>The only thing we have left is some way of being able to account for productivity.  I mean, if I write no code, I’ll have no bugs, right?  And all things being equal, the more productive I am, the more bugs I’ll have.  So how do we measure this? Here is what we can’t do:</p>\n<ul>\n<li>Lines of code – you can’t measure based on lines of code because that has been shown to be an inaccurate measure of productivity.  More lines may just mean you are not very efficient.</li>\n<li>Hours worked – <a href=\"/rapidDevelopment\">Rapid Development</a> has statistics in it that show there is a factor of 10 difference between good programmers and bad programmers.</li>\n</ul>\n<h4 id=\"Just-a-suggestion\"><a href=\"#Just-a-suggestion\" class=\"headerlink\" title=\"Just a suggestion:\"></a>Just a suggestion:</h4><p>Since short methods are desirable, what if we measure number of test relative to number of methods relative to number of classes.  This would enforce the single responsibility principle.</p>\n<p>T &#x3D; Tests M &#x3D; Methods C &#x3D; Classes 1&#x2F;((T&#x2F;M)&#x2F;C) &#x3D; Productivity Score Therefore,</p>\n<ul>\n<li>If I worked on 3 classes each with 6 methods and each method has 2 tests, I end up with a productivity score of 1.5</li>\n<li>If I had one class with 18 methods each with 2 tests, I end up with a productivity score of .5</li>\n<li>If, on the other hand, I put everything in one method, and one class and had the same 36 tests, my productivity score would be .02</li>\n<li>If you write no code, your productivity score is 0.</li>\n</ul>\n<p>That’s just a simple way to calculate.  You may choose to use cyclomatic complexity in some way if you have that number easily available to you.</p>\n<p>Well, that’s my rough sketch of how we might be able to turn TDD into something of a game along with being able to prove to ourselves and management that it really does produce better code. How else might you embellish this or change it so it works better?  Let me know in the comments below.</p>\n<h4 id=\"Other-Test-Driven-Development-Resources\"><a href=\"#Other-Test-Driven-Development-Resources\" class=\"headerlink\" title=\"Other Test Driven Development Resources\"></a>Other Test Driven Development Resources</h4><ul>\n<li><a href=\"/testDrivenDevelopmentByExample\">Test Driven Development: by Example</a></li>\n<li><a href=\"/professionalTestDrivenDevelopmentWithCSharp\">Professional Test Driven Development w&#x2F; C#</a></li>\n</ul>\n",
            "tags": [
                "tdd",
                "agile",
                "extreme programming",
                "gamification",
                "paired programming"
            ]
        },
        {
            "id": "http://davembush.github.com/limiting-beliefs-of-programmers/",
            "url": "http://davembush.github.com/limiting-beliefs-of-programmers/",
            "title": "Limiting Beliefs of Programmers",
            "date_published": "2015-04-09T10:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/03/ppl-men-026.jpg\" alt=\"scream\" title=\"scream\"></p>\n<p>At the risk of making half of my audience think I’ve gone off the deep end, I’m going to address a topic that I’ve only recently REALLY begun to understand, in part thanks to <a href=\"/softSkills\">Soft Skills</a>.</p>\n<p>When I’ve heard the topic of “Limiting Beliefs” come up, it has almost always been in the context of something along the lines of “What the mind can conceive and believe, it can achieve.”  Which is easy to disprove.  At least it is out of context!  I mean really, if I can conceive and believe myself to be a butterfly, it just isn’t going to happen! However, the opposite is pretty easy to both accept and believe.  And that’s what I want to talk about today.  But even then, it probably isn’t what you are expecting.</p>\n<span id=\"more\"></span>\n\n<p>Typically, when people talk about “Limiting Beliefs”, they are talking about patterns and practices you picked up as a kid that are holding you back now.  And while those may be areas that you need to work on, what I want to talk about today is more micro than that, although they may have roots in our past for various reasons, the Limiting Beliefs I want to talk about today are common across nearly every programmer I talk to.  If you think “Limiting Beliefs” mean something along the lines of, “you are limited because you don’t believe enough,” that is NOT what I have in mind here at all.  In fact, “Limiting Beliefs” are beliefs that we believe TOO strongly and because we hold them too strongly, they limit us.  This is what I mean when I talk about “Limiting Beliefs” even if it is used in another way by someone else.</p>\n<p>Here are some examples specifically related to the craft of programming.</p>\n<h2 id=\"You-Can’t-Practice-TDD\"><a href=\"#You-Can’t-Practice-TDD\" class=\"headerlink\" title=\"You Can’t Practice TDD\"></a>You Can’t Practice TDD</h2><p>As I’ve mentioned in other articles, most programmers I know don’t practice Test Driven Development because they believe they don’t have permission.  And when they ask, they don’t get permission because you’ve transferred the belief that you don’t think it is important.</p>\n<p>If instead, you believed you had permission to do whatever it took to legitimately do your job well, you would learn how to do everything it took to practice TDD well.</p>\n<h2 id=\"Can’t-Create-Branches-in-Version-Control\"><a href=\"#Can’t-Create-Branches-in-Version-Control\" class=\"headerlink\" title=\"Can’t Create Branches in Version Control\"></a>Can’t Create Branches in Version Control</h2><p>I recently ran into a comment on a blog that mention this.  In fact I’ve run into this very issue where I am currently working.  But instead of thinking about what I can’t do, or when I am frustrated by what I can’t do, I first think 1) is this important enough to find a way around? And 2) what CAN I do? In this case, I found it critically important.  My productivity was being hampered because I am adding new features to existing code and, while that code is being tested, I’m converting the code to the last version of the library that we use.  Branching allows me to switch between the two projects easily and it allows me to migrate the current code into the upgrade code so that when the conversion is done, I can merge it down into the main branch and keep going.</p>\n<p>How did I do this?  We use TFS with the old TFVS version control system instead of the Git repository.  But there are at least two projects that exist that allow you to create a bridge between your local code that uses a local GIT repository and the remote TFS repository.  There is at least one project available for subversion that allows you to do the same sort of thing.</p>\n<p>I get my branches and yet I have not caused any disruption to the rest of my team.</p>\n<h2 id=\"Can’t-Use-X-Technology\"><a href=\"#Can’t-Use-X-Technology\" class=\"headerlink\" title=\"Can’t Use X Technology\"></a>Can’t Use X Technology</h2><p>OK.  So, again, ask yourself the same questions.  Is this hampering your productivity?  What CAN you do?</p>\n<h2 id=\"You-Have-to-be-Perfect\"><a href=\"#You-Have-to-be-Perfect\" class=\"headerlink\" title=\"You Have to be Perfect\"></a>You Have to be Perfect</h2><p>I think many of us realize that we can’t be perfect and yet, how do you react when someone finds a bug in your code? I saw a tweet last week that captures the essence of the bug fixing process.</p>\n<ol>\n<li>That can’t happen</li>\n<li>That doesn’t happen on my machine.</li>\n<li>That shouldn’t happen.</li>\n<li>Why does that happen?</li>\n<li>Oh, I see.</li>\n<li>How did that ever work?</li>\n</ol>\n<p>The question I need to ask is, why do we start with “That can’t happen” unless we feel that we need to be perfect.</p>\n<p>In the last year, I’ve finally gotten to the point where my first reaction is, “OK, well, put it in the issue tracker.” (Or if you are doing Agile, “put it in the backlog”).</p>\n<h2 id=\"Can’t-Practice-Agile-x2F-Scrum\"><a href=\"#Can’t-Practice-Agile-x2F-Scrum\" class=\"headerlink\" title=\"Can’t Practice Agile&#x2F;Scrum\"></a>Can’t Practice Agile&#x2F;Scrum</h2><p>Speaking of Agile&#x2F;Scrum.  Are you working at a place that doesn’t practice Agile or Scrum, but you think they should?  What parts of Agile&#x2F;Scrum can you implement in the sphere of influence you have?  So, you can’t form a Scrum team.  But, do you personally put people over processes?  Do you put people first at all?  Most of the <a href=\"//agilemanifesto.org/\">Agile Manifesto</a> can be implemented at a personal level once you understand what it is really about.  Don’t expect anyone to adopt agile in your organization if they don’t see it in you first.</p>\n<h2 id=\"You-Are-an-Introvert\"><a href=\"#You-Are-an-Introvert\" class=\"headerlink\" title=\"You Are an Introvert\"></a>You Are an Introvert</h2><p>How many of us hide behind this one?  We don’t want to deal with people.  We really don’t value people over much of anything.  In fact, we think, “programming would be a great job if it weren’t for the clients.”  I’m reading some books that talk about the impact of confusing behavior with who we are.  OK, so sure, your behavior is that you prefer to avoid loud noises.  You’d rather talk to one or two people at a time.  You process stuff in your head instead of with your mouth.  That’s behavior.  To say, “I am an Introvert” can have the effect of saying, “I hate people” and can become a limiting belief because it will isolate you from the very people you should be helping.  Sorry, you can’t get far as a programmer if you avoid the people part of it.</p>\n<h2 id=\"Restrictions\"><a href=\"#Restrictions\" class=\"headerlink\" title=\"Restrictions\"></a>Restrictions</h2><p>And then there is the general set of restrictions that come with being part of any organization.  We have a few where I work that, on the face of it, seem ridiculous.  I HAVE to take a lunch break even though my lunch consist of 5 sausage links that can be consumed in about 5 minutes.  I can’t start before 7am.  I can’t leave until 3:30.</p>\n<p>But what can I do?  Well, no one said WHEN I had to take the lunch break, so I come in and watch a half hour of <a href=\"/pluralSight\">PluralSight</a> courses every morning.</p>\n<p>I can’t start before 7am.  But I CAN enter the office before then.  I prefer to come earlier because the traffic is lighter if I come in at 6:45.  So, I come in and don’t start working until seven.</p>\n<p>To get my eight hours in, I can’t leave until 3:30 anyhow.  So that is not an issue.  And if I need to leave early occasionally, no one said I couldn’t do that.</p>\n<h2 id=\"The-Key-To-Eliminating-Limiting-Beliefs\"><a href=\"#The-Key-To-Eliminating-Limiting-Beliefs\" class=\"headerlink\" title=\"The Key To Eliminating Limiting Beliefs\"></a>The Key To Eliminating Limiting Beliefs</h2><p>Do you see what I’ve done here?  At every point where I’ve been told or believed I could not do something, I’ve change the question from “What can’t I do?” to “What can I do?”  Can’t locks you down.  It locks you out.  Can frees you. So, what limiting beliefs do you have and how can you overcome them?</p>\n",
            "tags": [
                "tdd",
                "programming",
                "agile",
                "scrum",
                "limiting beliefs"
            ]
        },
        {
            "id": "http://davembush.github.com/100-code-coverage-possible/",
            "url": "http://davembush.github.com/100-code-coverage-possible/",
            "title": "100% Code Coverage Possible?",
            "date_published": "2015-03-26T10:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/03/iStock_000005626017Medium1.jpg\" alt=\"100% code coverage\" title=\"100% Code Coverage\"></p>\n<p>In response to my post “<a href=\"/excuses-for-not-testing/\">Excuses For Not Testing</a>” <a href=\"//disqus.com/by/mayofcherries/\">Kris K</a> asked:</p>\n<blockquote>\n<p>There is also another side of <a href=\"//en.wikipedia.org/wiki/Unit_testing\" title=\"Unit testing\">Unit Tests</a>. Some companies are so fixated they aspire to have 100% Unit Tests coverage and they make programmers write Unit Tests for legacy code for no reason. Just for the sake of having Unit Tests. … [I] wonder if you had any similar experiences and what you think about this approach. I guess the 100% extreme is better than no tests at all, but it can make the developers very bored and feeling useless.</p>\n</blockquote>\n<p>And my initial reaction to this was, “WOW!  So much to respond to here.  I think this is worth a blog post.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Is-100-realistic\"><a href=\"#Is-100-realistic\" class=\"headerlink\" title=\"Is 100% realistic?\"></a>Is 100% realistic?</h2><p>So, first, the question of 100% coverage.  Is that a realistic goal?  And the answer of course is, “it depends.”</p>\n<h4 id=\"The-first-dependency-is-of-course-“what-do-you-mean-by-‘100-code-coverage’-”\"><a href=\"#The-first-dependency-is-of-course-“what-do-you-mean-by-‘100-code-coverage’-”\" class=\"headerlink\" title=\"The first dependency is, of course, “what do you mean by ‘100% code coverage’?”\"></a>The first dependency is, of course, “what do you mean by ‘100% <a href=\"//en.wikipedia.org/wiki/Code_coverage\" title=\"Code coverage\">code coverage</a>’?”</h4><p>Do you mean you need tests for not just all the code you wrote, but all the code your tools wrote for you and all of your third party libraries?  If 100% is inclusive, I’d lean toward 100% not only being not realistic, but also not necessary.</p>\n<p>Although, in a highly critical system, you’ll probably want to do some kind of vetting of the tools and libraries you are using.  But by the time you are using them, you should already know that they work, the only thing you won’t know for sure is if you are using them correctly.  In this case, you are looking at integration tests and not unit tests.</p>\n<h4 id=\"The-second-dependency-is-“Is-the-code-testable-”\"><a href=\"#The-second-dependency-is-“Is-the-code-testable-”\" class=\"headerlink\" title=\"The second dependency is, “Is the code testable?”\"></a>The second dependency is, “Is the code testable?”</h4><p>This is a little trickier to evaluate, so let me illustrate.  There is code that isn’t testable that should be.  I’m not talking about that code.  I’m talking about code that just can’t be tested.</p>\n<p>Let me illustrate.</p>\n<p>I’m working with <a href=\"//www.sencha.com/products/extjs/\" title=\"Ext JS\">EXTjs</a> which uses their proprietary implementation of MVC.  The part that is particularly interesting is that the View part of the architecture is basically a JSON object that defines what the view looks like.  While you can put in code that performs some action, the fact of the matter is that this code, when coded correctly, doesn’t really DO anything.  So, I would ask, how would you test this?  Sure I could put it in a test harness and run it through  some sort of parse routine or something, but unless you can say, “when I do this, this other thing over here should be true (or false)” you really can’t test the code.  A class that has no methods is basically a structure and structures can’t, by definition, be tested.</p>\n<p>On the other hand, I wrote some code once in WinForms that I was able to get under test and execute by calling the methods directly in the form.  I would have been better off moving that code into a presenter class so I could test the functionality separate from the presentation (view) and marked the view as untestable.</p>\n<h4 id=\"Finally-I-have-to-ask-“Is-refactoring-allowed-”\"><a href=\"#Finally-I-have-to-ask-“Is-refactoring-allowed-”\" class=\"headerlink\" title=\"Finally, I have to ask, “Is refactoring allowed?”\"></a>Finally, I have to ask, “Is refactoring allowed?”</h4><p>This is legacy code we are talking about.  And legacy code is notoriously hard to unit test.  As I mentioned a <a href=\"/why-johnny-cant-do-test-driven-development/\">couple of weeks ago</a>, in order to write unit test, the code has to be testable in the first place.  So, if the code isn’t in a condition that it can be unit tested, and you aren’t allowed to make the code testable, then either 100% code coverage isn’t possible or you aren’t unit testing.  It’s that simple.</p>\n<h2 id=\"Testing-is-boring\"><a href=\"#Testing-is-boring\" class=\"headerlink\" title=\"Testing is boring\"></a>Testing is boring</h2><p>Next, I’d like to address the issue of testing being boring.  I can understand this.  Most of my day is spent unit testing code I’ve previously written because when I wrote it, I wasn’t as good at unit testing as I am today.</p>\n<p>But, you know what I’ve found along the way?  That by making sure the code is covered 100% it has made me think about how I’ve structured my code and it has made my code more maintainable.</p>\n<p>But, mostly I find testing entertaining because I learn just a little more about testing.  I get to prove to myself and my peers that writing unit test really does find bugs we didn’t have any idea were there.  I get to perfect my craft just a little bit more.</p>\n<p>Here are some things to consider about the statement that “testing is boring.”  You may not like what I have to say, but keep in mind, I don’t know you and I don’t know Kris.  I just know what the research says about the state of being bored.</p>\n<h4 id=\"Dictionary-Definition\"><a href=\"#Dictionary-Definition\" class=\"headerlink\" title=\"Dictionary Definition\"></a><a href=\"//www.macmillandictionary.com/us/dictionary/american/bored\">Dictionary Definition</a></h4><blockquote>\n<p>feeling impatient or dissatisfied, because you are not interested in something or because you have nothing to do.</p>\n</blockquote>\n<h4 id=\"People-who-get-bored-are-anxious-people\"><a href=\"#People-who-get-bored-are-anxious-people\" class=\"headerlink\" title=\"People who get bored are anxious people\"></a><a href=\"//www.dragosroua.com/how-and-why-we-get-bored/\">People who get bored are anxious people</a></h4><blockquote>\n<p>People who get bored easily are usually anxious people. They’re also having quite a low level of self-esteem. If you’re constantly challenging yourself by trying to stop what you’re doing, because you don’t “like” it, you end up considering yourself an inappropriate person.</p>\n</blockquote>\n<h4 id=\"One-Of-My-Professors-Said\"><a href=\"#One-Of-My-Professors-Said\" class=\"headerlink\" title=\"One Of My Professors Said\"></a>One Of My Professors Said</h4><blockquote>\n<p>Boring people get bored</p>\n</blockquote>\n<p>  Personally, I find that I’m most bored when I have something else I’d rather be doing.  It isn’t so much that I don’t want to do what I’m currently doing as I’d rather be doing something that I can’t currently do.  I had this experience on Friday because on Thursday night I had found an article on SEO stuff that I desperately wanted to start putting into practice.</p>\n<p>What I’m suggesting here is that if you change your perspective from one of, “this is a ridiculous idea” to “this is a challenge to be met” or “this is an opportunity to learn”, or even (to address a specific comment that started this post) “I get to make my this application more bug free.”  you may find that the boredom leaves.</p>\n<p>Treat it as a game.  Maybe pair up with people on your team and see who can discover the most bugs during the day.  Create a leader board.  Since you have to do this anyhow, make it fun.</p>\n",
            "tags": [
                "code coverage",
                "tdd",
                "unit test"
            ]
        },
        {
            "id": "http://davembush.github.com/changing-habits/",
            "url": "http://davembush.github.com/changing-habits/",
            "title": "Changing Habits",
            "date_published": "2015-03-19T10:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/03/hand-039.jpg\" alt=\"hand-039\" title=\"hand-039\">This past week I’ve been thinking a lot about changing habits and how much of our lives habits influence. To be clear, I would define a habit as something we have learned to do as an automated response to some trigger.  Something we no longer think about doing, but we just do because … well … because we’ve always done it that way.</p>\n<p>I have some bad habits:</p>\n<ul>\n<li>Eat something sweet when I’m tired or bored.</li>\n<li>How I react to particular situations</li>\n<li>… others I’m not so willing to share publicly …  :)</li>\n</ul>\n<p>And some good habits:</p>\n<ul>\n<li>Wake up before 4:40am</li>\n<li>Go to bed at 9:00pm</li>\n<li>Write a blog post once a week</li>\n<li>Watch PluralSight videos for 30 minutes every day.</li>\n</ul>\n<p>And some habits I’m trying to form:</p>\n<ul>\n<li>Exercise every day</li>\n<li>Take my vitamins</li>\n<li>Work on my book for 30 minutes each day</li>\n</ul>\n<span id=\"more\"></span>\n\n<h2 id=\"How-I-Deal-With-Habits\"><a href=\"#How-I-Deal-With-Habits\" class=\"headerlink\" title=\"How I Deal With Habits\"></a>How I Deal With Habits</h2><p>Now, I’ve learned that the best way to conquer bad habits is to replace them with good habits.  So, for example, since I believe that fat is better than sugar, I might decide to eat cheese rather than cookies when I’m bored.</p>\n<p>I’ve also learned that if I can set an alarm, I’m more likely to do something.  In fact, my life is run from my calendar on my phone.  If you want me to do something for you, the best way to make sure I do it is to make sure I’ve scheduled it.  I’m kind of obsessive about keeping appointments, so this works well for me.</p>\n<p>The other thing that works well for me is doing something at the same time every day, or every week.  So, I write blog post, pay bills, do household chores and prepare for a Bible study that I run on Saturdays.  I watch <a href=\"/pluralsight\">PluralSight</a> videos and work on the book that I’m writing first thing every morning.  I take my vitamins at the same time each day.</p>\n<p>It is the routine that helps maintain the habit.</p>\n<h2 id=\"Start-Small\"><a href=\"#Start-Small\" class=\"headerlink\" title=\"Start Small\"></a>Start Small</h2><p>I often end up coaching people who want to start some new habit.  Maybe you’ve been reading my blog and you’ve been challenged to start implementing <a href=\"/categories/TDD/\">Test Driven Development</a>.  What I find is that people want to start at the end.  So, let’s say you want to run 3 miles every day.  If you start out the first day and run three miles, I can pretty much assure you that you’ll give up right away.  No, what we need to do is something much smaller.</p>\n<p>I started exercising a couple of years ago, I realized that if exercising required me to go to a gym, I was never even going to get started.  The question I often ask people is, “What CAN you do?”  So I asked myself that question.  The answer came back, “I can do one exercise every hour and a half during the day.</p>\n<p>Then I started working outside of the house and the change in routine slowly eroded my ability to exercise.  So once again, I asked myself, “what CAN you do?”  I can do one exercise every morning.  Once I’ve established that habit, I plan on increasing to two exercises.</p>\n<p>So, if you want to start with TDD, probably the best way to start is to write a test.  One test.  Maybe commit to writing one test a day.  Think about it, if you are afraid that TDD won’t be accepted in your organization, who’s going to complain about one little test?  Or maybe better, just commit to a half hour of writing tests every day.  This allows you to get started without taking the huge time commitment learning TDD properly would take, which is probably what is keeping you from starting in the first place.  Start today.  Start now.  In a year, see if it hasn’t become how you develop code.</p>\n<p>What I’m still working on are ways that I react to situations.  These are a bit trickier to change because most of my responses are what people would called “learned responses.”  What I need to figure out is, 1) where did I learn these responses, 2) why did I learn them and 3) do the responses still make sense?</p>\n<h2 id=\"Better-Than-Before\"><a href=\"#Better-Than-Before\" class=\"headerlink\" title=\"Better Than Before\"></a>Better Than Before</h2><p>A couple of resources caught my eye this week that I think you might be interested in if you are interested in killing bad habits or starting a new one.</p>\n<p>The first is a new book by Gretchen Rubin called, <a href=\"/betterThanBefore\">Better Than Before: Mastering the Habits of Our Everyday Lives</a><img src=\"//ir-na.amazon-adsystem.com/e/ir?t=davmbusnetapp-20&l=as2&o=1&a=0385348614\">which will be out by the time this post goes live (I write these blog post well in advance of when you actually see them).</p>\n<p>What I’ve found particularly interesting is that Gretchen has developed a framework for how to determine how people respond to expectations, and <a href=\"//www.gretchenrubin.com/happiness_project/2014/03/quiz-are-you-an-upholder-a-questioner-a-rebel-or-an-obliger/\">you can take a test to find out how you respond to expectations</a>.</p>\n<ul>\n<li>Upholders: respond readily to outer and inner expectations.</li>\n<li>Questioners: question all expectations; they’ll meet an expectation <em>if</em> they think it makes sense; essentially, they make all expectations into inner expectations</li>\n<li>Obligers: meet outer expectations, but struggle to meet expectations they impose on themselves</li>\n<li>Rebels: resist all expectations</li>\n</ul>\n<p>Gretchen says, if you don’t want to take the test, you are probably a rebel, so don’t worry about it ;).</p>\n<p>Anyhow, I’m looking forward to reading the book when it comes out.</p>\n<p>I came out as an upholder, which is no real big surprise.  There are areas of my life that are HEAVILY influenced by what I think people expect of me, and I tend to question new expectations that are imposed on me.</p>\n<p>And yet, I still have trouble trying to implement new habits in my life.</p>\n<h2 id=\"Coach-ME\"><a href=\"#Coach-ME\" class=\"headerlink\" title=\"Coach ME\"></a>Coach ME</h2><p>This brings me to my second resource.  I’ve known about this one for a while, but I’ve just recently really started using it.</p>\n<p><a href=\"https://coach.me/\">Coach.me</a> is an app for iPhone and Android that allows you to use the power of community and accountability to help you establish your habits and achieve your goals.  If you want, or need, there is also  coaching that you can pay for if you want or need a little extra help.</p>\n<p>Right now, I’m just using the alarm and check-in feature.  Somehow being able to open the app and check the box that says I finished a particular activity is enough encouragement for me to not blow it off.  It probably helps that if I don’t check it off, I’ll forever have a hole in my calendar forever saying, “Yo!  you missed a day.” At some point, I may actually use one of the coaches.  I keep looking, but I haven’t found anyone that looks like someone I can relate to.  Or, maybe I just need to grow out of my 3 year old self that wants to do everything on my own.  That’s another area I’m working on.</p>\n",
            "tags": [
                "tdd",
                "habits"
            ]
        },
        {
            "id": "http://davembush.github.com/dependency-injection-frameworks-are-not-dependency-injection/",
            "url": "http://davembush.github.com/dependency-injection-frameworks-are-not-dependency-injection/",
            "title": "Dependency Injection Frameworks Are NOT Dependency Injection",
            "date_published": "2015-03-12T11:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/02/land-0148.jpg\" alt=\"land-0148\" title=\"land-0148\"></p>\n<p>As you start your journey down the road of Unit Testing you will discover that part of what makes code testable is this concept of <a href=\"//en.wikipedia.org/wiki/Dependency_injection\" title=\"Dependency injection\">Dependency Injection</a>.  As you explore further, you will see people mentioning various Dependency Injection frameworks.</p>\n<p>You may naturally assume that to implement Dependency Injection, you will need to select an use a Dependency Injection framework.</p>\n<p>But, Dependency Injection has nothing to do with using a Dependency Injection framework.  The frameworks are there because:</p>\n<ol>\n<li> much of our existing code is code that has too many dependencies and the framework helps us break those dependencies without having to refactor too much of our code and</li>\n<li>to give us a way to easily swap out one object for another when our code is structured in such a way as to not have dependencies at all.</li>\n</ol>\n<span id=\"more\"></span>\n\n<h2 id=\"So-what-then-is-Dependency-Injection\"><a href=\"#So-what-then-is-Dependency-Injection\" class=\"headerlink\" title=\"So, what then is Dependency Injection?\"></a>So, what then is Dependency Injection?</h2><p>I once heard this maxim that explains it best,</p>\n<blockquote>\n<p>Classes should either create stuff, or do stuff, but no one class should do both.</p>\n</blockquote>\n<p>Much of our code looks something like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">ReceiveSAMLResponse</span>(<span class=\"params\"></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    <span class=\"keyword\">out</span> SAMLResponse samlResponse,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    <span class=\"keyword\">out</span> String relayState</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Receive the [SAML](//en.wikipedia.org/wiki/Security_Assertion_Markup_Language &quot;Security Assertion Markup Language&quot;) response over the</span></span><br><span class=\"line\">    <span class=\"comment\">//specified binding.</span></span><br><span class=\"line\">    XmlElement samlResponseXml;</span><br><span class=\"line\"></span><br><span class=\"line\">    ServiceProvider.ReceiveSAMLResponseByHTTPPost(</span><br><span class=\"line\">        HttpContext.Current.Request,</span><br><span class=\"line\">        <span class=\"keyword\">out</span> samlResponseXml, <span class=\"keyword\">out</span> relayState);</span><br><span class=\"line\">    SAMLResponse resp = <span class=\"keyword\">new</span> SAMLResponse(samlResponseXml);</span><br><span class=\"line\">    XmlElement samlAssertionElement =</span><br><span class=\"line\">        resp.GetSignedAssertions()[<span class=\"number\">0</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Verify the response&#x27;s signature.</span></span><br><span class=\"line\">    XmlDocument doc = <span class=\"keyword\">new</span> XmlDocument();</span><br><span class=\"line\">    <span class=\"comment\">//metadata file path (holds the description key).</span></span><br><span class=\"line\">    doc.Load(HttpContext.Current.Server.MapPath(<span class=\"string\">&quot;~/SAML.xml&quot;</span>));</span><br><span class=\"line\">    XmlElement root = doc.DocumentElement;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!SAMLAssertionSignature.Verify(</span><br><span class=\"line\">        samlAssertionElement, ReadMetadata(root)))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        samlResponse = <span class=\"literal\">null</span>;</span><br><span class=\"line\">        relayState = <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Deserialize the XML.</span></span><br><span class=\"line\">    samlResponse = <span class=\"keyword\">new</span> SAMLResponse(samlResponseXml);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Yes, this is real code from a system I worked on.  The original code was written three or four years ago and this specific code is code I was given by another company.  I just used copy and paste inheritance to get it working in our code.</p>\n<p>That’s not to say I haven’t written code that has just as many problems.</p>\n<p>There are several things that are wrong with this code, but for now all I want to focus on is the Dependency Injection issue.</p>\n<p>All this code is trying to do is to deserialize the encrypted samlResponse object that was posted to the login form.  At least this code isn’t in the login form!  It has that much going for it.</p>\n<h2 id=\"But-here-are-places-where-it-is-dependent-on-too-much\"><a href=\"#But-here-are-places-where-it-is-dependent-on-too-much\" class=\"headerlink\" title=\"But here are places where it is dependent on too much:\"></a>But here are places where it is dependent on too much:</h2><ul>\n<li>ServiceProvider is a static class and called directly.</li>\n<li>ReceiveSAMLResponseByHTTPPost is dependent on the Request object that we retrieve from HttpContext.</li>\n<li>I create a new SAMLResponse object right before I call GetSignedAssertions()</li>\n<li>I create a new XmlDocument object so I can load the SAML.xml file</li>\n<li>SAMLAssertionSignature is static and called directly</li>\n</ul>\n<p>In fact, this method is one huge dependency mess.  And I’m very aware of the mess that it is in because the company we wrote this code for just recently switched providers.  As we tried to get this working, I had no way of testing this code in isolation without adding code directly into this method.  We got it working, but it didn’t have to be that hard.</p>\n<h2 id=\"So-here’s-what-I’d-do-to-this-code\"><a href=\"#So-here’s-what-I’d-do-to-this-code\" class=\"headerlink\" title=\"So, here’s what I’d do to this code.\"></a>So, here’s what I’d do to this code.</h2><ul>\n<li>Since ServiceProvider and SAMLAssertionSignature are calls to a third party API, I would wrap them in a none static class that I can instantiate.</li>\n<li>I would have the class that ultimately calls this method either pass in the dependent objects to the constructor, pass them in to the method that calls this, or set properties in the class.  This is what it means to inject dependencies.</li>\n<li>I would look for some way to avoid creating a new SAMLResponse object.  I’m not looking at the API documentation, but it would be great if I could new up the object and call a method, or set a property to give it the samlResponseXml variable.  If I had to, I’d probably wrap SAMLResponse in another class so that I could gain this functionality.</li>\n<li>Finally, I would make each of the dependent object based on an interface so that I could swap them out.  In the case of some of these classes, I may need to wrap them in another class that I have control over so that I can implement an interface.  For example, as things stand, I would not be able to create a fake request object because Request is a system class that does not implement an interface.</li>\n</ul>\n<h2 id=\"Advantages\"><a href=\"#Advantages\" class=\"headerlink\" title=\"Advantages\"></a>Advantages</h2><p>After making all of these changes, I would be able to create a test harness for this code, create fake versions of the objects, and verify that this method does what we intend for it do.</p>\n<p>Where this would have been particularly helpful is over this last week when we were trying to get this all working with the new provider.  In that case, I could have faked out the request object with what they were sending us and run it through a debugger to figure out what wasn’t quite right.</p>\n<h2 id=\"No-Dependency-Injection-Framework\"><a href=\"#No-Dependency-Injection-Framework\" class=\"headerlink\" title=\"No Dependency Injection Framework\"></a>No Dependency Injection Framework</h2><p>Finally, you’ll notice that no where in this code did I have to use a Dependency Injection framework to get this all working.</p>\n",
            "tags": [
                "tdd",
                "test driven development",
                "testing",
                "dependency injection"
            ]
        },
        {
            "id": "http://davembush.github.com/why-johnny-can-t-do-test-driven-development/",
            "url": "http://davembush.github.com/why-johnny-can-t-do-test-driven-development/",
            "title": "Why Johnny Can't do Test Driven Development",
            "date_published": "2015-03-05T12:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/02/ppl-kid-05.jpg\" alt=\"ppl-kid-05\" title=\"ppl-kid-05\"></p>\n<p>Last week we looked at a few excuses developers give for not testing their code as they develop it (<a href=\"/excuses-for-not-testing/\">Excuses For Not Testing</a>).  We finished that by mentioning that most of the code you write simply isn’t testable.  You can’t practice Test Driven Development on something that isn’t testable in the first place. And there, folks, is why Johnny can’t test.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"But-it’s-not-Johnny’s-fault\"><a href=\"#But-it’s-not-Johnny’s-fault\" class=\"headerlink\" title=\"But, it’s not Johnny’s fault.\"></a>But, it’s not Johnny’s fault.</h2><p>Think about what makes code testable.  At it’s core, testable code is loosely coupled.  But what do we mean by “loosely coupled”? Well, let’s start with the large picture.  Assuming you have a multi-layered architecture.  That is, you have your code broken out into View, Business Rules, and Data Access.  Raise your hand if your business rules access your view directly.  Would you be able to test your business rules without your view? At a finer level of detail.  How much of your code creates the objects it needs within the same class, or worse, the same method, that will need it?  Without using a Dependency Injection framework, could you swap out any objects your class uses?  Have you even heard the rule, “Classes should either create things or do things, but never both within the same class?”  If you did that, how much more testable would your code be? If you were to write a test for a method, how much setup work would you have to do?  If it is more than a few lines, your method is probably doing too much, either directly or indirectly.  You’ll need to find a way to make it do less.</p>\n<p>Maybe in future post, I’ll address some of these issues in code.  But for now, I just want to address the problem.</p>\n<p>Again, it isn’t Johnny’s fault that he doesn’t know this stuff.  Think about the code samples we tend to look at.</p>\n<h2 id=\"When-is-the-last-time-you-saw-sample-code-that-was-testable\"><a href=\"#When-is-the-last-time-you-saw-sample-code-that-was-testable\" class=\"headerlink\" title=\"When is the last time you saw sample code that was testable?\"></a>When is the last time you saw sample code that was testable?</h2><p>Short rant here, but I’ve been working with EXTjs (version 4.x) for the last year and a half.  Sencha will tell you that this uses a MVC architecture.  But what they mean by “Controller” really functions more like a “ViewController.”  That is, the controller is tightly bound to the view that it handles events for.  The way they have things setup, you access View elements by getters that are automatically generated for you in the view.</p>\n<p>The problem with this is that you can’t really test the controller logic without bringing along the view.</p>\n<p>Sencha isn’t the only company who does this.  Most of the sample code for WebForms did the same kind of thing.</p>\n<p>Now, the reason this is an issue is that sample code is how most of the newer programmers are learning how to program.</p>\n<p>I heard recently that statistically, because of the growth of the industry, half of the programmers available have 5 years or less of experience.  I don’t know about you, but the first 5 years of my programming career, I was still figuring out how to program.  I wasn’t thinking about architecture issues and I certainly wasn’t thinking about formal testing.  From what I’ve seen of the new recruits, I don’t think they are either.  Shoot.  Some of the ones I’ve interacted with couldn’t code themselves out of a paper bag without help.</p>\n<h2 id=\"And-so-what’s-the-conclusion-to-all-of-this\"><a href=\"#And-so-what’s-the-conclusion-to-all-of-this\" class=\"headerlink\" title=\"And so, what’s the conclusion to all of this?\"></a>And so, what’s the conclusion to all of this?</h2><p>I don’t know.  Maybe the first step is to admit that we have an issue here and that the issue is so much a management or time issue as it is an education and laziness issue.  That the code we generate shouldn’t assume that people will take the code and adapt it into testable code, but that we should write testable code as our sample code.  Maybe colleges should teach basic software architecture and TDD as part of the curriculum.  Maybe those of us who know better should just start testing and figure this all out well enough to explain it to others.</p>\n",
            "tags": [
                "tdd",
                "test driven development",
                "testing",
                "bdd"
            ]
        },
        {
            "id": "http://davembush.github.com/excuses-for-not-testing/",
            "url": "http://davembush.github.com/excuses-for-not-testing/",
            "title": "Excuses For Not Testing",
            "date_published": "2015-02-26T12:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/02/ppl-kid-044.jpg\" alt=\"ppl-kid-044\" title=\"ppl-kid-044\"></p>\n<p>As I started my own journey into unit testing, I slowly began to realize that it was really easy to come up with reasons to NOT test my code as I was writing it, even once I understood what that was supposed to look like. The reason I think most programmers don’t unit test code, once they understand what it is they are supposed to be doing is that they don’t feel like they have permission. To this I also answer, “How much permission do you need?”</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Do-you-really-need-permission\"><a href=\"#Do-you-really-need-permission\" class=\"headerlink\" title=\"Do you really need permission?\"></a>Do you really need permission?</h2><p>Do you ask for permission to compile and link the code? Do you ask for permission to write every line of code to make the system do what it should do? Do you ask for permission to run your code periodically to make sure it does what you had in mind when you wrote the code? Do you periodically add code that makes you feel good but is not directly related to the task at hand? (Admit it, I don’t think I know of any programmer who doesn’t.) Then why do we feel like we need permission to write unit test for our code?</p>\n<h2 id=\"Are-you-convinced-that-you-need-test\"><a href=\"#Are-you-convinced-that-you-need-test\" class=\"headerlink\" title=\"Are you convinced that you need test?\"></a>Are you convinced that you need test?</h2><p>We don’t write test code because we aren’t convinced it is necessary to do the job we’ve been given. We complain that our managers don’t want us to write unit test. But the problem is that you asked for permission in the first place. And, by asking for permission, you’ve basically told your manager that unit testing is optional. Your manager has said “no” because he thinks YOU think it is optional.</p>\n<h2 id=\"It’s-not-your-manager’s-job\"><a href=\"#It’s-not-your-manager’s-job\" class=\"headerlink\" title=\"It’s not your manager’s job\"></a>It’s not your manager’s job</h2><p>It isn’t his job to understand that not testing will produce technical debt. He’s not even interested in understanding what technical debt is. All he cares about is this. When will this project be done?  When you say it is done, will it work as expected or will it have a lot of bugs that need to be fixed yet? Most of the managers I’ve worked for in the past will accept whatever number I give them once they understand that when I deliver the software to them, it is going to work.  In fact, I’ve even gotten asked to do jobs BECAUSE my code tends to work more often than anyone else they know who could do the job.</p>\n<p>Now, I will admit, that in some cases there are places where you’ve been explicitly told to not create unit test. But even here I will assert it is because someone asked management the question.</p>\n<h2 id=\"Why\"><a href=\"#Why\" class=\"headerlink\" title=\"Why?\"></a>Why?</h2><p>And so, we need to evaluate why it is we think creating unit test are optional. Probably because what we’ve been doing for so long seems to be working and, when we try to incorporate unit test, the process seems slower.</p>\n<p>And it is.</p>\n<p>Initially, writing unit test is slower just like writing using a new language or a new framework or anything else new is slower than what we know.</p>\n<p>But the ultimate efficiency that writing unit test as we code provides has been proven to more than offset the learning curve involved.</p>\n<p>There is one other valid reason for not testing and that is, we simply don’t know how.  This is almost as big of a reason as not believing it is worth while.  But, I think if we thought testing was really worth while, we’d start testing and figure it out as we went along.</p>\n<p>If you think about your career, I bet there are a lot of things you know now that you didn’t know when you started out.  The fact of the matter is, most of us learn on the job.  We start out with basic skills, but it is the day to day implementations that improve those skills.</p>\n<blockquote>\n<h5 id=\"Don’t-let-the-good-enough-be-the-enemy-of-the-perfect\"><a href=\"#Don’t-let-the-good-enough-be-the-enemy-of-the-perfect\" class=\"headerlink\" title=\"Don’t let the good enough be the enemy of the perfect.\"></a>Don’t let the good enough be the enemy of the perfect.</h5></blockquote>\n<p>Don’t let the good enough be the enemy of the perfect.  Your first set of test will be garbage.  As you stick with it, you’ll wonder what you were thinking when you wrote your first test.  But this should not deter you.  This is what happened when you first started coding.  Maybe it is still happening.  No worries.  It is the practice that will make you better able to write tests and better able to write code that is testable.</p>\n<p>And there is another reason we don’t test.  Most of the code you are currently writing simply isn’t testable.  But, that’s the subject for another post.</p>\n",
            "tags": [
                "tdd",
                "test driven development",
                "testing",
                "bdd"
            ]
        },
        {
            "id": "http://davembush.github.com/software-architecture-without-test-driven-development-is-dangerous/",
            "url": "http://davembush.github.com/software-architecture-without-test-driven-development-is-dangerous/",
            "title": "Software Architecture without Test Driven Development is DANGEROUS!",
            "date_published": "2015-01-29T12:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/01/TddImpactsSoftwareArchitecture.png\" alt=\"TDD Impacts Software Architecture\" title=\"TddImpactsSoftwareArchitecture\"></p>\n<p>I’ve had two incidents recently that have shown me how TDD impacts Software Architecture.  Both of these are with code I’m working on.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"What-Software-Architecture-Might-Do\"><a href=\"#What-Software-Architecture-Might-Do\" class=\"headerlink\" title=\"What Software Architecture Might Do\"></a>What Software Architecture Might Do</h2><p>Software architecture might specify how it is put together at a very high level.  For example, software architecture might specify that we use a three tiered approach or an n-tiered approach.  This approach places our view code is at one level, our business rules are at another level, and our data access at yet a third level.</p>\n<p>Software architecture might specify that we use MVC where our business rules are in the model, and a controller communicates between the view and the model to get data between the two.</p>\n<p>It might specify MVVM. This would have the view model take the place of the controller and manage the state information for the view.</p>\n<p>Software architecture might also tell us we should use MVP, giving the presenter the role of the controller and managing state information for the view and communicating with the business rules.</p>\n<p>But none of these patterns tell us how to write maintainable code.  They only tell us about the general software architecture.  This is like having a sketch of a house without a wiring or plumbing plan.</p>\n<h2 id=\"When-the-view-gets-in-the-way\"><a href=\"#When-the-view-gets-in-the-way\" class=\"headerlink\" title=\"When the view gets in the way\"></a>When the view gets in the way</h2><p>So, if you’ve been following this blog for a while, you may remember that I’m working with EXTjs.  Specifically, I’m working with EXTjs 4.2.  This has what Sencha calls an MVC architecture.  The problem is, what they refer to as the “Model” we would all recognize as a “Record” in a table, and their Controller is tightly coupled to their View.  That is, they call this MVC, but no one who understands what MVC is supposed to look like as a design pattern would recognize Sencha’s MVC as the real MVC design pattern.</p>\n<p>This makes the code incredibly hard to test.  The tendency is to write code that is highly dependent on the view.  The view is dependent on the DOM.  Rendering the view takes quite a bit of time.  So any test of your business rules end up taking an incredibly long time to test because they ultimately cause DOM manipulation to occur.</p>\n<p>It isn’t until you decide to borrow a bit of architecture from Angular that you realize that your business rules should be separate classes.  Angular has “Service Classes.” My Service classes are built specifically so they do not rely on anything else.</p>\n<p>By doing this, I was able to get two thirds of my code under test that run in about a second.  Prior to this, they took a half an hour.</p>\n<p>My next task was to get the view and my logic for enabling and disabling controls on the view more loosely coupled.  This was a bit more difficult because enabling and disabling controls is, naturally, a view thing.</p>\n<p>But again, taking a page from another framework, this time Knockout and Angular, I created a ViewModel.  My ViewModel holds the state of my view separate from the actual view.  When the state changes, it fires an event that actually changes the view, but this will allow me to test my enable&#x2F;disable logic, along with other code in my system, without ever instantiating the view.  Under test, the events will fire and nothing will happen.</p>\n<h2 id=\"Avoiding-Dependencies\"><a href=\"#Avoiding-Dependencies\" class=\"headerlink\" title=\"Avoiding Dependencies\"></a>Avoiding Dependencies</h2><p>Now the structure  of my code looks something like the following: View – ViewModel – EnableDisableController – EnableDisableService I could have put the EnableDisableService code in the EnableDisableController, and many people would, but what I’ve found is that if I do that, it would be nearly impossible to UNIT test my Enable&#x2F;Disable logic.  Why?  Because I would be creating all of the objects I needed for the logic in the same class the logic is in.</p>\n<p>By breaking the logic code into it’s own class that takes the ViewModel as a construction parameter, I can create my own ViewModel that looks exactly like what I need it to look like so that I can test the logic with entirely known values.</p>\n<p>These are just two of the ways that code architecture is impacted by Test Driven Development.  I’m sure there are others.</p>\n",
            "tags": [
                "tdd",
                "mvvm",
                "mvp",
                "MVC",
                "dependency injection",
                "software architecture"
            ]
        },
        {
            "id": "http://davembush.github.com/specflow-strategy/",
            "url": "http://davembush.github.com/specflow-strategy/",
            "title": "SpecFlow Strategy",
            "date_published": "2015-01-01T12:00:00.000Z",
            "content_html": "<p>A while ago I wrote an article <a href=\"/what-is-specflow/\">explaining what SpecFlow is, and why you might want to use it</a>.  I’ve been using it for several months now and I’ve recognized several patterns that have emerged in my usage that I wish I had known when I started, so I thought I’d share them with you today.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Small-Features\"><a href=\"#Small-Features\" class=\"headerlink\" title=\"Small Features\"></a>Small Features</h2><p>If you are used to BDD or even unit testing, this will be obvious.  But if you are new to all of this, the temptation is going to be to put all of your test in one feature.  While this works in the strictest sense of the word, and you are at least getting test in place, you will find that finding a specific test later on is going to be rather awkward.</p>\n<p>A feature file should really only have a few scenarios that are testing a particular feature in the system.  This is why, at the top of your feature file, you are stating what exactly the feature is:</p>\n<p>As an administrator<br>I need to be able to delete existing users<br>So they cannot access the system any more</p>\n<p>Which we would probably put in the “DeleteUser.feature” file. Now that we’ve specified the feature, we need one or more scenarios for this. Each scenario is going to test the various ways you might be able to delete a user.  Maybe you can check boxes and delete them all at once or you can click one button per user and delete them one at a time.  Each of those is a scenario.  So your scenarios might look like this:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Scenario: Delete one user at a time</span><br><span class=\"line\">    Given I have 10 users in the system</span><br><span class=\"line\">    And I have logged in as an administrator</span><br><span class=\"line\">    And I have navigated to the user admin page</span><br><span class=\"line\">    When I click the first delete user button</span><br><span class=\"line\">    Then I only have 9 users in the system</span><br><span class=\"line\">    And I remain on the user admin page</span><br><span class=\"line\"></span><br><span class=\"line\">Scenario: Delete one users at a time with checkbox</span><br><span class=\"line\">    Given I have 10 users in the system</span><br><span class=\"line\">    And I have logged in as an administrator</span><br><span class=\"line\">    And I have navigated to the user admin page</span><br><span class=\"line\">    When I check the checkbox of the first user</span><br><span class=\"line\">    And I click the delete checked users button</span><br><span class=\"line\">    Then I only have 9 users in the system</span><br><span class=\"line\">    And I remain on the user admin page</span><br><span class=\"line\"></span><br><span class=\"line\">Scenario: multiple users at a time using the checkbox</span><br><span class=\"line\">    etc ...</span><br></pre></td></tr></table></figure>\n\n<p>What about sad path test?  You’ll need to determine if those are another feature or if they are somehow part of the feature you are working on.  For this test, I can’t think of a sad path test for deleting users that is generally applicable.  Most of the time, if you have something that should occur as part of deleting a user, you should be doing that as part of the delete process.</p>\n<h2 id=\"Don’t-Repeat-Yourself\"><a href=\"#Don’t-Repeat-Yourself\" class=\"headerlink\" title=\"Don’t Repeat Yourself\"></a>Don’t Repeat Yourself</h2><p>The next place you are likely to make a mistake as you learn how to use SpecFlow is that you’ll start out thinking of the feature file, the steps implementation for the features and any setup or teardown of the scenarios as all one unit.  As a result of this, you’ll tend to implement the steps and the setup and teardown (what SpecFlow implements as Before and After) all in one file.</p>\n<p>The problem with this is that you’ll end up with a lot of duplicate code in your tests.</p>\n<p>Now, let’s say each of your features have similar setup code you need to implement.  In the case of our user administration example that we started out with, you’ll have code you need to implement for adding a user, deleting a user, adding roles to a user, searching for a user, and probably more.</p>\n<p>For each of those, your Before code is all going to look the same.  So, what I would recommend that you do is create a separate file with your Before and After code in it, nothing more.  You will associate this file with your feature files by associating a category with it and using the category in your feature files.  Now for each feature, the same Before and After code will run.</p>\n<p>The other issue you are going to have is that you are going to have a lot of the same steps between the feature files.  However, my experience has been that there will be a lot more common features between the code I write for a particular screen than there will be for the Before and After code I write.  For example, I might right Before code for various roles</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">As a regular user</span><br><span class=\"line\">When I visit the user administration screen</span><br><span class=\"line\">I should not be able to view any user other than myself.</span><br></pre></td></tr></table></figure>\n\n<p>That will require different setup code from “As an administrator” but the steps to implement the scenarios will probably be very similar.</p>\n<p>Therefore, you should have a step file that holds all the steps for a screen full of logic in a file separate from your Before and After logic.</p>\n",
            "tags": [
                "tdd",
                "programming",
                "test driven development",
                "specflow"
            ]
        },
        {
            "id": "http://davembush.github.com/selenium-performance-improvements/",
            "url": "http://davembush.github.com/selenium-performance-improvements/",
            "title": "Selenium Performance Improvements",
            "date_published": "2014-10-02T10:00:00.000Z",
            "content_html": "<p>As many of you know, I’ve been using <a href=\"//www.seleniumhq.org/\">Selenium</a> to do my website testing.  And, if you’ve done any testing with Selenium yourself, you know that Selenium can be even slower if you are using Selenium Grid. There are several things you might do today to achieve Selenium Performance improvements in order to increase the speed that your of your test run.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"CacheLookup-attribute-or-Annotation-if-you-are-using-Java\"><a href=\"#CacheLookup-attribute-or-Annotation-if-you-are-using-Java\" class=\"headerlink\" title=\"CacheLookup attribute (or Annotation if you are using Java)\"></a>CacheLookup attribute (or Annotation if you are using Java)</h2><p>This is probably the most obvious place for improvement.  Assuming you are using the Page Model pattern in your testing, your page model should have properties that already look something like:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">FindsBy(How = How.Id, Using = <span class=\"string\">&quot;radioButton&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"keyword\">private</span> IWebElement RadioButton&#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>;&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>What you may not know is that the way this works is that EVERY time you access the property named RadioButton it will lookup the location of the radio button.  The RadioButton property is actually a proxy for the real IWebElement that it will lookup on the fly. So, if you are using the element more than once in your test, it will perform the lookup each time you access the RadioButton property. By adding the CacheLookup attribute to the RadioButton property,</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">FindsBy(How = How.Id, Using = <span class=\"string\">&quot;radioButton&quot;</span>), CacheLookup</span>]</span><br><span class=\"line\"><span class=\"keyword\">private</span> IWebElement RadioButton&#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>;&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>you can force the RadioButton to be resolved once and only once. Most of my test ask for elements once per test, so I didn’t see any major performance gains by adding this.  Your mileage may vary.</p>\n<h2 id=\"CacheLookup-Warning\"><a href=\"#CacheLookup-Warning\" class=\"headerlink\" title=\"CacheLookup Warning\"></a>CacheLookup Warning</h2><p>Be careful when adding CacheLookup to your properties because any time the HTML is recreated, the element will become “stale” and you’ll need to look it up again. For example, in one of the pages I’m testing, I have two modal windows that get created as part of the test.  Each time they are created, they have to be resolved again because the old ones no longer exist. It would be like trying to reference a pointer to an object that no longer exist because something else deleted it.  Actually, that’s exactly what is happening.</p>\n<h2 id=\"CacheLookup-Only-Solves-One-of-Your-Problems\"><a href=\"#CacheLookup-Only-Solves-One-of-Your-Problems\" class=\"headerlink\" title=\"CacheLookup Only Solves One of Your Problems\"></a>CacheLookup Only Solves One of Your Problems</h2><p>But if all you do to your site is add CacheLookup, you are wasting your time.  You have to start thinking like your code. Did you know that every time you access a property on an IWebElement, Selenium has to make a call to the browser to access the current value? Yep. Actually, if you think about it, this is what you hope it does.  It is what makes code like this work:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Wait.Until(x =&gt; Page.RadioButton.GetAttrinbute(<span class=\"string\">&quot;disabled&quot;</span>));</span><br></pre></td></tr></table></figure>\n\n<p>But how many times to we write code that goes after a property multiple times when we know the value, or at least we assume the value, hasn’t changed? Or how many of you are doing the same thing multiple times in the same test? For example, in the code I’m testing currently, I have a header and a footer that I need to hide so that when an element is scrolled into view by Selenium, it doesn’t scroll under the header or the footer. I’m currently hiding and showing every time I perform some action on an element.  But now that I’m starting to think about performance, I’m asking myself, “What was I thinking?!” In this case, I would save a lot of time by turning the header off once a the beginning of my test.  I bet my test end up running twice as fast simply by doing that. So, keep in mind that every Selenium call you make is probably going to have to access the server in order to perform the action or retrieve the value you are looking for and try to write your code so that you are only making that call to the server one time per test. I bet you see some performance improvements.</p>\n",
            "tags": [
                "tdd",
                "c#",
                "bdd",
                "selenium",
                "java"
            ]
        },
        {
            "id": "http://davembush.github.com/is-your-architecture-crippling-your-unit-testing/",
            "url": "http://davembush.github.com/is-your-architecture-crippling-your-unit-testing/",
            "title": "Is Your Architecture Crippling Your Unit Testing?",
            "date_published": "2014-09-04T10:00:00.000Z",
            "content_html": "<p>Last week I wrote a post that talked about Unit Testing and the need to make sure you are only testing one particular unit of code at a time.  The post was well received.  But I am surprised that no one commented on the glaring hole I left in the post.</p>\n<p>In that post, I said:</p>\n<blockquote>\n<p>So, one way you might go about separating your code from the data is by using dependency injection.  What I’m talking about here is simple injection.  No frameworks.</p>\n<p>So, let’s say you have a class you may have called user role.  Given a user id, it will return a role.  How could we code this so that it doesn’t matter where the code comes from?</p>\n<p>By declaring an interface to a user role object maybe and then passing an object of that type to the constructor.</p>\n<p>By doing this, you can use a fake object when you are testing and a real object when you are using the system in production, but your code won’t really care which one is being used.</p>\n<p>At some point we will need to retrieve data.  But the data is always just a side effect.  If you have a way of getting at the data, and you are confident it works, because that standard mechanism has been tested, then you don’t need to write test for the data access piece, you only need to write test for “given I have good data, this method will do this.”</p>\n</blockquote>\n<p>As I reflected on the post, I realized that this may make sense to you if you are already implementing this in your code.  But, if you are new to dependency injection and the concepts of loose coupling in general, this might be a foreign concept for you.</p>\n<p>At the very least, I realize now that it could be flushed out a bit more.</p>\n<p>So, here we go.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"N-Tiered-Architectures\"><a href=\"#N-Tiered-Architectures\" class=\"headerlink\" title=\"N-Tiered Architectures\"></a>N-Tiered Architectures</h2><p>There are two primary architectural patterns in the coding ecosystem that I live in.  The first, which has been around for a very long time is the N-Tiered, or 3 Tiered architecture.  The main point of this is to separate the Presentation from the Business rules from the retrieval of the data.</p>\n<p>Code written using this model normally has the view code dependent on the business logic code which is dependent on the data retrieval code.  And, even though we can use interfaces and dependency injection code to swap out each layer, most of the code written using this architecture that I’ve seen ends up being far too dependent on the code under it than it should be.</p>\n<h2 id=\"MVC-or-MVP\"><a href=\"#MVC-or-MVP\" class=\"headerlink\" title=\"MVC or MVP\"></a>MVC or MVP</h2><p>The second architectural pattern I see a lot of is the Model View Controller(MVC) pattern and it’s close cousin, Model View Presenter(MVP).  This pattern also attempts to separate the presentation, and the data and uses the controller as the way of moving the data between the two.  In this pattern, you will often see the controller or presenter layer used as the location of the business logic.  But strictly speaking that’s not the intended purpose.  When the controller or presenter is used for business logic you end up with a similar problem here that we end up with in a strict 3 tiered architecture.  The code ends up being far too dependent on either the architecture or the specific implementation of the architecture.</p>\n<h2 id=\"The-Problem\"><a href=\"#The-Problem\" class=\"headerlink\" title=\"The Problem\"></a>The Problem</h2><p>Now here’s the deal.  And I think this is where many people go astray with architectural patterns.  Just because you are using 3 Tier, MVC, or MVP (or whatever) doesn’t mean that all of your code HAS to fit into the mold of being one of the following:</p>\n<ul>\n<li>a View,</li>\n<li>a Controller, Presenter or Business layer, or</li>\n<li>a Data Access Layer or Model.</li>\n</ul>\n<p>Think about this.  How much of the code you’ve written, were you to really switch out the view, would have to be rewritten?  How much of your code could withstand the jarring effect of changing how you accessed the data.</p>\n<p>And I’m not talking a simple change.  From the data side we have multiple ways of accessing data in .NET.  We can use LINQ, we can use typed DataSets, we can use some ORM tool.  Say you decided to switch from whatever it is you are using now to one of the others.  Could you do that easily?</p>\n<p>And all of this points out the main issue I see with these frameworks.  The frameworks are only there as a way of moving data around.  With each of these it is expected that we will implement the actual presentation, business logic, and data access in an architectural agnostic way.</p>\n<p>Which finally brings us back to the comment I made last week.</p>\n<h2 id=\"The-Fix\"><a href=\"#The-Fix\" class=\"headerlink\" title=\"The Fix\"></a>The Fix</h2><p>All of your business logic shouldn’t really care where it got its data from.  It should not know where the data came from.  It should not request its own data.  It should be handed data in a form that can be used regardless of what the presentation layer looks like or what the data access layer looks like.</p>\n<p>In a three tiered model, the middle layer should work like the controller or the presenter.  It should retrieve the data from either the data layer or the presentation layer and then hand that data off to some other class that will do whatever processing needs to be done, get the return value from it and then pass it on to either the view or the data access layer.  In order to make the actual processing of the data from the view or the data access layer testable, the code we write must be architecturally, and framework agnostic.</p>\n<p>Similarly, in the presentation layer, if you have validations that you need to run on the screen, those validations need to be written in such a way that it won’t matter if or how the presentation layer changes.</p>\n<p>And here, once again, we point out, you won’t even know this is an issue if you aren’t trying to UNIT test your code.</p>\n",
            "tags": [
                "tdd",
                "unit test",
                "archietcture"
            ]
        },
        {
            "id": "http://davembush.github.com/yagni-you-aren%E2%80%99t-going-to-need-it/",
            "url": "http://davembush.github.com/yagni-you-aren%E2%80%99t-going-to-need-it/",
            "title": "YAGNI - You Aren’t Going To Need It",
            "date_published": "2014-08-14T17:00:00.000Z",
            "content_html": "<p>One of the design principles in software development is to only write what you need today.  This has taken on the moniker of YAGNI (You Aren’t Going To Need It).</p>\n<p>The question is, in what ways do we violate this principle?</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Features\"><a href=\"#Features\" class=\"headerlink\" title=\"Features:\"></a>Features:</h2><p>The most obvious situation where we tend to violate YAGNI is in feature creep.  We design in a new end user feature that seems really cool to us.  We may even try to sell the end user into believing they need the feature.  Maybe it is just eye candy.  “We can make this screen animate when it opens.”</p>\n<p>Yeah, but is that a requirement or a nice to have?  How much longer will it take to design that?  How many more bugs will it introduce?</p>\n<p>I think most of us get YAGNI at what I would call the “Visible Feature” level.  That is, what the end user will see immediately.</p>\n<p>Where I think most of us get this wrong is at the code design and architecture level.</p>\n<h2 id=\"Architecture\"><a href=\"#Architecture\" class=\"headerlink\" title=\"Architecture:\"></a>Architecture:</h2><h4 id=\"Do-you-have-a-tendency-to-over-architect-your-code\"><a href=\"#Do-you-have-a-tendency-to-over-architect-your-code\" class=\"headerlink\" title=\"Do you have a tendency to over architect your code?\"></a>Do you have a tendency to over architect your code?</h4><p>This is an impossible question to answer because I think all of us think we architect to just the right level.  So what are some signs that you have gone too far?</p>\n<p>Well, one of them might be how you defend your decision to write your code in a particular way.  If your answer is anything remotely like, “We might need it to do…” you are probably over architecting.</p>\n<p>For example, when you write your code, are you thinking about all the ways it might be used in the future?  That business rule you are writing, it might be used as a web service, or need to be accessed by JSON.  You never know.</p>\n<p>But really, unless you need it to do all of that stuff today, you are probably spending more time on the code you are writing than you need to.  Why?  Because most of the time all of those, “we might need it to…” never happen.  And when they do happen, they happen in entirely unexpected ways that you can not foresee.</p>\n<h4 id=\"But-it-will-save-time\"><a href=\"#But-it-will-save-time\" class=\"headerlink\" title=\"But it will save time!\"></a>But it will save time!</h4><p>Will it?</p>\n<p>If your code is so complex that adding in the “it might need to…” in the future is going to take more time than adding it in now, you probably have a fundamental problem with your code.</p>\n<p>Worse, as mentioned above, you will probably never need it anyhow.  So, you’ve spent extra time now to save time you wouldn’t spend in the future if you were to just wait until you need it.</p>\n<p>Aren’t you busy enough with deadlines as it is?</p>\n<h2 id=\"Prevention\"><a href=\"#Prevention\" class=\"headerlink\" title=\"Prevention:\"></a>Prevention:</h2><p>So, then the next question is, “how do we prevent over architecting?”</p>\n<p>Simple, you write Unit Test for all the code you are writing.  If you are writing code so that it can be accessed in multiple ways, you’ll need to write test that prove it can be accessed in multiple ways.  Are you willing to do that?</p>\n<p>When the tests need to be updated to reflect new business requirements, are you going to want to update them all?</p>\n<p>So the next time you, or someone you know says, “It might need to…” maybe you should ask them what the chances of them needing that really are and is it worth spending the extra time on it now.</p>\n",
            "tags": [
                "tdd",
                "xp",
                "yagni"
            ]
        },
        {
            "id": "http://davembush.github.com/what-is-specflow%E2%80%A6/",
            "url": "http://davembush.github.com/what-is-specflow%E2%80%A6/",
            "title": "What is SpecFlow…",
            "date_published": "2014-06-12T17:30:00.000Z",
            "content_html": "<h2 id=\"…And-why-do-I-want-it\"><a href=\"#…And-why-do-I-want-it\" class=\"headerlink\" title=\"…And why do I want it?\"></a>…And why do I want it?</h2><p><img src=\"/uploads/2014/06/SpecFlow.png\" alt=\"SpecFlow\" title=\"SpecFlow\">That’s what I kept asking myself every time I saw this product. Well, the last time I looked, something caught my eye enough that I decided to download it and take a look. I’m really glad I did it. So, let me attempt to explain what <a href=\"//www.specflow.org/\">SpecFlow</a> is.  First, while you can get SpecFlow+ Runner to run your test, this isn’t a completely new testing platform. Instead, it is a testing platform that works with whatever testing platform you are using to test your .NET code. So, it works with NUnit, MSTest, xUnit and MbUnit. This is good for my situation because any test I write with SpecFlow will continue to work with the tools I already have in place. Including my current test runners (<a href=\"//www.jetbrains.com/resharper/\">ReSharper</a>) and my Continuous Integration system (<a href=\"//www.jetbrains.com/teamcity/\">TeamCity</a>). I wasn’t interested in adopting a platform that wouldn’t work with these two platforms.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Where-I-got-Confused\"><a href=\"#Where-I-got-Confused\" class=\"headerlink\" title=\"Where I got Confused\"></a>Where I got Confused</h2><p>Now the part that kept me from looking at this framework for such a long time was the <a href=\"//www.specflow.org/\">home page</a>. If you go there, you will see the “Three easy steps.” 1) Specify, 2) Automate, 3) enjoy. Well, at first glance it looked like was going to have to write my test in English and then write my test in code and then I could enjoy. Why would I want to do that? So, the part they forgot to mention is that once you’ve specified your test, the Visual Studio plugin will generate your test code for you. For NUnit it actually writes the NUnit test for you. The code you do have to write is the code that translates the individual steps. But even that code gets stubbed out for you. Once you have enough of those stubbed out, to write a test, you just write the test in English, save the file, and run the test. Now that I finally understand this, I like most of what SpecFlow does. But there are a few things I wish it did differently.</p>\n<h2 id=\"What-I-like\"><a href=\"#What-I-like\" class=\"headerlink\" title=\"What I like:\"></a>What I like:</h2><ol>\n<li>It puts my test in a Given, When, Then structure like I mentioned a few weeks ago. 2) The class files it generates are all partial classes. This allowed me to keep my inheritance structure that I’m dependent on for my current NUnit testing framework. And allowed me to work around one of the shortcomings I’ve found. 3) The methods are all virtual, again, allowing for extension and flexibility. 4) Intellisense is enabled so you can see similar sentences you’ve already used as you are creating new test. 5) You can create tables of parameters for test scenarios, similar to how you can pass multiple parameters to an NUnit test with the TestCase attribute or the TestCaseSource attribute. 6) To write the supporting CSharp, code I didn’t have to learn anything new. 7) I can give the English language, none code, document to the business user and they should be able to read the test well enough to tell me if the test is an accurate reflection of what they want the system to do.</li>\n</ol>\n<h2 id=\"What-I-don’t-like\"><a href=\"#What-I-don’t-like\" class=\"headerlink\" title=\"What I don’t like:\"></a>What I don’t like:</h2><ol>\n<li>I’ve become pretty dependent on the NUnit TestFixture attribute that allows me to pass parameters to the entire test. I use this to control the testing of multiple browsers. But, I’ve recently figured out a way to run all of my browsers simultaneously rather than sequentially so I won’t need this feature in the pretty near future. Once I’ve got that working, you can be sure I’ll share it here. So, don’t forget to subscribe to this blog if you haven’t already.</li>\n</ol>\n",
            "tags": [
                "tdd",
                "testing",
                "nunit",
                "specflow",
                "mstest"
            ]
        },
        {
            "id": "http://davembush.github.com/tdd-saves-time-%E2%80%93-a-story/",
            "url": "http://davembush.github.com/tdd-saves-time-%E2%80%93-a-story/",
            "title": "TDD Saves Time – A Story",
            "date_published": "2014-05-22T16:40:00.000Z",
            "content_html": "<p><img src=\"/uploads/2014/05/TDDSavesTime_AStory.png\" alt=\"TDDSavesTime_AStory\" title=\"TDDSavesTime_AStory\">I recently had an experience writing code that proved to me, once again, that using Test Driven Development really is faster than the way I have been working. You will remember a couple of weeks ago I presented <a href=\"/automated-web-%E2%80%A6tional-testing/\">a strategy for creating test scenarios where we need to test storing data to a database from a web page</a>. </p>\n<span id=\"more\"></span>\n\n<p>Well, recently, I had a chance to use that strategy.  In that article, I talked about first testing that the data that we were sending back to the server was actually coming back correctly to the web site.  By doing this, you don’t have to track down where the problem is.  Is it in the database save routine or did it not even get from the client to the server?  This part worked pretty much as expected and my code for that worked right away so I can’t say that I saved a whole lot of time.</p>\n<p>But the part that did save me a TON of time is the second half.  Saving the data to the database without having to use the web site to create the data I wanted to save.</p>\n<p>While I was testing the client side, I saved the data to a JSON string which I used to create an object that represented the data that had been sent back.  Then in my unit test, I recreated the object from the stream and sent that into my save routine.  Once the save was done, I reloaded the object from the database.  Now I have the original object and the saved object which I can compare.</p>\n<p>And the comparison showed me that the save wasn’t quite working the way I had expected.  I actually had to go through several (10? 15? 20?) iterations of fixing and testing before I got to a point where my test was succeeding.  It took about a day to get everything working.  Imagine if I were using a manual method to test this.  Launch the web site, fill out the form (it’s a pretty long form with a lot of data) save the form, reload the form, remember what I had  filled out, verify that everything got saved.  I easily saved half a day using Test Driven Development.</p>\n<p>If you are  still on the fence as to the value of implementing test prior to writing code, I would encourage you to try it.  Just try it for 30 days.  Yes, it will be hard getting started.  Yes, it will FEEL like it takes more time to write the test first.  But as you make this part of how you develop code, you will start to see for yourself how many benefits you can realize by implementing this best practice.</p>\n",
            "tags": [
                "tdd",
                "programming",
                "testing"
            ]
        },
        {
            "id": "http://davembush.github.com/don%E2%80%99t-comment-out-that-test/",
            "url": "http://davembush.github.com/don%E2%80%99t-comment-out-that-test/",
            "title": "Don’t Comment Out That Test",
            "date_published": "2014-04-24T15:38:00.000Z",
            "content_html": "<p><img src=\"/uploads/2014/04/DeleteTDD.png\" alt=\"DeleteTDD\" title=\"DeleteTDD\"> First, at the suggestion of one of my friends who now works at <a href=\"//smartbear.com/\">SmartBear</a>, I’m going to experiment with creating audio of my post going forward.  Obviously this will lend itself to some of my post more than others, but I think it is worth experimenting with. Those of you who’ve been with me since the early days remember that I use to produce <a href=\"//www.youtube.com/user/davidmbush\">YouTube videos</a> occasionally.  I haven’t done that in a while because the post production process for videos takes so long.  I’m hoping that I don’t run into the same problem with producing audio.  Anyhow, the point of creating the audio is that many of you don’t have time to read, but would have time to listen to something on the way to work.  Assuming this experiment works out, you should be able to listen to the content on this blog during your commute, or anywhere else you are likely to listen to audio.  If you’d rather listen to this post, you can scroll to the bottom of this post and click the “Play” button.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Today’s-Problem\"><a href=\"#Today’s-Problem\" class=\"headerlink\" title=\"Today’s Problem\"></a>Today’s Problem</h2><p>What I want to talk about today is the problem anyone who has been using test driven development for a while has run into.  That is, you’ve got a suite of test that are running pretty well but one day, you are working in crunch mode and a set of previously running test stop working because of some change you’ve made recently. What are you going to do?</p>\n<h2 id=\"Crunch-Time\"><a href=\"#Crunch-Time\" class=\"headerlink\" title=\"Crunch Time\"></a>Crunch Time</h2><p>Remember it’s crunch time.  Maybe it was some bug you fixed that caused the test to stop working.  This bug is critical and you need to get the fix into production as quickly as possible.  To further complicate issues, your process won’t let you put anything into production that the <a href=\"/make-your-test-work-for-you/\">Continuous Integration</a> system you have in place says won’t build.  And by “Won’t Build” I mean either, it won’t build or the test won’t past.</p>\n<p>The temptation in this situation is to just comment out the tests with the promise that you’ll come back to it later.  But you and I both know that once you’ve commented out the tests, you are going to forget about them and move on.</p>\n<h2 id=\"It’s-Like-A-Car\"><a href=\"#It’s-Like-A-Car\" class=\"headerlink\" title=\"It’s Like A Car\"></a>It’s Like A Car</h2><p>I had a manager once who said you can compare everything to a car.  So, let’s use that to illustrate this problem.  You are driving down the road and the check engine light comes on.  What are you going to do?  Well, the prudent thing to do would be to find a garage as soon as possible and find out what the issue is.  Maybe you need oil.  Maybe it is something much more serious.  Maybe it is just a flaky light.  But you won’t know until you get it checked out.</p>\n<p>What you don’t want to do is to put a piece of tape over the light and continue on as though nothing were wrong.  Even if the light is faulty, what you want to do is to get the light fixed so that it can warn you properly when something really IS wrong.</p>\n<p>Commenting out test is a lot like putting tape over the check engine light.  Maybe the test are broken but the application really does work.  Maybe the spec changed and you need to change something about the test.  But if you comment out those test, then you don’t really know that the application works.</p>\n<h2 id=\"How-Committed-to-Test-Driven-Development-Are-You\"><a href=\"#How-Committed-to-Test-Driven-Development-Are-You\" class=\"headerlink\" title=\"How Committed to Test Driven Development Are You?\"></a>How Committed to Test Driven Development Are You?</h2><p>It is at this point in the test driven development process that you really show how committed to test driven development you are. If you comment out your test because they aren’t working, then your development process really isn’t driven by tests.  Your tests are driven by development. If you didn’t think the bug was fixed yet, would you still be thinking about moving this to production?  If you could comment out essential code in your application to fix the bug, would you do that? Of course not.  And the reason is clear.  If you did that, someone is likely to notice.</p>\n<p>The reason we are more likely to comment out a test is that it is unlikely that anyone will notice and the faster we get the bug fix into production, the better we look.</p>\n<p>But that’s really just a lie we tell ourselves.  The truth is, if you comment out those test and later a bug crops up that those test were designed to find, or worse those test were designed to catch a bug that previously existed, someone will notice that too.  And then how smart will you look? Crunch mode tells us something about our character.  Something about what we really believe.  If you are willing to comment out test, what else are you willing to take a short cut on?  If you are willing to comment out test, why did you write them to begin with? Someone who really believes that  testing is part of development will fix the test bugs along with the application bugs the same as they would fix a bug in the application that fixing a bug produced.  It’s all part of the same code base.</p>\n",
            "tags": [
                "tdd",
                "test driven development"
            ]
        },
        {
            "id": "http://davembush.github.com/make-your-test-work-for-you/",
            "url": "http://davembush.github.com/make-your-test-work-for-you/",
            "title": "Make Your Test Work For You",
            "date_published": "2014-04-18T15:53:00.000Z",
            "content_html": "<p><img src=\"/uploads/2014/04/TDD-CI.png\" alt=\"TDD-CI\" title=\"TDD-CI\"> So far we’ve been talking about creating test as part of the development process.  If all you ever used those test for was to make the design of your systems better, you would already be far ahead of most of your peers.</p>\n<p>But now that we have test, we might as well get as much mileage out of them as possible.  To do that, we are going to run our test every time we make a change.</p>\n<p>Now, you COULD run your test every time you make a change manually.  But who has time for that?  Certainly not me.  I doubt you do either.  And even if we did have time, there are better things we could be doing with that time if we could have those test run for us by some other process.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Continuous-Integration\"><a href=\"#Continuous-Integration\" class=\"headerlink\" title=\"Continuous Integration\"></a>Continuous Integration</h2><p>For this we need a continuous integration server.  Here’s what you want to make sure your CI server is able to do.</p>\n<ul>\n<li>Run your unit test</li>\n<li>Run your integration test</li>\n<li>Run your acceptance test</li>\n</ul>\n<p>To make sure it can do that, it will also need to be able to pull the source code from version control every time a new change is committed and build the new version.  I would bet that IF you have a CI server at all, this is all that it does.</p>\n<p>It needs to be able to notify  the developer who put the change in that the change caused a problem.  Ideally, it wouldn’t even allow  a change to go into your version control system if committing the change would cause the build or the test to fail.</p>\n<p>By implementing a CI server you are well on your way to ensuring that whatever is in version control can be released without causing any problems.</p>\n<h2 id=\"CI-Setup\"><a href=\"#CI-Setup\" class=\"headerlink\" title=\"CI Setup\"></a>CI Setup</h2><p>Since unit test are the core of your system, you’ll want to make sure that you run these test with every build.  But your integration test, and especially your acceptance test are going to take a lot longer than is practical to run as part of the process that runs with each check in.  I’ve been working on one scree of a system and so far I have about 30 hours of acceptance&#x2F;integration test using Selenium to drive 3 different web browsers.  Even if I narrowed the test down to one browser, that’s about 10 hours of test.  I don’t want to wait 10 hours to find out that my build worked (or not) and the changes that one of those test will fail is pretty small.  So, I’ve scheduled half of my test to run on one day and half of them to run on another day.</p>\n<p>With a good CI setup, you can be sure that changes you are making are not breaking code you’ve already confirmed is working.</p>\n",
            "tags": [
                "tdd",
                "test driven development",
                "CI. Continuous Integration"
            ]
        },
        {
            "id": "http://davembush.github.com/what-not-to-test/",
            "url": "http://davembush.github.com/what-not-to-test/",
            "title": "What Not To Test",
            "date_published": "2014-04-09T16:30:00.000Z",
            "content_html": "<p><img src=\"/uploads/2014/04/WhatNotToTest.png\" alt=\"WhatNotToTest\" title=\"WhatNotToTest\"></p>\n<p>Many people believe that implementing Test Driven Development means that you need to have a test for every line of code in your system.  When  they start thinking about TDD in this way, they start to feel overwhelmed and quit before they even start.</p>\n<p>I know I did.</p>\n<p>In fact, I’ve seen suggestions on places like StackOverflow that suggest as much.</p>\n<p>But there is code in your application that you shouldn’t bother to write a test for.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Generated-Code\"><a href=\"#Generated-Code\" class=\"headerlink\" title=\"Generated Code\"></a>Generated Code</h2><p>Generated code includes any code that uses some automated process to create code your system is using.  This would include code that was written by Entity Framework, NHibernate, or code generators that you may have written.  Of course, I’m assuming that you’ve written test for the code generators that test both that they generate the expected code and the code that was generated works as expected.  But to write a test for every instance of the code the generator writes is quite a bit of overkill.</p>\n<h2 id=\"Simple-Getters-and-Setters\"><a href=\"#Simple-Getters-and-Setters\" class=\"headerlink\" title=\"Simple Getters and Setters\"></a>Simple Getters and Setters</h2><p>If all your getters and setters are doing (properties) are retrieving and setting some backing store, there isn’t much point in writing a test for them.  One would assume that the code will get tested in the course of testing the code that is ultimately using the getters and setters.</p>\n<h2 id=\"Third-Party-Libraries\"><a href=\"#Third-Party-Libraries\" class=\"headerlink\" title=\"Third Party  Libraries\"></a>Third Party  Libraries</h2><p>While I know it isn’t true, you have to assume that the third party library you are using actually works.  If you can’t assume that much, you should probably write it yourself.</p>\n<h2 id=\"Your-Thinking-About-It-Wrong\"><a href=\"#Your-Thinking-About-It-Wrong\" class=\"headerlink\" title=\"Your Thinking About It Wrong\"></a>Your Thinking About It Wrong</h2><p>I would argue that if you are thinking about what you should write a test for, you are probably still thinking of Test Driven Development as something you do for the sake of testing rather than for the sake of <a href=\"/tdd-isnt-all-about-testing/\">design, maintenance, and problem solving</a>.</p>\n<p>When you write code, you should be thinking, “What problem am I trying to solve?”  Or better yet, “How can I state the problem in terms of a ‘When&#x2F;Then’ statement?”</p>\n<p>When you think about the problem this way, what you test becomes that When&#x2F;Then statement.  The class name for the test becomes When and the test becomes Then</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">WhenTheCodeIsInStateXAndIPerformActionYOnIt</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    [<span class=\"meta\">SetUp</span>]</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Setup</span>()</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Setup When</span></span><br><span class=\"line\">        <span class=\"comment\">// Perform Action</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    [<span class=\"meta\">Test</span>]</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ThenItShouldEndUpWithZState</span>()</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">         Assert.That(<span class=\"built_in\">object</span>, Is.InSpecificState());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>When you do this, the question no longer is about how much code you have to test, but instead becomes “Have I written a test for every reasonable condition this class may encounter?”</p>\n",
            "tags": [
                "tdd",
                "programming",
                "test driven development"
            ]
        },
        {
            "id": "http://davembush.github.com/tdd-isn%E2%80%99t-all-about-testing/",
            "url": "http://davembush.github.com/tdd-isn%E2%80%99t-all-about-testing/",
            "title": "TDD Isn’t All About Testing",
            "date_published": "2014-03-25T17:07:00.000Z",
            "content_html": "<p><img src=\"/uploads/2014/03/tran-land-045.jpg\" alt=\"tran-land-045\" title=\"tran-land-045\">While the artifact of Test Driven Development is test code, what you get out of test driven development far exceeds the test themselves. </p>\n<span id=\"more\"></span>\n\n<h2 id=\"Maintainable-Code\"><a href=\"#Maintainable-Code\" class=\"headerlink\" title=\"Maintainable Code\"></a>Maintainable Code</h2><p>By writing test first, you tend to write code that is more highly maintainable than if you just wrote the code to solve the problem.  By writing a class so that it can be used in both the system you are writing it for and so that it can be tested, you’ve been forced to think about the code in at least one other way from what you would have initially.  The result is your code tends to be more structured than it would have been otherwise.</p>\n<h2 id=\"Clear-Specifications\"><a href=\"#Clear-Specifications\" class=\"headerlink\" title=\"Clear Specifications\"></a>Clear Specifications</h2><p>By writing test first, you are forced to develop clearer specifications.  I’ve run into this recently on a project that I’m currently working on.  I can’t write a test for the code I’m about to implement because I don’t clearly understand how this is supposed to interact with the rest of the application.  Until I do, I really can’t move forward.  If I were not writing a test, this would not be as clear now as it is.  Although, one could argue that eventually it would become clear.  But it is more likely I would leave the feature out completely because I forgot about it entirely.  Something I’ve been known to do in the past.</p>\n<h2 id=\"Up-To-Date-Specifications\"><a href=\"#Up-To-Date-Specifications\" class=\"headerlink\" title=\"Up To Date Specifications\"></a>Up To Date Specifications</h2><p>This leads to another advantage to test driven development that <a href=\"/test-driven-specifications/\">I’ve mentioned before</a>.  By writing test in advance, you have the specification coded.  This forces you to keep the specification up to date if it changes because your test won’t run unless you do.  How many other programming methods are there that force the specifications to be kept up to date?  I can’t think of any.</p>\n<h2 id=\"A-Safety-Net-For-Refactoring\"><a href=\"#A-Safety-Net-For-Refactoring\" class=\"headerlink\" title=\"A Safety Net For Refactoring\"></a>A Safety Net For Refactoring</h2><p>If you’ve ever looked at bad code and thought, “I bet I could make this better.”  But then you were afraid to make any changes because you aren’t sure your improvement wouldn’t break something, you’ll really appreciate TDD.  If there is a good test suite for the code you want to refactor, you can be sure that any changes you make won’t break something it should do.  I’ve left a lot of code alone for fear of breaking something else.</p>\n<h2 id=\"Preventing-Feature-Creep\"><a href=\"#Preventing-Feature-Creep\" class=\"headerlink\" title=\"Preventing Feature Creep\"></a>Preventing Feature Creep</h2><p>Another thing TDD does is that it prevents feature creep on the part of developers.  Face it, how many times have you added a feature into the system that no one asked for?  By coding to the test, you reduce this urge.</p>\n<p>Many people start TDD by writing test after the fact and wonder how this can possibly be helpful.  This is because they’ve written them after they’ve written the code and they’ve completely bypass 80% of the benefits.</p>\n",
            "tags": [
                "tdd",
                "programming",
                "test driven development"
            ]
        },
        {
            "id": "http://davembush.github.com/when-you-really-need-all-of-your-nunit-test-in-one-class/",
            "url": "http://davembush.github.com/when-you-really-need-all-of-your-nunit-test-in-one-class/",
            "title": "When You Really Need All Of Your NUnit Test In One Class",
            "date_published": "2014-03-18T17:16:00.000Z",
            "content_html": "<p><img src=\"/uploads/2014/03/arct-034.jpg\"></p>\n<p>Last week <a href=\"/unit-test-structure/\">I proposed a structure for unit test that follows the pre-condition, action, post-condition workflow</a>.  Basically what you would see in a Use Case document.</p>\n<p>The result of this structure when applied to a general NUnit class is that we will end up with our pre-condition and action in our setup method and our post-condition asserts in our test methods.</p>\n<p>The problem with this is that sometimes this doesn’t always fit what we are trying to do.</p>\n<span id=\"more\"></span>\n\n<p>For example, I’ve been writing selenium test to test web applications I am working on.  Each page I am testing is essentially a form that computes a result at the bottom.  If I were a purest, I would put the page load object and the setup of the state of the page in the setup method.  One for each permutation.  And the assert to verify that it computed correctly.</p>\n<p>In this case, however, I vary slightly because what I really want is all of these similar test together where I can see them.</p>\n<p>But I still keep my code clean by using a TestCaseSource.</p>\n<p>What we are going to do is move just about everything into the TestCaseSource.  The code that is common between each TestCaseSource is going to still go in the SetUp method, but everything else will be declared in the TestCaseSource.</p>\n<p>The basics of how TestCaseSource works is that we setup a Property or a member variable that returns an IEnumerable.  By using the built in TestCaseData class we get a lot of control over what displays.  I’m not going to go over that here.  I’m sure you can <a href=\"//www.nunit.org/index.php?p=testCaseSource&r=2.6.3\">read the documentation</a> as well as I can.</p>\n<p>But what you may not realize when you first look that this documentation is that we can pass in functions and not just objects.  This gives us quite a bit of freedom in what we do here.</p>\n<p>So by setting up our Test method to look like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Test</span>]</span><br><span class=\"line\">[<span class=\"meta\">TestCaseSource(<span class=\"string\">&quot;DataSource&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Test</span>(<span class=\"params\">Action pre,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    List&lt;Action&gt; actions,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    Action assert</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    pre();</span><br><span class=\"line\">    <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> action <span class=\"keyword\">in</span> actions) &#123;</span><br><span class=\"line\">        action();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    assert();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>What we are doing is saying that we expect to find a property or member variable called “DataSource” that will pass us a function, a list of functions, and another function.</p>\n<p>The test body runs the first function to do any pre-condition work.  Then it loops through all of the function in the actions list to get the code to the state we need it to be in and then we finally call the assert to test our code.</p>\n<p>Here is a sample of what our DataSource property looks like:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> IEnumerable DataSource</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">get</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Action pre = () =&gt; Console.WriteLine(<span class=\"string\">&quot;given&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">var</span> actions = <span class=\"keyword\">new</span> List&lt;Action&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            () =&gt; Console.WriteLine(<span class=\"string\">&quot;when one&quot;</span>),</span><br><span class=\"line\">            () =&gt; Console.WriteLine(<span class=\"string\">&quot;when two&quot;</span>)</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        Action assert = () =&gt;</span><br><span class=\"line\">            Assert.That(<span class=\"number\">1</span>, Is.EqualTo(<span class=\"number\">1</span>));</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">yield</span> <span class=\"keyword\">return</span> <span class=\"keyword\">new</span></span></span><br><span class=\"line\"><span class=\"function\">            <span class=\"title\">TestCaseData</span>(<span class=\"params\">pre, actions, assert</span>)</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>I’ve broken out the lambda expressions individually so that you can better see what I’m doing.  But in real life, your code will probably look more like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> IEnumerable DataSource</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">get</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">yield</span> <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title\">TestCaseData</span>(<span class=\"params\"></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">            (Action</span>)(<span class=\"params\">(</span>)</span> =&gt; Console.WriteLine(<span class=\"string\">&quot;given&quot;</span>)),</span><br><span class=\"line\">            <span class=\"keyword\">new</span> List&lt;Action&gt;</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                () =&gt; Console.WriteLine(<span class=\"string\">&quot;when one&quot;</span>),</span><br><span class=\"line\">                () =&gt; Console.WriteLine(<span class=\"string\">&quot;when two&quot;</span>)</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            (Action)(() =&gt; Assert.That(<span class=\"number\">1</span>, Is.EqualTo(<span class=\"number\">1</span>)))</span><br><span class=\"line\">        );</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>You will need the (Action) cast to make the compiler understand what you are trying to do.  It isn’t smart enough to know that a lambda express is an Action which is a delegate that take no parameters and returns void.</p>\n<p>When you run the code, above, we get this output:</p>\n<p><img src=\"/uploads/2014/03/GivenWhenThenTest.png\" alt=\"GivenWhenThenTest\" title=\"GivenWhenThenTest\"></p>\n<p>By chaining on the SetName() call, you can make each iteration show up as it’s own unique test so you can see what is occuring in your test runner.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> IEnumerable DataSource</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">get</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">yield</span> <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title\">TestCaseData</span>(<span class=\"params\"></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">            (Action</span>)(<span class=\"params\">(</span>)</span> =&gt; Console.WriteLine(<span class=\"string\">&quot;given&quot;</span>)),</span><br><span class=\"line\">            <span class=\"keyword\">new</span> List&lt;Action&gt;</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                () =&gt; Console.WriteLine(<span class=\"string\">&quot;when one&quot;</span>),</span><br><span class=\"line\">                () =&gt; Console.WriteLine(<span class=\"string\">&quot;when two&quot;</span>)</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            (Action)(() =&gt; Assert.That(<span class=\"number\">1</span>, Is.EqualTo(<span class=\"number\">1</span>)))</span><br><span class=\"line\">        ).SetName(<span class=\"string\">&quot;First Test&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>And this looks like this in the test runner:</p>\n<p><img src=\"/uploads/2014/03/GivenWhenThen2.png\" alt=\"GivenWhenThen2\" title=\"GivenWhenThen2\"></p>\n<p>Once again, I have to reiterate, this is not something I would do a lot of, but it is a pretty neat trick when you need it. </p>\n",
            "tags": [
                "tdd",
                "test driven development",
                "nunit",
                "testcasedata",
                "testcasesource"
            ]
        },
        {
            "id": "http://davembush.github.com/unit-test-structure/",
            "url": "http://davembush.github.com/unit-test-structure/",
            "title": "Unit Test Structure",
            "date_published": "2014-03-11T08:38:00.000Z",
            "content_html": "<p><img src=\"/uploads/2014/03/UnitTestingScreen.png\" alt=\"UnitTestingScreen\" title=\"UnitTestingScreen\">One of the recurring reasons I hear from people for why they are not implementing unit test in their code is because it takes too long.  On one level I get that.  But, my experience tells me that the real problem is more likely that they just don’t understand enough about how to implement unit testing to be able to do it well.</p>\n<p>This is like knowing you are supposed to “eat right” and “exercise” but not having anyone tell you how to do either in such a way that you can maintain the habit.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Start-Small\"><a href=\"#Start-Small\" class=\"headerlink\" title=\"Start Small\"></a>Start Small</h2><p>So the first rule of unit testing structure, just like the first rule of diet and exercise, is to start small.</p>\n<p>When I first started to take a look at unit testing, the general advice was to create a unit test class for each class.  Then you were suppose to create a test method for each class.  I still see a lot of code as I travel that looks like this as I watch people try to implement the practice.</p>\n<p>But how frustrating.  And how is that suppose to work when I’m modifying existing code?</p>\n<h2 id=\"Here-is-how-I-write-unit-test…\"><a href=\"#Here-is-how-I-write-unit-test…\" class=\"headerlink\" title=\"Here is how I write unit test…\"></a>Here is how I write unit test…</h2><p>I’ve had exposure to UML and the most useful part of UML that I tend to use over and over again is the Use Case document.  I don’t care so much about the diagram.  But the document is really helpful.</p>\n<p>In the document we have three parts.</p>\n<ul>\n<li>Pre conditions</li>\n<li>Actions</li>\n<li>Post conditions</li>\n</ul>\n<p>If you start thinking about your test under this framework, I think you’ll find that writing test become much easier.</p>\n<p>You may be thinking, “But Dave, that’s application level testing, not unit testing.”  And my answer would be, “Yes, it is, but your class is a mini application so it can apply to it as well.</p>\n<h2 id=\"So-let’s-take-the-classic-Person-class-as-an-example\"><a href=\"#So-let’s-take-the-classic-Person-class-as-an-example\" class=\"headerlink\" title=\"So, let’s take the classic Person class as an example:\"></a>So, let’s take the classic Person class as an example:</h2><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Person</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Person</span>()</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"built_in\">string</span> FirstName &#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"built_in\">string</span> LastName &#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"built_in\">string</span> FullName</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">get</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> FirstName + <span class=\"string\">&quot; &quot;</span></span><br><span class=\"line\">                + LastName;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Our preconditions might be:</p>\n<ul>\n<li>The object has been created</li>\n<li>The FirstName has been set to a known value</li>\n</ul>\n<p>One of our actions is going to be:</p>\n<ul>\n<li>The LastName property is set to another known value</li>\n</ul>\n<p>The post condition will be:</p>\n<ul>\n<li>The FullName should end up being whatever we had in the first name plus a space plus whatever we added to the last name</li>\n</ul>\n<p>So now that we have a use case for our class, how do we model this in our unit test?</p>\n<h2 id=\"Converting-the-Use-Case-to-a-Test-Case\"><a href=\"#Converting-the-Use-Case-to-a-Test-Case\" class=\"headerlink\" title=\"Converting the Use Case to a Test Case\"></a>Converting the Use Case to a Test Case</h2><p>Using NUnit since it is still the most popular, our resulting code might look something like:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">GivenAnObjectOfTypePersonWithFirstNameSetToBob</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">class</span> <span class=\"title\">WhenISetTheLastNameToJones</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> Person _person;</span><br><span class=\"line\"></span><br><span class=\"line\">        [<span class=\"meta\">SetUp</span>]</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Setup</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// The precondition</span></span><br><span class=\"line\">            _person = <span class=\"keyword\">new</span> Person</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                FirstName = <span class=\"string\">&quot;Bob&quot;</span>;</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// The action</span></span><br><span class=\"line\">            _person.LastName = <span class=\"string\">&quot;Jones&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        [<span class=\"meta\">Test</span>]</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TheFullNameShouldBeBobJones</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Assert.That(_person.FullName,</span><br><span class=\"line\">                Is.EqualTo(<span class=\"string\">&quot;Bob Jones&quot;</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Notice how I created a namespace for the given.  This makes the code readable in our test runner.  I put the precondition and the action in the SetUp method because I want to start fresh with each test.  In this case, I only have one test, but in most scenarios, you will have multiple test.  You should plan for multiple test.</p>\n<p>In this particular case, I only have one post condition.  But if I had multiple post conditions, each one would be it’s own Test method with it’s own Assert.</p>\n<p>One of the biggest issues I see is people putting multiple asserts inside of one Test method.    You don’t want to do this.  You want one and only one Assert per Test method.  Otherwise, you never know by looking at your test what exactly failed or if the code were to run, that any of the other Asserts fail.</p>\n<p>Because we named our namespace, class, and test methods what we are testing, when a test fails, our test runner will display the names for us.</p>\n<p>If you think it makes the code more readable, you can use underscores to separate the names.  The goal is to make the code read something like your use case.</p>\n<p>One final note before we end.  Your namespace should match up to the directory the class file is in and the class name should match the file name.  This will make the code easy to find.  This is something I shouldn’t have to mention, but once again, I’ve seen people ignore the simplest of organizational strategies.</p>\n<p>This is just one of several patterns I use for testing my code.  What I like about this particular pattern is that it forces my test code to follow the Single responsibility principle.  In the case above, this test class is only responsible for testing what happens when I set the LastName property when I’ve already set the FirstName property.  I can write another class to test what happens when the FirstName property has not yet been set and yet another for what happens when I set the LastName property first and then set the FirstName property.</p>\n",
            "tags": [
                "tdd",
                "unit test",
                "test driven development"
            ]
        },
        {
            "id": "http://davembush.github.com/%E2%80%9Cdebbie-done%E2%80%9D/",
            "url": "http://davembush.github.com/%E2%80%9Cdebbie-done%E2%80%9D/",
            "title": "“Debbie-Done”",
            "date_published": "2014-03-04T10:38:00.000Z",
            "content_html": "<p><img src=\"/uploads/2014/02/88Tr.png\" alt=\"88Tr\" title=\"88Tr\"></p>\n<p>A long long time ago, in what seems now like another world, I worked for a company as a <a href=\"//en.wikipedia.org/wiki/Clipper_(programming_language)\">Clipper programmer</a>.  While I was there I heard this story about a lady named Debbie.</p>\n<p>I was told that Debbie was a programmer who used to work for this company.  Debbie was a lazy programmer.  She worked harder at avoiding work than if she just did the job she was supposed to do.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"The-ultimate-lazy-programmer\"><a href=\"#The-ultimate-lazy-programmer\" class=\"headerlink\" title=\"The ultimate lazy programmer\"></a>The ultimate lazy programmer</h2><p>For example.  Once my boss had stopped by her desk to see how she was progressing on a report she was supposed to be writing:</p>\n<p>Debbie: Oh, that’s done.  Here.  Take a look.</p>\n<p>The boss looked it over and found an error.  Some of the numbers didn’t match up.</p>\n<p>Debbie: Oh, I know what that is.  I can get that fixed right away.</p>\n<p>Which she did.  At least that’s what she made everyone believe.</p>\n<p>After she left (shortly after this) they found out that she hadn’t even connected to a database to create that report.  The whole report was hard coded.  Every time you ran it, it gave you the same numbers.</p>\n<h2 id=\"“Debbie-Done”\"><a href=\"#“Debbie-Done”\" class=\"headerlink\" title=\"“Debbie-Done”\"></a>“Debbie-Done”</h2><p>The one thing I was told that sticks in my mind the most is that Debbie considered a project “done” if it compiled in linked.  She almost never ran the code.  Or if she did, she certainly didn’t run enough of it, or run it more than to make sure it didn’t crash.  Anyhow, the perception she left is that she only compiled and linked the code.  Today, we’d say all she did was build the project or solution.</p>\n<p>But recently, I’ve discovered that many programmers work at the “Debbie-Done” level more than we’d like to admit.</p>\n<p>I’ve always thought that programmers wrote code like I do:</p>\n<ul>\n<li>Write a bit of code. </li>\n<li>Build the code.</li>\n<li>Run the code to see if that change works as expected. </li>\n<li>Write a bit more code. </li>\n<li>Build the code.</li>\n<li>Run the code to see if that change works as expected. </li>\n<li>Rinse, lather, repeat.</li>\n</ul>\n<p>But what I’m discovering is that MANY programmers do not program that way at all.  No, many of them look like some version of “Debbie-Done” programming:</p>\n<ul>\n<li>Write some code. </li>\n<li>Build the project to make sure it will build</li>\n<li>Write some more code</li>\n<li>Build the project</li>\n<li>Rinse, lather, repeat</li>\n<li>Run the code and “test” all of the changes at once.</li>\n</ul>\n<p>The problem with this method is that no one can remember all of the changes they make so, in the end, the code I write tends to be more completely tested than the code that was tested in bulk.  The only difference between this method of development and “Debbie-Done” is the degree of completeness with which each developer is able “test” their code.</p>\n<h2 id=\"Avoid-“Debbie-Done”-with-Test-First-Development\"><a href=\"#Avoid-“Debbie-Done”-with-Test-First-Development\" class=\"headerlink\" title=\"Avoid “Debbie-Done” with Test First Development\"></a>Avoid “Debbie-Done” with Test First Development</h2><p>It is no wonder that many programmers I talk to think that test driven development takes too much time.  Compared to how they are programming, it does.</p>\n<p>But think about this.  If you were to code like I do, suddenly writing test for every change you make suddenly makes sense because instead of you running the application and getting to the place that will trigger your code and observing if it will work or not, you can write a test for just the piece of code you are working on and run that each time you want to verify if it is working or not.  Yes, initially, this will take more time.  But over the life of the program, and I would say even over the time span that it takes to initially write the code, writing at least the Unit Test as you are writing the features will actually save you time.  Not only that, you will end up with test you can repeat every time the code is changed.</p>\n<p>Even my method of “code, build, test, code, build, test” is “Debbie-Done” compared to writing test for each change as you make the change.</p>\n",
            "tags": [
                "tdd",
                "programming",
                "agile",
                "testing"
            ]
        },
        {
            "id": "http://davembush.github.com/test-driven-specifications/",
            "url": "http://davembush.github.com/test-driven-specifications/",
            "title": "Test Driven Specifications",
            "date_published": "2014-02-25T08:44:00.000Z",
            "content_html": "<p><img src=\"/uploads/2014/02/spider.jpg\" alt=\"spider\" title=\"spider\">Several years ago, long before the community was actively talking about Test Driven Development, I worked for a short time at a company as a “bug fixer.”  That was my role.  They had hired me because they had some software that was “basically done” but “had some issues.”  It should only take a few weeks.</p>\n<p>The first thing they needed me to fix was that the website was supposed to send out email.  It turns out it was a configuration problem.  But they were so impressed (“the last guy we had in here spent two weeks on that problem and still hadn’t solved the problem.”) that they gave me more and more bugs.</p>\n<h2 id=\"This-Is-The-Job-That-Never-Ends\"><a href=\"#This-Is-The-Job-That-Never-Ends\" class=\"headerlink\" title=\"This Is The Job That Never Ends\"></a>This Is The Job That Never Ends</h2><span id=\"more\"></span>\n\n<p>The gig that was supposed to be a couple of weeks long was quickly turning into a perpetual job.  Soon I learned that what I was working with was a system that had a lot of bugs, but no one was willing to admit that.  Eventually, frustrated by the fact that this system seemed to have a new bug every day, I asked for the specs so that I could create a test plan.  That’s when I found out the worse news of all about this system.</p>\n<h2 id=\"Lost-Specifications\"><a href=\"#Lost-Specifications\" class=\"headerlink\" title=\"Lost Specifications\"></a>Lost Specifications</h2><p>They had lost the specs.  Not only had they lost the specs, but they were unwilling to admit this to the client and instead they were relying on the process of fixing the bugs to eventually squash all  the bugs so they could end up with a stable system.</p>\n<p>Since I was not yet familiar with the concepts of unit testing or Test Driven Development, I accepted this as the best we could do.  Hey!  At least I was getting paid well.</p>\n<p>Oh, but the story gets worse.</p>\n<h2 id=\"The-Plot-Thickens\"><a href=\"#The-Plot-Thickens\" class=\"headerlink\" title=\"The Plot Thickens\"></a>The Plot Thickens</h2><p>About three months into this gig, the manager of my project went on vacation which left the project in HIS manager’s hands.  That’s when the poop hit the fan.</p>\n<p>The Oracle consultant that was working with me and I were called into the office.</p>\n<p>“Why does this system still have bugs?!!”  Oh, he was angry.  That should be all bold and all caps and all underlined.</p>\n<p>Well sir, several weeks ago I asked for the requirements document so that I could write a test plan and I was told the requirements were lost.  If we can’t write a test plan, we never will be able to ensure that the system is working the way that it should.</p>\n<p>“I want you to write a test plan.”</p>\n<p>To which I repeated my need for a requirements document.</p>\n<p>We went back and forth with him insisting that I write a test plan and me stating that it could not be done until I finally said, “I think I’ve done all I can do here.”  Walked out of the office, packed up my stuff, went home, and immediately called my recruiter to make sure he got MY version of what happened first.</p>\n<p>But, it didn’t have to end like that.</p>\n<h2 id=\"A-Better-Way\"><a href=\"#A-Better-Way\" class=\"headerlink\" title=\"A Better Way\"></a>A Better Way</h2><p>Had I known about test driven development, every time a new bug came in, I could have written a new test, even if it was only unit test and not acceptance test, every time a new bug came in.  Eventually, I would have created not only the test plan, but I would have created the specification, or at least the parts that tended to break, and we would have ended up with a stable system like they thought they were going to get.</p>\n",
            "tags": [
                "tdd",
                "agile",
                "test driven development",
                "testing"
            ]
        }
    ]
}