{
    "version": "https://jsonfeed.org/version/1",
    "title": "Dave's Notebook • All posts by \"flux\" tag",
    "description": null,
    "home_page_url": "http://davembush.github.com",
    "items": [
        {
            "id": "http://davembush.github.com/an-explanation-of-the-flux-pattern/",
            "url": "http://davembush.github.com/an-explanation-of-the-flux-pattern/",
            "title": "An Explanation of the Flux Pattern",
            "date_published": "2016-03-31T11:28:00.000Z",
            "content_html": "<p>Over the last couple of weeks, I’ve mentioned that I’ve been learning React JS.  First in the article “<a href=\"/react-js-and-associated-bits/\">Reaction to React JS and Associated Bits</a>” and then last week in my article “<a href=\"/test-driven-learning-an-experiment/\">Test Driven Learning</a>”. </p>\n<p>In the first article, I mentioned that if you use React JS, you’ll probably end up using the Flux design pattern and since there are multiple ways of implementing flux, getting a clear definition of what it is and how it should work can be confusing.  At least, I found it confusing.</p>\n<p>And now that I’ve figured it out, I thought it might be helpful both to myself and to the programming community at large if I offered my own Explanation of the Flux Pattern.  At the very least, it will give me one more way of solidifying the concept in my own brain.  Maybe it will be helpful to you as well.</p>\n<figure>![](/uploads/2016/03/image-5.png \"Flux\")<figcaption>Photo credit: [jeffreagan](//www.flickr.com/photos/jeffreagan/22033828931/) via [VisualHunt.com](//visualhunt.com) / [CC BY](//creativecommons.org/licenses/by/2.0/)</figcaption></figure>\n\n<span id=\"more\"></span>\n\n<h2 id=\"Flux-“One-Way-Data-Binding”\"><a href=\"#Flux-“One-Way-Data-Binding”\" class=\"headerlink\" title=\"Flux “One Way Data Binding”\"></a>Flux “One Way Data Binding”</h2><p>One of the first concepts you’ll hear when you start to learn Flux is that Flux implements “One Way Data Binding.”  This is unfortunate because if you start implementing Flux thinking it is any kind of data binding, you are already headed in the wrong direction.  Data binding holds with it this concept that things will happen automatically and declaratively.  Neither is true in the Flux world.  In fact, the reason Flux exist at all is because, in the Flux world, control over what happens when is the reason for its existence.  So, forget data binding.  Flux is “One Way Data Flow”.</p>\n<h2 id=\"Pub-x2F-Sub\"><a href=\"#Pub-x2F-Sub\" class=\"headerlink\" title=\"Pub&#x2F;Sub\"></a>Pub&#x2F;Sub</h2><p>Flux is heavily reliant on the pub&#x2F;sub model.  Pub&#x2F;sub is short for Publish&#x2F;Subscribe.  This comes from the real world.  You subscribe to a newspaper, or magazine, or… whatever.  Every time the thing you subscribe to is published, you get it.</p>\n<p>It is no different in Flux.  An object will subscribe to another object.  Anytime the second object does something worth publishing, the first object gets notified. </p>\n<p>The beauty of implementing a system in this way is that the publisher doesn’t need to know anything about the subscribers.  If there is a subscriber, the subscriber gets notified.  If there is no subscriber, nothing happens.  The subscriber does need to know something about the publisher so that he can say he wants to know when something is happening.  While you might thing this would create a tight coupling between the two, it doesn’t have to.</p>\n<h2 id=\"Singletons\"><a href=\"#Singletons\" class=\"headerlink\" title=\"Singletons\"></a>Singletons</h2><p>There is a pattern in object oriented programming called “Singletons.”  Just like the name implies, this means there is only one object of that type in the system.  Some people consider Singletons evil.  But the benefit, especially in the Flux world, is that finding an instance of the object is easy.  You just ask for it.</p>\n<h2 id=\"Flux-Dispatcher\"><a href=\"#Flux-Dispatcher\" class=\"headerlink\" title=\"Flux Dispatcher\"></a>Flux Dispatcher</h2><p>The Dispatcher is the central Flux object.  If you are using the Flux implementation from Facebook, your Dispatcher object will extend the Dispatcher class.  There really isn’t much too it, and you may be able to get away with just using the Dispatcher class directly.  But I create a new derived object so I can extend it if I need to.</p>\n<p>Everything in the system that needs to know when something interesting happens in the view layer of your code, subscribes to the dispatcher.  And anytime something happens in the view layer that other objects in your system might want to know about, the dispatcher is called with a message telling it what action we are looking to perform.</p>\n<p>So, in the demo app I am building, when the main view loads, the componentWillMount() method in my view sends the dispatcher a message telling it that it is looking for a list to display.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">componentWillMount</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"title class_\">AppDispatch</span>.<span class=\"title function_\">dispatch</span>(&#123;<span class=\"attr\">actionType</span>:<span class=\"title class_\">ActionTypes</span>.<span class=\"property\">CRUD_LIST</span>&#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>  On the other end of this request, I have a store that has registered with the dispatcher.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title class_\">AppDispatcher</span>.<span class=\"title function_\">register</span>(<span class=\"function\">(<span class=\"params\">action</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">switch</span>(action.<span class=\"property\">actionType</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"title class_\">ActionTypes</span>.<span class=\"property\">CRUD_LIST</span>:</span><br><span class=\"line\">            store.<span class=\"title function_\">list</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>You’ll notice that I am using “enumerations” to keep the code clean.  The reality is the ActionTypes are just strings.</p>\n<h2 id=\"Flux-EventEmitter\"><a href=\"#Flux-EventEmitter\" class=\"headerlink\" title=\"Flux EventEmitter\"></a>Flux EventEmitter</h2><p>We have notifications flowing down to our store to tell it we need some information or want it to do something, like save the data.  But once that is complete, how do we let the view know that the information it needs to display has changed? Well, it is actually very similar.  The view tells the store, “Hey, any time you do something interesting with the data, let me know.</p>\n<p>So, once again we setup a Pub&#x2F;Sub relationship.  This time, the store is the publisher and the view is the listener.  So, in our view, we’ll setup the listener by adding it to our componentWillMount() method</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">componentWillMount</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"title class_\">CrudStore</span>.<span class=\"title function_\">addChangeListener</span>(self.<span class=\"property\">onChange</span>);</span><br><span class=\"line\">    <span class=\"title class_\">AppDispatc</span></span><br><span class=\"line\">    <span class=\"string\">``</span><span class=\"string\">`h.dispatch(&#123;actionType:ActionTypes.CRUD_LIST&#125;);</span></span><br><span class=\"line\"><span class=\"string\">&#125;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">And in our store, our list() method (in this case) will send the message.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">`</span><span class=\"string\">``</span> javascript</span><br><span class=\"line\"><span class=\"title function_\">list</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    superAgent.<span class=\"title function_\">get</span>(<span class=\"string\">&#x27;/api/contact&#x27;</span>).<span class=\"title function_\">end</span>(<span class=\"function\">(<span class=\"params\">error,response</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!error)&#123;</span><br><span class=\"line\">            response.<span class=\"property\">body</span>.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">item</span>) =&gt;</span> &#123;</span><br><span class=\"line\">                item.<span class=\"property\">id</span> = item.<span class=\"property\">_id</span>;</span><br><span class=\"line\">                item.<span class=\"property\">dob</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(item.<span class=\"property\">dob</span>);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">emitChange</span>(<span class=\"title class_\">ActionTypes</span>.<span class=\"property\">CRUD_LIST</span>,response);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>I’m using superAgent here to make an ajax call that will get me the list.  When it returns, I call emitChange which will eventually call the callback I passed in from the view to tell the view that something changed.</p>\n<h2 id=\"Push-vs-Pull\"><a href=\"#Push-vs-Pull\" class=\"headerlink\" title=\"Push vs Pull\"></a>Push vs Pull</h2><p>Now, there seems to be two minds about how this all should work.  Do you just notify the view that something happened and let the view go get the data it needs?  Or do you pass the data the view will need along with the notification? It would seem to me that while either one will work, if we think of Flux as “One Way” data flow, or even One Way data binding, it makes a lot more sense to push the data around.  And so, what you’ll see me do in the callbacks that live in my view code, is that they will receive the data and push it into the view state.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">onChange</span>(<span class=\"params\">type,data</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(type === <span class=\"title class_\">ActionTypes</span>.<span class=\"property\">CRUD_LIST</span>)&#123;</span><br><span class=\"line\">        self.<span class=\"title function_\">setState</span>(&#123;<span class=\"attr\">data</span>: data.<span class=\"property\">body</span>&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Visually\"><a href=\"#Visually\" class=\"headerlink\" title=\"Visually\"></a>Visually</h2><p><img src=\"/uploads/2016/03/image-6.png\" alt=\"image\" title=\"image\"> The arrows represent the direction of data flow.  You can assume that if the data is flowing to something, there was a corresponding listener setup.</p>\n<p>The top windows represent the view.  The cog represents the dispatcher (you can see that it sends the notification to everything) and the disks represent the data stores.  You should note that the dispatcher notifies all of the stores because there is only one dispatcher to listen to.  Finally, since not all of the views care about all of the stores, I send notifications to particular views that care.</p>\n<p>There may be cases where you would have something at the store level that isn’t, technically, a store.  That’s OK.  But I think 99% of the time, you’ll end up having stores be thing thing that the dispatchers send information to.</p>\n<h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion\"></a>Conclusion</h2><p>I have not given a lot of implementation details here because what I wanted to convey was the overarching concept behind Flux.  Once I’ve finished my reference app for this, I may go into more detail at the implementation level.  Don’t forget to sign up for the newsletter so you don’t miss anything.</p>\n",
            "tags": [
                "javascript",
                "react.js",
                "flux"
            ]
        },
        {
            "id": "http://davembush.github.com/reactions-to-react-js-and-associated-bits/",
            "url": "http://davembush.github.com/reactions-to-react-js-and-associated-bits/",
            "title": "Reactions to React JS and Associated Bits",
            "date_published": "2016-03-17T12:30:00.000Z",
            "content_html": "<p>I’ve been learning React JS over the last several weeks.  Currently, I now know 4 of the major JavaScript frameworks: Angular 1, Angular 2, EXTjs (4.2 – 6.0.1), and now React JS.  To be clear, I also know Knockout and JQuery.  But I don’t consider these frameworks so much as libraries.  They’ve helped me understand the principles used in the frameworks, but they are not frameworks.  What follows is a summary of what I consider React’s strengths and weaknesses.</p>\n<p><img src=\"/uploads/2016/03/image-3.png\" alt=\"React JS\" title=\"React JS\"> Photo credit: <a href=\"//www.flickr.com/photos/steffen-fam-pics/5472880836/\">kristin osier</a> via <a href=\"//visualhunt.com\">VisualHunt</a> &#x2F; <a href=\"//creativecommons.org/licenses/by/2.0/\">CC BY</a></p>\n<span id=\"more\"></span>\n\n<h2 id=\"What-is-React-JS\"><a href=\"#What-is-React-JS\" class=\"headerlink\" title=\"What is React JS?\"></a>What is React JS?</h2><p>To be fair, React JS is one of those frameworks that borders on being considered a library.  This is because React itself is only concerned with the presentation layer of your JavaScript code.  However, as I learned over the last several weeks, if you are going to use React JS properly, you’ll also end up using some kind of Flux pattern.  You’ll also need some way of making AJAX calls.  And while each of these are separate decisions you’ll need to make about which library you want to use for these parts of the stack, they are all part of the React coding philosophy.  So React, the philosophy, is more like a framework. React JS, the library, is more concerned with presentation.  And what most people will tell you about React JS is that any DOM changes it makes are all made to a Virtual DOM instead of writing directly to the DOM.  By doing this, screen updates can be bundled into one change and are only made when they are needed.  This is in contrast to most other libraries that allow you to write to the screen directly. As I’ve written before, <a href=\"/javascript-performance-tweaks/\">the fewer times you can update your DOM from your JavaScript, the better performance you will see</a>.</p>\n<h2 id=\"React-JS-Pros\"><a href=\"#React-JS-Pros\" class=\"headerlink\" title=\"React JS Pros\"></a>React JS Pros</h2><p>So the first main benefit to using React JS is that you gain better performance because you aren’t writing directly to the DOM when you make a change to the presentation layer.</p>\n<p>But, that isn’t what I would consider the best benefit of using React JS.</p>\n<h3 id=\"Turtles-All-The-Way-Down\"><a href=\"#Turtles-All-The-Way-Down\" class=\"headerlink\" title=\"Turtles All The Way Down *\"></a>Turtles All The Way Down <a href=\"//en.wikipedia.org/wiki/Turtles_all_the_way_down\">*</a></h3><p>You see, the reason that React JS can avoid writing to the screen directly is because it puts all of the presentation code in JavaScript using a syntax called ‘JSX’.  Now, as several places I was learning React JS from pointed out, this isn’t as ‘wrong’ as it sounds.</p>\n<p>In Angular, for example, we are accustom to putting JavaScript in our HTML.  Here, we are putting HTML in our JavaScript.  In both cases, the View layer is separate from our business logic or data access (or should be) so we have not violated the Single Responsibility Principle in any way using either approach.</p>\n<p>However, have you tried to unit test code you’ve placed in your HTML?  It is not easy, although I think I have a way that might make that easier now that I’ve done some work with React JS.  But, because everything is JavaScript, it is very easy to mock out a child component and actually Unit Test the presentation layer one component at a time.  In fact, if you concentrate on testing as you go, you will be forced to create very small components that you then compose into your pages.</p>\n<p>In fact, it is the testing story that makes React JS my preferred framework right now.</p>\n<h3 id=\"Testing\"><a href=\"#Testing\" class=\"headerlink\" title=\"Testing\"></a>Testing</h3><p>And while we are on the subject of testing, you might wonder how you test presentation layer stuff.</p>\n<p>The React JS guys have created a test framework based on Jasmine called Jest.  The extensions in Jest let you render a component into a “fake DOM” using JSDom.  From there you can test to make sure the HTML you were expecting got rendered correctly and fire events and test to make sure that what you expected would happen actually happened.</p>\n<p>What it doesn’t do is let you know that the component rendered in the way that you were expecting.  There are other, higher level tools, that are already available to do that.</p>\n<h3 id=\"Super-Loose-Coupling\"><a href=\"#Super-Loose-Coupling\" class=\"headerlink\" title=\"Super Loose Coupling\"></a>Super Loose Coupling</h3><p>The React JS community refers to this feature as “One Way Databinding” and of all the concepts I had to figure out while I was learning how to program using React JS, this was probably the hardest to get my head around.</p>\n<p>When you first hear, “One Way Databinding” you immediately start thinking, “How does that even work?  Eventually data has to get from the view down to the database and from the database back up to the view.  That’s two ways.”  But what they actually mean by “Two Way Databinding” would better be described as “Event Based Data Flow” or at least “Circular Data Flow” In very simple terms, the View fires an event to a “Dispatcher” which is a singleton.  Each repository, or data store, or model (just depends on what you want to call it) registers a listener with the “Dispatcher” that lets the dispatcher know that it wants to know whenever something significant happens.  These repositories are also singletons.  When the Dispatcher receives a notification from a View, it notifies all of the listeners in turn.  The listeners look at the message they receive from the dispatcher to see if it is something they care about.  If it is, they process the message accordingly.  Once they are done, they fire an event to each ControllerView that has registered a listener with them.  The ControllerView then updates the view based on the information it was passed in the event.</p>\n<p>I don’t want this to get too far down the road of “How” but to make the above paragraph just a bit clearer.  There is a top level View item that does no rendering.  It is only responsible for responding to event notifications and passing the data down into the child views.  You may hear this referred to as a ViewController, but it is more accurately a ControllerView.</p>\n<p>Because everything is basically an event (yeah, I know, not really an event in the strictest sense of the word) we can test each layer independent of the other.</p>\n<h3 id=\"More-Control\"><a href=\"#More-Control\" class=\"headerlink\" title=\"More Control\"></a>More Control</h3><p>The final major advantage that I can see with using the React coding philosophy is that you have a lot more control over when things happen.  No longer are you at the mercy of how and when the framework you are using decides to update values.  If you need to update a value or update the screen, you can do that when you want to, as you want to.</p>\n<p>And, because the only framework you are locked into when you are using React is the React JS framework, if you want to use some other implementation of Flux or AJAX, you can use whatever works for your situation.</p>\n<h2 id=\"React-JS-Cons\"><a href=\"#React-JS-Cons\" class=\"headerlink\" title=\"React JS Cons\"></a>React JS Cons</h2><p>With all of what I like about React, there are some things that almost made me give up.</p>\n<h3 id=\"Documentation\"><a href=\"#Documentation\" class=\"headerlink\" title=\"Documentation\"></a>Documentation</h3><p>The week prior to learning React, I learned Angular 2.  I got spoiled.  I have to say, the Angular world seems to have MUCH better documentation.  Maybe this is because they’ve kept things relatively the same between major releases.  So you know, “this documentation belongs to this version.”  As I was learning React, I was never sure if what I was reading or what I was learning was currently the way things worked today.  Even on the main site, the documentation doesn’t seem to be up to date.  I’m pretty sure I could have learned a lot faster if I hadn’t tried to write Unit test at the same time.  Jest is where the documentation seems to be the weakest.  But I had challenged myself to approach learning React in a way different from what I normally do.</p>\n<p>You see, normally, I use the excuse that “I don’t know the framework yet.” as a reason why I shouldn’t write Unit Tests as I go.  But this time, I decided that writing Unit Tests would be part of the learning.  So, before I could write my first view, I needed to be able to write my first test.  And that is when I realized this was going to take a little longer than I was used to.</p>\n<h3 id=\"Not-Highly-Opinionated\"><a href=\"#Not-Highly-Opinionated\" class=\"headerlink\" title=\"Not Highly Opinionated\"></a>Not Highly Opinionated</h3><p>OK, this one could go both ways.  Not being opinionated might be considered a good thing, and I addressed that above.  But, not having one right way to do something is going to be an issue for most large organizations.  In some organizations even Angular, which I would consider pretty opinionated, isn’t opinionated enough.</p>\n<p>But, because React isn’t opinionated, and there is no clear direction in the documentation on how to DO Flux, you can end up getting multiple opinions on how to code Flux as you learn from multiple people.  Which can be confusing.</p>\n<p>If you decide to go with React, just realize that you’ll need someone on your team who REALLY understands React and can make these decisions for your organization.  In my view, at the corporate level (vs the individual level) someone has to impose architecture OR you need to use a tool that has already imposed it.</p>\n<h3 id=\"Do-You-Know-React\"><a href=\"#Do-You-Know-React\" class=\"headerlink\" title=\"Do You Know React?\"></a>Do You Know React?</h3><p>Similar to the opinionated issue but different enough that we should break it out.</p>\n<p>If I put React on my resume.  What does that mean?  What will the hiring manager expect?  He’s been told that the application uses React.  So, he’s looking for a React guy.  But that isn’t all this guy is going to know.  And frankly, React is the easy part to learn.  Is he looking for a guy who knows the React philosophy?  What exactly is the React philosophy? For example, as I was learning, one of the guys was proposing that the store would notify the view that the data had changed, at which point the view would pull from the store.  But, why not just send the data to the view as part of the notification?  Wouldn’t that more loosely couple the architecture?  Both ways are using a React philosophy.  But, I would hope, that only one way is the way that is implemented at any one organization.</p>\n<h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion\"></a>Conclusion</h2><p>Unfortunately, it will be a while before I can actually use React on a real project.  But knowing React, especially the testing end of it, has already influenced the project I am currently working on.  I need a few more weeks yet to make sure there aren’t any snags in how I am doing things, but you can bet the influence will show up in future post.</p>\n",
            "tags": [
                "javascript",
                "react.js",
                "flux"
            ]
        }
    ]
}