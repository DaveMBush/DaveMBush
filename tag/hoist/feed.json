{
    "version": "https://jsonfeed.org/version/1",
    "title": "Dave's Notebook • All posts by \"hoist\" tag",
    "description": null,
    "home_page_url": "http://davembush.github.com",
    "items": [
        {
            "id": "http://davembush.github.com/javascript-scope/",
            "url": "http://davembush.github.com/javascript-scope/",
            "title": "JavaScript Scope",
            "date_published": "2015-06-18T10:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/06/ppl-men-060.jpg\" alt=\"ppl-men-060\" title=\"ppl-men-060\"></p>\n<p>If you’ve been programming in any other environment than JavaScript for a while, you may be making assumptions about JavaScript Scope that just aren’t true.  One of those assumptions is how variables get evaluated when you run the JavaScript code and what variables are visible and at what point in the code they are visible.</p>\n<p>Just as a test to see how well you know your JavaScript, let’s create a few tests scenarios.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Quiz\"><a href=\"#Quiz\" class=\"headerlink\" title=\"Quiz\"></a>Quiz</h2><h3 id=\"1-Given-the-following-code\"><a href=\"#1-Given-the-following-code\" class=\"headerlink\" title=\"1) Given the following code:\"></a>1) Given the following code:</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> foo;</span><br><span class=\"line\">foo = <span class=\"string\">&quot;xyz&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">bar</span>(<span class=\"params\"></span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    foo = <span class=\"string\">&quot;abc&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> foo;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">bar</span>();</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(foo);</span><br></pre></td></tr></table></figure>\n\n<p>What is displayed in the console window when console.log(foo) is executed?</p>\n<p>Why?</p>\n<h3 id=\"2-Given-the-following-code\"><a href=\"#2-Given-the-following-code\" class=\"headerlink\" title=\"2) Given the following code:\"></a>2) Given the following code:</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> i = <span class=\"number\">20</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>;i &lt; <span class=\"number\">10</span>;i++)&#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(i);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;final i: &#x27;</span> + i);</span><br></pre></td></tr></table></figure>\n\n<p>What is the value of i when <code>console.log(‘final i: ‘ + i)</code> is executed?</p>\n<p>Why?</p>\n<h3 id=\"3-What-is-wrong-with-the-following-code\"><a href=\"#3-What-is-wrong-with-the-following-code\" class=\"headerlink\" title=\"3) What is wrong with the following code?\"></a>3) What is wrong with the following code?</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">foo</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> foo = <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;foo was called&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-Why-would-changing-the-previous-code-to-this-next-block-of-code-fix-the-issue-with-the-previous-code\"><a href=\"#4-Why-would-changing-the-previous-code-to-this-next-block-of-code-fix-the-issue-with-the-previous-code\" class=\"headerlink\" title=\"4) Why would changing the previous code to this next block of code fix the issue with the previous code?\"></a>4) Why would changing the previous code to this next block of code fix the issue with the previous code?</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">foo</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">foo</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;foo was called&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Answers\"><a href=\"#Answers\" class=\"headerlink\" title=\"Answers\"></a>Answers</h2><ol>\n<li><p>The value of foo when console.log(foo) is executed is “xyz”</p>\n</li>\n<li><p>The value of i when console.log(‘final i: ‘ + i) is executed is 10</p>\n</li>\n<li><p>foo is declared but undefined when we try to call it on the first line</p>\n</li>\n<li><p>because foo is both declared and defined when it is called on the first line</p>\n</li>\n</ol>\n<h2 id=\"Why\"><a href=\"#Why\" class=\"headerlink\" title=\"Why?\"></a>Why?</h2><p>How did you do?</p>\n<ol>\n<li>“Hoisting”</li>\n</ol>\n<hr>\n<p>The first thing you need to understand about how JavaScript processes code is that it goes through the block of code you are working with and processes the variable declarations first.  That is anything in the global scope (window for browsers, global for server) or anything within a function block.  From the JavaScript compiler’s perspective, the code in example 1 looks like this:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> foo;</span><br><span class=\"line\">foo = <span class=\"string\">&quot;xyz&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">bar</span>(<span class=\"params\"></span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> foo;</span><br><span class=\"line\">    foo = <span class=\"string\">&quot;abc&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">bar</span>();</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(foo);</span><br></pre></td></tr></table></figure>\n\n<p>So that the foo &#x3D; “abc” line assigns the string “abc” to the variable foo in the bar function’s local scope.  Not impacting the variable foo in global scope so that the result at the end of the code sample is that the foo variable still has the value “xyz”.</p>\n<ol start=\"2\">\n<li>Only functions and catch blocks create “block scope”</li>\n</ol>\n<hr>\n<p>In most languages that I use, if I wanted to create a variable that only had effect within a for, if, or while block, I could create a variable within the braces, or inline like in this example, and the code in the outer block would be left untouched.  But in JavaScript, this would only work if you were using the LET keyword which only appears in ECMA6 and above.</p>\n<p>In JavaScript, it is perfectly legal to declare a variable multiple time.  The compiler will not complain.  So, when we run the code in example 2, the declaration within the for() is ignored and it just reuses the declaration at the beginning of the code snippet.</p>\n<p>If you really wanted to declare a function within its own scope, you could create the scope with a try&#x2F;catch block, like this:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span> &#123;<span class=\"keyword\">throw</span> i;&#125;</span><br><span class=\"line\"><span class=\"keyword\">catch</span>(i)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>;i&lt; <span class=\"number\">10</span>;i++) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;final i: &#x27;</span> + i);</span><br></pre></td></tr></table></figure>\n\n<p>Which would give you the behavior you were probably expecting.  The code above will print out ‘final i: 20’ like you were probably expecting above.</p>\n<ol start=\"3\">\n<li>“Hoisting” and function assignments</li>\n</ol>\n<hr>\n<p>Going back to our discussion about variable declarations being processed first, and then doing any assignments, it becomes obvious that we can’t call a function that we haven’t assigned to the variable yet.  I don’t think I need to discuss this any further than I already have.  This works like any other variable declaration as I’ve discussed above.</p>\n<ol start=\"4\">\n<li>“Hoisting” and function declarations</li>\n</ol>\n<hr>\n<p>Function declarations, on the other hand, behave differently than function assignments.  In the case of function declarations, the variable AND the function that is “assigned” to it get pulled to the top of our code.  So using function declarations over function assignments is preferred simply because it assures us that the function pointer is available whenever we need it.</p>\n<h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion\"></a>Conclusion</h2><p>So, maybe you thought you knew JavaScript.  Maybe you did.  Maybe you discovered you didn’t know it as well as you thought. I would encourage you to really learn the language.</p>\n",
            "tags": [
                "javascript",
                "scope",
                "hoist"
            ]
        }
    ]
}