{
    "version": "https://jsonfeed.org/version/1",
    "title": "Dave's Notebook • All posts by \"c#\" tag",
    "description": null,
    "home_page_url": "http://davembush.github.com",
    "items": [
        {
            "id": "http://davembush.github.com/coasting-curiosity-diversification-and-being-awesome/",
            "url": "http://davembush.github.com/coasting-curiosity-diversification-and-being-awesome/",
            "title": "Coasting, Curiosity, Diversification and Being Awesome",
            "date_published": "2017-03-21T10:30:00.000Z",
            "content_html": "<p>There are two twin evils that I see in the programming community. The first is the programmer who knows what he knows and has no desire to learn more. I call these, “coasters”. And then there are the programmers who are so curious that they try to learn every new thing that comes along, with no focus. The interesting thing is, both of these types of people end up at the same place. Out of work. The cure for both is the same.  Being Awesome.</p>\n<figure>![](/uploads/2017/03/image-3.png \"Coasting, Curiosity, Diversification and Being Awesome\")<figcaption>Photo credit: [aaronHwarren](//www.flickr.com/photos/pedalfreak/3745777389/) via [Visual hunt](//visualhunt.com/re/1b14eb) / [ CC BY-ND](//creativecommons.org/licenses/by-nd/2.0/)</figcaption></figure>\n\n<span id=\"more\"></span>\n\n<h2 id=\"Coasting-Is-for-Morons\"><a href=\"#Coasting-Is-for-Morons\" class=\"headerlink\" title=\"Coasting Is for Morons\"></a>Coasting Is for Morons</h2><p>If you are reading this blog, you are probably not in this category. In fact, it probably frustrates you to watch these types of programmers as much as it does me. But for completeness, let’s describe the coasting moron.</p>\n<p>These are the programmers who learned how to program more than 5 years ago and got a job and have never moved since. They are still programming in the same language they learned originally. They are probably still at the same job they started at. And, if they had to get a new job, they probably would not be able to find one because their skills are SO out-of-date.</p>\n<p>They are still using Web Forms or MVC in ASP.NET, have no idea how to use anything beyond .NET 2.0. Or worse, they learned how to program in Visual Basic back in the day and couldn’t write a proper .NET application to save their life.</p>\n<p>They know HTML 3.2 and maybe xHTML, but have no idea what HTML5 is.</p>\n<p>And if they had to use JavaScript, they are probably still stuck using ECMA Script 3. This is to say nothing of knowing the dangers of global variables or what prototypal inheritance is.</p>\n<p>They are doomed because they are so far behind, it would be impossible to catch up.</p>\n<h2 id=\"Curiosity-Killed-the-Cat\"><a href=\"#Curiosity-Killed-the-Cat\" class=\"headerlink\" title=\"Curiosity Killed the Cat\"></a>Curiosity Killed the Cat</h2><p>On the opposite end of the spectrum is the programmer who chases every new programming idea that comes out. These are the programmers who typically complain about things like <a href=\"/javascript-fatigue-makes-me-scream/\">JavaScript Fatigue</a>. While they are slightly better off than the programmer who learns nothing, they problem they face is that because they are trying to learn too much at once, they learn nothing. You have to commend their curiosity though.</p>\n<p>Fortunately, with a bit of structure, we can help the curious programmer. They are already motivated. And while I might be able to help the coaster in a one on one situation, I’m not going to spend a lot of time trying in this post. Why write to people who aren’t even likely to read?</p>\n<p>But I can help you.</p>\n<h2 id=\"Diversification-for-Programmers\"><a href=\"#Diversification-for-Programmers\" class=\"headerlink\" title=\"Diversification for Programmers\"></a>Diversification for Programmers</h2><p>So, first, what should you learn next? Another language? A new operating system?</p>\n<p>Well, the first thing you need to do is list out all the things you are interested in. Once you have that list, the next thing you want to try to figure out is which of those things is going to make you more valuable where you are today without causing you to learn more than one new thing.</p>\n<p>For example, you may currently know how to program in C# or VB.NET but only have a rough idea of how to use SQL other than basic CRUD operations. Maybe a deep dive into <a href=\"/SqlForNetProgrammers\">learning SQL</a> would be the next path.</p>\n<p>Or maybe you are doing some web development and know a bit of JavaScript, but haven’t looked at any of the SPA frameworks that are currently available. Pick one and learn it. I recommend Angular2 at this point, but it doesn’t really matter. Find something on your list and learn it.</p>\n<p>Anything you learn is good. Or maybe you are interested in a brand new language, but you can stay within the same basic framework. For example, I know C#, but I’m intrigued by functional programming. F# is on my short list of things I might learn next.</p>\n<p>The idea is to move incrementally rather than leaping to something where everything is new again. If you can somehow work this all into your day job, even better. You can’t always, but it is the fastest way to learn new stuff.</p>\n<h3 id=\"Learn-Outside-of-Programming\"><a href=\"#Learn-Outside-of-Programming\" class=\"headerlink\" title=\"Learn Outside of Programming\"></a>Learn Outside of Programming</h3><p>But it isn’t all about programming, is it? What can you learn that isn’t directly related to programming? There are all kinds of things. And the broader knowledge can help your programming as well. Maybe you have a side interest in business, finance, or marketing. Maybe you find yourself having trouble with interpersonal relationships. There are all kinds of other things you could be studying that really have nothing to do with programming directly, but have everything to do with making you more valuable both as a person and as an employee.</p>\n<p>Find outside interest!</p>\n<h2 id=\"Focus-Makes-Awesome\"><a href=\"#Focus-Makes-Awesome\" class=\"headerlink\" title=\"Focus Makes Awesome\"></a>Focus Makes Awesome</h2><p>Having said all of this. The real trick is focus. As I pointed out above, it is great to be curious. We can do something with that. But, if you try to learn more than 3 things at a time, you will end up learning nothing well.</p>\n<p>One of the guys I work with has a Trello board with a list of possible things to learn. I have a stack of sample kindle books to read someday, maybe. They are things I was curious about at one point. If I’m still interested when I’m looking for something new to read, I’ll pull them down and read the sample.</p>\n<p>But here’s the thing. I only focus on learning 2 or 3 new things at a time. Generally, one new programming thing and one new not programming thing.</p>\n<p>Currently, I’m learning all things Angular2. My goal is to be THE Angular2&#x2F;JavaScript expert in Connecticut. I’m well on my way.</p>\n<p>I have two other interest that have nothing to do with programming. One is Options Trading. I’m at a point with that where it only takes a few minutes a day. So, I have room for something else.</p>\n<p>That something else is everything brain science. Psychology, Sociology, Hypnosis, Memory, and more. It is a fascinating world.</p>\n<h2 id=\"Be-Awesome\"><a href=\"#Be-Awesome\" class=\"headerlink\" title=\"Be Awesome\"></a>Be Awesome</h2><p>There is a story about two guys who were in the woods when they ran into a bear. Being smart hikers, they agreed to try standing still to see if the bear would just ignore them. This worked well.</p>\n<p>But, after the bear left, one of the guys said to the other, “What would you have done if standing still didn’t work?” To which the second guy said, “I would have run as fast as I can.” The first guy responded, “But, do you really think you can outrun a bear?!” And then the second guy says, “I wouldn’t have to out run the bear. I only need to out run you.”</p>\n<p>And that is the market we live in. The good news is, there are so many people that are coasting right now that “awesome” is a pretty easy level to achieve in life.</p>\n<p>So, go out, do some focused learning and be awesome</p>\n",
            "tags": [
                "programming",
                "javascript",
                "c#",
                ".net"
            ]
        },
        {
            "id": "http://davembush.github.com/cefsharp-offscreen-why-do-i-have-so-many-instances-of-chromium/",
            "url": "http://davembush.github.com/cefsharp-offscreen-why-do-i-have-so-many-instances-of-chromium/",
            "title": "CefSharp Offscreen [Why do I have so many instances of Chromium?]",
            "date_published": "2015-10-01T11:32:00.000Z",
            "content_html": "<p>I’ve been using the CefSharp.Offscreen library to drive the Chromium browser for a couple of months now.  While the code I’ve been working on has been working correctly, I could never figure out why so many instances of Chromium are left dangling in my task manager.  Oh, they’d all go away once I exited the application, but then it would take a very long time for my application to completely close because there were so many instances of Chromium hanging around.</p>\n<p>This past week, I finally figured out how to keep the number of Chromium instances in line with the number of off-screen browser windows I was actually creating.</p>\n<p><img src=\"/uploads/2015/09/image4.png\" alt=\"image\" title=\"image\"></p>\n<span id=\"more\"></span>\n\n<p>I’m using version 41 of CefSharp, any future problem may not have this problem.  This post is intended to walk through the discovery steps and is not meant as a ding on the CefSharp developers.  Hey!  For all I know, the problem is in Chromium.</p>\n<p>So, as I’ve already mentioned, I noticed many instances of Chromium in my task manager.  At first I thought this was normal.  I’ve seen many instances of the Chrome browser in my task manager even though I only had one browser window open.  And I’ve seen information on the web that says multiple windows are needed to make Chromium work.</p>\n<p>But the more I run my program, the more windows show up in task manager.  Certainly this isn’t right.</p>\n<p>And then I started thinking about my code.  Every instance of my browser is wrapped in a using statement because the browser windows is disposable.  Could it be possible that some resource isn’t being disposed correctly as we use the same browser window to navigate from one page to another? Here is some code to illustrate my point.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// One browser window open at this point</span></span><br><span class=\"line\"><span class=\"comment\">// because of init code that runs before.</span></span><br><span class=\"line\"><span class=\"title function_\">using</span>(<span class=\"params\"><span class=\"keyword\">var</span> browser = <span class=\"keyword\">new</span> BrowserObject()</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"title function_\">foreach</span>(<span class=\"params\"><span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> listOfItems</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">       browser.<span class=\"title class_\">LoadUrl</span>(someNewLocation);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// Multiple browser windows open here</span></span><br></pre></td></tr></table></figure>\n\n<p>So, obviously this isn’t right.  Well, at least it is obvious to me.</p>\n<p>But what if the use case for this never was intended for it to be used like a regular window.  In that case, putting the using statement inside of the foreach would solve my problem.  It isn’t quite as efficient as I would like, but at least it would work.  And the fact that I had so many instances of chromium running was eating up memory and slowing my whole computer down.  At least this would give me my computer back.</p>\n<p>So, I changed the code to look more like this:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// One browser window open at this point</span></span><br><span class=\"line\"><span class=\"comment\">// because of init code that runs before.</span></span><br><span class=\"line\"><span class=\"title function_\">foreach</span>(<span class=\"params\"><span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> listOfItems</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"title function_\">using</span>(<span class=\"params\"><span class=\"keyword\">var</span> browser = <span class=\"keyword\">new</span> BrowserObject()</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">       browser.<span class=\"title class_\">LoadUrl</span>(someNewLocation);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// One browser window open here.</span></span><br></pre></td></tr></table></figure>\n\n<p>Fixed!</p>\n",
            "tags": [
                "c#",
                "Chromium",
                "debugging"
            ]
        },
        {
            "id": "http://davembush.github.com/7-c-interview-questions-that-weed-out-the-losers/",
            "url": "http://davembush.github.com/7-c-interview-questions-that-weed-out-the-losers/",
            "title": "7 C# Interview Questions [That Weed Out The Losers!]",
            "date_published": "2015-08-13T11:30:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/08/image1.png\" alt=\"image\" title=\"image\"></p>\n<p>So, once again, the place I am currently working has been interviewing for some more programmers and we’ve had to laugh at some of the answers we’ve received on some pretty simple question.</p>\n<p>For example, in answer to “How do you create an object in JavaScript?”  One applicant responded, “I always use the WHERE keyword.”  What?!!! And that naturally got us all talking about good interview questions.  How can we tell that the applicant is even worth interviewing? The following questions are not meant to be THE interview.  The questions are meant to shorten the interview process by ensuring the applicant has a basic understanding of the language they will be expected to work with.</p>\n<h2 id=\"C-Interview-Questions\"><a href=\"#C-Interview-Questions\" class=\"headerlink\" title=\"C# Interview Questions\"></a>C# Interview Questions</h2><span id=\"more\"></span>\n\n<h3 id=\"1-What-is-the-difference-between-an-Object-and-a-Class\"><a href=\"#1-What-is-the-difference-between-an-Object-and-a-Class\" class=\"headerlink\" title=\"1. What is the difference between an Object and a Class?\"></a>1. What is the difference between an Object and a Class?</h3><p>This is an object oriented 101 question.  So if you can’t answer this, I might try a few other questions for show, but you’ve probably already been counted out.  The way I always described the difference between the two is that the Class is like a cookie cutter and an Object is like the cookie.  The class defines what the object is going to do, but the object is the thing actually doing the work.</p>\n<p>A more technical answer would be that the Class defines the object while the Object is the Class active in memory.</p>\n<h3 id=\"2-What-is-“Polymorphism”\"><a href=\"#2-What-is-“Polymorphism”\" class=\"headerlink\" title=\"2. What is “Polymorphism”?\"></a>2. What is “Polymorphism”?</h3><p>This is my first stab at making sure you understand the basics of object oriented programming.  Does your answer at least include the concept of virtual functions?  Here is how I explain polymorphism.</p>\n<p>Polymorphism gets at the idea that you can have a method in a parent class and a method with the same name in a child class.  If the method in the parent class should be marked virtual and the method in the child class should be marked “overrides.”  At runtime, the decision as to which one is called is based on the type of the object that the method is called from.</p>\n<ul>\n<li><a href=\"//www.webopedia.com/TERM/P/polymorphism.html\">http://www.webopedia.com/TERM/P/polymorphism.html</a></li>\n</ul>\n<p>Some might want to include other concepts</p>\n<ul>\n<li><a href=\"//en.wikipedia.org/wiki/Polymorphism_(computer_science)\">https://en.wikipedia.org/wiki/Polymorphism_(computer_science)</a></li>\n</ul>\n<p>But historically, polymorphism has been limited to the basic idea of virtual functions and the applicant’s response should, at the very least, reflect this answer.</p>\n<h3 id=\"3-What-is-the-difference-between-overload-overrides-and-shadows\"><a href=\"#3-What-is-the-difference-between-overload-overrides-and-shadows\" class=\"headerlink\" title=\"3. What is the difference between overload, overrides, and shadows?\"></a>3. What is the difference between overload, overrides, and shadows?</h3><p>Again, this is to get at your understanding of object oriented programming generally and the sometimes confusing keywords in the language.</p>\n<ul>\n<li>Overloading gets at the concept that you can have multiple methods with the same name hanging off a given class as long as the methods all have a different signature (parameter types), the code is legal.</li>\n<li>Overrides is how polymorphism is implemented.</li>\n<li>Shadows flips polymorphism on it’s head.  If you mark a method as shadowed using the “new” keyword, then instead of the method getting called based on the object type, the method gets called based on the variable type that is holding the reference to the object.  So, given class A is a parent of class B and both have a method foo() and foo() is marked with the shadows keyword.  If you declare a variable of type A and point that variable to an object of type B, when you call foo off that object, A.foo() will be called.</li>\n</ul>\n<h3 id=\"4-What-is-the-difference-between-the-keyword-“String”-and-the-keyword-“string”\"><a href=\"#4-What-is-the-difference-between-the-keyword-“String”-and-the-keyword-“string”\" class=\"headerlink\" title=\"4. What is the difference between the keyword  “String” and the keyword “string”?\"></a>4. What is the difference between the keyword  “String” and the keyword “string”?</h3><p>I work with some pretty sharp guys and even they stumbled on this one.  Do YOU know? When I was teaching C# for a training company, I would say, “The only difference is that ‘string’ turns blue in the editor.”  Of course now that you can configure the editor, that’s not really a good answer.  But you get the point.  Both keywords compile down to the same intermediate language.  Technically, “string” is an alias for “String”.  “String” is the proper class.</p>\n<h3 id=\"5-What-is-“int”-an-alias-for\"><a href=\"#5-What-is-“int”-an-alias-for\" class=\"headerlink\" title=\"5. What is “int” an alias for?\"></a>5. What is “int” an alias for?</h3><p>Since we’ve already used the term alias by this point, I’m digging deep to find out just how much you know.  The proper answer is that “int” is an alias for the Int32 type.  I can forgive you if you say “class” but it really isn’t a class.  It is a type.</p>\n<h3 id=\"6-What-is-the-difference-between-a-value-type-and-a-reference-type\"><a href=\"#6-What-is-the-difference-between-a-value-type-and-a-reference-type\" class=\"headerlink\" title=\"6. What is the difference between a value type and a reference type?\"></a>6. What is the difference between a value type and a reference type?</h3><p>Once again, I’m trying to find out how well you know what is going on.  Do you just hack at your code until it seems to work, or do you really understand what is happening under the hood? Again, when I was teaching this, the explanation always went something like this: The value of a value type occupies memory on the stack and when you do an assignment from one value type to another the data is copied from one memory location to the other.  Each variable is changed in isolation to the other.</p>\n<p>A reference type is a variable on the stack that points to memory in the heap that actually holds the value.  When you do an assignment from one reference type to another, only the pointer is copied.  In the end, both variables point to the same location on the heap.</p>\n<p>If you change the value of a reference type from one variable, the other variable is impacted with the change because it is the same location in memory you are changing.</p>\n<p>The key part of this answer is that the value of a value type occupies the memory the variable represents and that the value of a reference type is pointed to by the memory that the variable represents.  The stack vs heap issue is secondary and in fact gets clouded by the fact that once you put a value type in a reference type, either by boxing or by including it as a member of a class, the whole stack vs heap question gets quite murky.  But, using stack vs heap as a general way of discussing the main issue is a starting point at the very least.</p>\n<h3 id=\"7-What-is-the-primary-factor-in-making-code-testable\"><a href=\"#7-What-is-the-primary-factor-in-making-code-testable\" class=\"headerlink\" title=\"7. What is the primary factor in making code testable?\"></a>7. What is the primary factor in making code testable?</h3><p>OK.  You knew I had to stick this one in here, right?  I doubt most programmers have given this much thought so it is OK if they have to spend some time thinking of the answer.</p>\n<p>What I’m hoping to hear is that dependencies make code untestable.</p>\n<p>Simplistic answer?  Maybe.  But the answer to this question, regardless of if it agrees with mine or not, will tell me if they’ve had any experience writing unit tests.</p>\n",
            "tags": [
                "interview",
                "c#"
            ]
        },
        {
            "id": "http://davembush.github.com/testing-extjs-with-selenium-using-c/",
            "url": "http://davembush.github.com/testing-extjs-with-selenium-using-c/",
            "title": "Testing EXTjs with Selenium using C#",
            "date_published": "2015-07-30T10:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/07/image2.png\" alt=\"image\" title=\"image\"></p>\n<p>For the last two years, about 99% of the work I’ve been doing has been JavaScript programming using EXTjs.  The problems I’ve encountered along the way are primarily related to testing.  Writing unit test using the “MVC Framework” out of the box is nearly impossible, but I did eventually put together an architecture that allows me to do that.  I may blog about that in the future.</p>\n<p>Today, what I want to offer is how I overcame various hurdles related to testing EXTjs with Selenium.  The first problem nearly everyone encounters when they first use EXTjs is that the views that are created are created dynamically.  If you use the recommended itemId to uniquely identify the elements on the page, you will be left with IDs that are dynamically generated and inconsistent.  That is, just because the ID has one value today doesn’t mean it will have the same value tomorrow.  And since the controls are dynamically created based on what browser is running, XPATH queries aren’t a good solution either.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Custom-FindsBy-attribute\"><a href=\"#Custom-FindsBy-attribute\" class=\"headerlink\" title=\"Custom FindsBy attribute\"></a>Custom FindsBy attribute</h2><p>Now, you could solve this problem by creating a different Page Object for each browser and then you’d be able to use XPATH statements to go after the elements.  But, what if you could go after the itemIds directly?  By the Selenium APIs let you create your own selectors.  So, instead of writing your element properties like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">FindsBy(How = How.Id, Using=<span class=\"string\">&quot;someId&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"keyword\">private</span> IWebElement SomeId&#123;<span class=\"keyword\">get</span>; [UsedImplicitly]<span class=\"keyword\">set</span>;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>You could do something like:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">FindsBy(How = How.Custom,</span></span><br><span class=\"line\"><span class=\"meta\">    CustomFinderType = typeof(ExtByComponentQuery),</span></span><br><span class=\"line\"><span class=\"meta\">    Using = <span class=\"string\">&quot;#someId&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"keyword\">private</span> IWebElement SomeId&#123;<span class=\"keyword\">get</span>; [UsedImplicitly]<span class=\"keyword\">set</span>;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>One of the side effects of using this extension is that you can now find any element using any valid EXTjs selector.</p>\n<p>So, you are probably wondering what the code looks like to get this all working.  Well here you go:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Generic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.ObjectModel;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Linq;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading;</span><br><span class=\"line\"><span class=\"keyword\">using</span> OpenQA.Selenium;</span><br><span class=\"line\"><span class=\"keyword\">using</span> OpenQA.Selenium.Internal;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">ENT.Supporting</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ExtByComponentQuery</span> : <span class=\"title\">By</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> <span class=\"built_in\">string</span> _locator;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ExtByComponentQuery</span>(<span class=\"params\"><span class=\"built_in\">string</span> locator</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            _locator = locator;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ExtByComponentQuery <span class=\"title\">Query</span>(<span class=\"params\"><span class=\"built_in\">string</span> locator</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (locator == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ArgumentNullException(<span class=\"string\">&quot;locator&quot;</span>,</span><br><span class=\"line\">                    <span class=\"string\">@&quot;Cannot find elements when name locator is null.&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ExtByComponentQuery(locator);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">override</span> IWebElement <span class=\"title\">FindElement</span>(<span class=\"params\">ISearchContext context</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> elements = FindElements(context);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (elements != <span class=\"literal\">null</span> &amp;&amp; elements.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> elements.First();</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">@&quot;returning null from FindElement&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">override</span> ReadOnlyCollection&lt;IWebElement&gt; <span class=\"title\">FindElements</span>(<span class=\"params\">ISearchContext context</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> script = <span class=\"built_in\">string</span>.Format(</span><br><span class=\"line\"><span class=\"string\">@&quot;var r= Ext.ComponentQuery.query(&#x27;&#123;0&#125;&#x27;);</span></span><br><span class=\"line\"><span class=\"string\">var rarray = [];</span></span><br><span class=\"line\"><span class=\"string\">for(e = 0;e &lt; r.length;e++)</span></span><br><span class=\"line\"><span class=\"string\">&#123; &#123;</span></span><br><span class=\"line\"><span class=\"string\">    if(r[e].getEl() !== undefined)</span></span><br><span class=\"line\"><span class=\"string\">        rarray.push(r[e].getEl().dom);</span></span><br><span class=\"line\"><span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\"><span class=\"string\">return rarray;&quot;</span>,_locator.Replace(<span class=\"string\">&quot;&#x27;&quot;</span>,<span class=\"string\">&quot;\\\\&#x27;&quot;</span>));</span><br><span class=\"line\">            <span class=\"keyword\">var</span> javaScriptExecutor = context <span class=\"keyword\">as</span> IJavaScriptExecutor ??</span><br><span class=\"line\">                                     ((IWrapsDriver)context).WrappedDriver <span class=\"keyword\">as</span> IJavaScriptExecutor;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (javaScriptExecutor == <span class=\"literal\">null</span>) <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">            <span class=\"built_in\">object</span> scriptReturn = <span class=\"literal\">null</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">120</span> &amp;&amp; scriptReturn == <span class=\"literal\">null</span>; i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ( i &gt; <span class=\"number\">0</span>) Thread.Sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                scriptReturn = javaScriptExecutor.ExecuteScript(script);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> scriptReturn == <span class=\"literal\">null</span> ? <span class=\"literal\">null</span> : <span class=\"keyword\">new</span> ReadOnlyCollection&lt;IWebElement&gt;((IList&lt;IWebElement&gt;)scriptReturn);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>The constructor gets passed the selector string that is passed with the Using parameter in the attribute.  The FindElements() finds all of the elements that match the selector.  The FindElement() returns the first of all that it found.</p>\n<p>You can either use this code as part of the FindsBy attribute or you can use it stand alone by calling the static Query method.</p>\n<p>You’ll see that the bulk of the functionality is just the same JavaScript code you would normally write in EXTjs.</p>\n<h2 id=\"Get-an-element’s-Value\"><a href=\"#Get-an-element’s-Value\" class=\"headerlink\" title=\"Get an element’s Value\"></a>Get an element’s Value</h2><p>One of the other problems you are likely to run into is retrieving the current value of an element.  This is because many of the controls that EXT provides to us do not use the INPUT item’s value to keep track of the value.  So, for this, and other similar scenarios, I wrote an extension method.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"built_in\">string</span> <span class=\"title\">GetExtValue</span>(<span class=\"params\"><span class=\"keyword\">this</span> IWebElement element</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    IWebElement realElement = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (element <span class=\"keyword\">as</span> IWrapsDriver == <span class=\"literal\">null</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> e = element <span class=\"keyword\">as</span> IWrapsElement;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"literal\">null</span>) realElement = e.WrappedElement;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">         realElement = element;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (realElement == <span class=\"literal\">null</span>) <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> wrapsDriver = (IWrapsDriver)realElement;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> id = realElement.GetAttribute(<span class=\"string\">&quot;id&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> driver = wrapsDriver.WrappedDriver;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> val = ((IJavaScriptExecutor)driver).ExecuteScript(</span><br><span class=\"line\">        <span class=\"string\">@&quot;return Ext.getCmp(arguments[0]).getRawValue();&quot;</span>,</span><br><span class=\"line\">        id);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (val == <span class=\"literal\">null</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">string</span>.Empty;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> val.ToString();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>What you’ll want to pay attention to here is the code at the top.</p>\n<p>The if(element as IWrapsDriver) stuff is testing to see if we have the real element or if we have a proxy to the element that was created by the FindsBy attribute.  If the element is of type IWrapsDriver, we have the proxy and so need to go grab the real element before we continue.  Once we are sure we are working with a real element, we can use JavaScript to grab the raw value from EXTjs.</p>\n<h2 id=\"Other-Modifications\"><a href=\"#Other-Modifications\" class=\"headerlink\" title=\"Other Modifications\"></a>Other Modifications</h2><p>I found that there were other modifications that I needed to make.  So I’ve also created extension methods that select items from dropdown list, Click radio buttons and checkboxes until they are actually selected (or actually unselected).  I found that they don’t always select or unselect on the first click for some reason.  Also, if your code is enabling and disabling stuff and you want to check for that, you’ll need to write some extensions to handle that because EXT uses a mask to disable.  The best way of determining if something is enabled or disabled is by writing JavaScript to ask EXT if it is enabled or disabled.  There are other things I’ve written that are somewhat project specific.  But if you run into a problem, your best bet is to create an extension method to go after EXT code directly.</p>\n<h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion\"></a>Conclusion</h2><p>I generally hate using the framework I’m using to test my code from EXTjs.  And whenever possible, I’ll look for a way to go after the elements using plain old selectors and the built in Selenium code.  But that isn’t always practical in this case.</p>\n",
            "tags": [
                "c#",
                "selenium",
                "extjs"
            ]
        },
        {
            "id": "http://davembush.github.com/what-browser-is-selenium-currently-running/",
            "url": "http://davembush.github.com/what-browser-is-selenium-currently-running/",
            "title": "What Browser Is Selenium Currently Running",
            "date_published": "2015-07-16T10:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/07/ppl-kid-044.jpg\" alt=\"ppl-kid-044\" title=\"ppl-kid-044\"></p>\n<p>This probably doesn’t happen all that often, but this last week I came across the need to know which browser I was running my selenium test against.  I figured that buried deep in the object structure of Selenium, there MUST be a way of finding out what browser I was currently running.  As it turns out, I was right.  The situation that caused this requirement is that the place where I’m currently writing most of my code is upgrading all the Firefox browsers.  I was asked to make sure the code we were running still works with the new browser.  When I did, I found that some of my tests broke even though the test itself still succeeds when it is run manually.  In fact, they only broke when running against this new version of Firefox.</p>\n<span id=\"more\"></span>\n\n<p>Now to be clear, this isn’t really a Firefox problem.  In fact, the new version of Firefox runs my test the way I would expect.  It is the current version of IE and the older version of Firefox that we were running in combination with EXTjs 4.2 that was a problem.  So, now I’m in a situation where I need to run my work around for everything except for this new version of Firefox.</p>\n<p>You see, we have several dropdown list.  To select an item from the list, I cursor down until the correct item is found.  My old implementation actually needed to cursor down twice.  The first time made the list display and kept the current item selected.  The second down arrow selected the next item.  The tab key keeps that item as the selected one.  The new version of Firefox only requires one down arrow and a tab to do the same thing.</p>\n<p>Since we have multiple dropdowns that behave the same way, I made this code an extension method, so I only have to do it once.  The other thing I’m doing that makes this work is that I’m proxying the elements using the FindsBy attribute.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">FindsBy(How = How.Id, Using = <span class=\"string\">&quot;someIdHere&quot;</span>), CacheLookup</span>]</span><br><span class=\"line\"><span class=\"keyword\">private</span> IWebElement SomePropertyName</span><br><span class=\"line\">    &#123; <span class=\"keyword\">get</span>; [UsedImplicitly] <span class=\"keyword\">set</span>; &#125;</span><br></pre></td></tr></table></figure>\n\n<p>Under the hood this creates a proxy to the real element.  What we need access to is the Driver object that this element is using to get at the element on the browser.  I do that by going after the element’s WrappedDriver property.  In most code you’ll see this cast to an IWrapsDriver interface.  But it is actually pointing to a RemoteWebDriver object.  If we cast the type to that, we can then go after the Capabilities object which will give us access to the BrowserName. And so, my resulting code looks something like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> keyDown = Keys.Down + Keys.Down;</span><br><span class=\"line\"><span class=\"keyword\">var</span> wrapsDriver = ((IWrapsDriver)(element)).WrappedDriver;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (wrapsDriver != <span class=\"literal\">null</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (wrapsDriver.GetType() == <span class=\"keyword\">typeof</span>(RemoteWebDriver) &amp;&amp;</span><br><span class=\"line\">        ((RemoteWebDriver)wrapsDriver)</span><br><span class=\"line\">        .Capabilities.BrowserName ==  <span class=\"string\">&quot;firefox&quot;</span>)</span><br><span class=\"line\">     &#123;</span><br><span class=\"line\">        keyDown = Keys.Down;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Which allows me to use the keyDown variable where ever I need to key down to select an item from the list.</p>\n<p>The element variable above represents the proxy element created by the FindsBy attribute.  The code is in the extension method that I mentioned previously, so it is actually the parameter that got passed into the extension method.</p>\n",
            "tags": [
                "c#",
                "testing",
                "selenium",
                "automation",
                "browser"
            ]
        },
        {
            "id": "http://davembush.github.com/browser-automation-in-net-w-chromium/",
            "url": "http://davembush.github.com/browser-automation-in-net-w-chromium/",
            "title": "Browser Automation in .NET w/ Chromium",
            "date_published": "2015-07-09T10:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2015/07/image.png\" alt=\"image\" title=\"image\"> Over the past ten years, I’ve successfully implemented various types of screen scraping in order to provide data to my clients.  Most of these implementations have involved accessing HTML and parsing out the data we needed for the web application.</p>\n<p>My latest implementation of this made use of the <a href=\"//htmlagilitypack.codeplex.com/\">HTML Agility Pack</a> and managed to incorporate the e-Labels For Education site into the Labels For Education site.  (No links, because the e-Labels program is being phased out.) Recently, I’ve been spending a lot of times on some site doing the same thing over and over again.  But most of the sites I visit now implement some kind of AJAX so that doing a simple web request to a page without also loading and parsing the JavaScript ends up giving me a page with no useful data at all.  Unlike the work I’ve done in the past where this was sufficient.</p>\n<p>This, combined with my recent work implementing Jasmine unit test for JavaScript and running them in the PhantomJS headless browser has had me thinking, wouldn’t it be great if I could do similar kinds of screen scraping, or even browser automation, but use something like an embedded version of PhantomJS to get the work done.</p>\n<span id=\"more\"></span>\n\n<p>Well, do a search for “embedded PhantomJS for .NET” or something similar and you’ll find that that isn’t possible.  At least not yet.</p>\n<p>But there is a viable alternative.  Actually there are a couple of viable alternative.  But they all end up using the Google Chromium browser API.  The implementation I ended up using is <a href=\"//github.com/cefsharp\">CefSharp</a>.  Mostly because this is what is available from NuGet.</p>\n<p>What follows are some of the tricks I learned along the way.</p>\n<h2 id=\"Installing-Chromium\"><a href=\"#Installing-Chromium\" class=\"headerlink\" title=\"Installing Chromium\"></a>Installing Chromium</h2><p>The first thing you’ll need to do once you have a project started, is that you’ll need to install the Chromium DLLs.  In the NuGet package manager, do a search for CefSharp.  This will bring up a list of plugins, you’ll want to install CefSharp.OffScreen and CefSharp.Common (I’m assuming you want to do off-screen automation here.)  The version I am working with is version 39.</p>\n<p>What I found difficult to figure out next was how to actually use the library.</p>\n<h2 id=\"Get-It-Initialized\"><a href=\"#Get-It-Initialized\" class=\"headerlink\" title=\"Get It Initialized\"></a>Get It Initialized</h2><p>You’ll want to initialize the library before you use it.  The following lines will do that.  I just put this as early in my code as possible.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> settings = <span class=\"keyword\">new</span> CefSettings</span><br><span class=\"line\">    &#123;LogSeverity = LogSeverity.Verbose&#125;;</span><br><span class=\"line\">settings.CefCommandLineArgs.Add(<span class=\"string\">&quot;no-proxy-server&quot;</span>, <span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Cef.OnContextInitialized = ()</span><br><span class=\"line\">    =&gt; Cef.SetCookiePath(<span class=\"string\">&quot;cookies&quot;</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!Cef.Initialize(settings, shutdownOnProcessExit: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    performDependencyCheck: <span class=\"literal\">true</span>))</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">     <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Exception(<span class=\"string\">&quot;Unable to Initialize Cef&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>If you want to use a proxy server, you’ll need to look up the documentation for how to set the proxy server.</p>\n<p>The Cef.SetCookiePath sets the location of your cookie file.</p>\n<h2 id=\"Creating-The-Browser-“Window”\"><a href=\"#Creating-The-Browser-“Window”\" class=\"headerlink\" title=\"Creating The Browser “Window”\"></a>Creating The Browser “Window”</h2><p>Now that you have this all set, you can use the ChromiumWebBrowser class to create a browser window.  Since the browser is disposable, you’ll want to either wrap the code in a using() statement or you’ll want to make sure you dispose of the browser object when you are done.</p>\n<p>You’ll want to set a few things on the browser object next.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">browser.BrowserSettings</span><br><span class=\"line\">    .FileAccessFromFileUrlsAllowed = <span class=\"literal\">true</span>;</span><br><span class=\"line\">browser.BrowserSettings</span><br><span class=\"line\">    .UniversalAccessFromFileUrlsAllowed = <span class=\"literal\">true</span>;</span><br><span class=\"line\">browser.BrowserSettings</span><br><span class=\"line\">    .WebSecurityDisabled = <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<p>And then you’ll want to wait for the browser to initialize.</p>\n<p>Now the code I was given for this looks like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Task <span class=\"title\">WaitForBrowserToInitialize</span>(<span class=\"params\"></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    <span class=\"keyword\">this</span> ChromiumWebBrowser browser</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> tcs = <span class=\"keyword\">new</span> TaskCompletionSource&lt;<span class=\"built_in\">bool</span>&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    EventHandler handler = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    handler = (sender, args) =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        browser.BrowserInitialized -= handler;</span><br><span class=\"line\">        tcs.TrySetResult(<span class=\"literal\">true</span>);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    browser.BrowserInitialized += handler;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> tcs.Task;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>You’ll recognize this as an extension method.  What it is doing is waiting for the BrowserInitialized event to fire and then telling the task it can return.  This works great the first time you use it, but I found that when I created a new browser “window” the initialization happened so quickly that this was unreliable.  I’ve replaced this code with the more reliable version below.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Task <span class=\"title\">WaitForBrowserToInitialize</span></span></span><br><span class=\"line\"><span class=\"function\">    (<span class=\"params\"><span class=\"keyword\">this</span> ChromiumWebBrowser browser</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!Browser.IsBrowserInitialized)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">await</span> Task.Delay(<span class=\"number\">100</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>It does the same thing.  It is just more reliable.</p>\n<h2 id=\"Load-a-Page\"><a href=\"#Load-a-Page\" class=\"headerlink\" title=\"Load a Page\"></a>Load a Page</h2><p>Everything else is pretty straight forward.  To load a web page:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Task <span class=\"title\">LoadUrl</span>(<span class=\"params\"></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    <span class=\"keyword\">this</span> ChromiumWebBrowser browser, <span class=\"built_in\">string</span> url</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    browser.Load(url);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> browser.WaitForPage();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>That WaitForPage() method looks like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Task <span class=\"title\">WaitForPage</span>(<span class=\"params\"></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    <span class=\"keyword\">this</span> ChromiumWebBrowser browser</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> tcs = <span class=\"keyword\">new</span> TaskCompletionSource&lt;<span class=\"built_in\">bool</span>&gt;();</span><br><span class=\"line\">    EventHandler&lt;NavStateChangedEventArgs&gt; handler = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    handler = (sender, args) =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">//Wait for while page to finish loading not</span></span><br><span class=\"line\">        <span class=\"comment\">// just the first frame</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!args.IsLoading)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            browser.NavStateChanged -= handler;</span><br><span class=\"line\">            tcs.TrySetResult(<span class=\"literal\">true</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    browser.NavStateChanged += handler;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tcs.Task;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Get-Data-Out\"><a href=\"#Get-Data-Out\" class=\"headerlink\" title=\"Get Data Out\"></a>Get Data Out</h2><p>If you need to get data out of the page, you can use GetSourceAsync();</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> source = <span class=\"keyword\">await</span> browser.GetSourceAsync();</span><br></pre></td></tr></table></figure>\n\n<p>or you can use JavaScript to get at the DOM using</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">await</span> EvaluateScriptAsync(javaScriptCodeHere);</span><br></pre></td></tr></table></figure>\n\n<p>Note, you can also use <code>EvaluateScriptAsync</code> to do things like clicking buttons, scrolling the window and a lot of other useful things.</p>\n<h3 id=\"Other-Places-Talking-About-Chromium-for-NET\"><a href=\"#Other-Places-Talking-About-Chromium-for-NET\" class=\"headerlink\" title=\"Other Places Talking About Chromium for .NET\"></a>Other Places Talking About Chromium for .NET</h3><ul>\n<li><a href=\"//umaranis.com/2013/10/16/how-to-embed-chrome-browser-in-net-application/\">Embed Chromium Using CefGlue</a></li>\n<li><a href=\"//thechriskent.com/2014/08/18/embedded-chromium-in-winforms/\">Embedded Chromium in WinForms</a></li>\n</ul>\n",
            "tags": [
                "c#",
                "CefSharp",
                "Chromium"
            ]
        },
        {
            "id": "http://davembush.github.com/magic-strings-and-magic-numbers/",
            "url": "http://davembush.github.com/magic-strings-and-magic-numbers/",
            "title": "Magic Strings and Magic Numbers",
            "date_published": "2014-12-18T12:00:00.000Z",
            "content_html": "<p>This past week a very old (last time I did work for him was in 2007) client of mine contacted me because their program suddenly started exhibiting a problem.  It seems that if a user enters a date anytime in 2015, the program displays an error message indicating that they need to enter a date greater than today and less than two years from today.</p>\n<p>When I went to replicate the error in my debugger, I discovered this bit of code:</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (Year &lt; <span class=\"number\">100</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (Year &lt; <span class=\"number\">15</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Year += <span class=\"number\">2000</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Year += <span class=\"number\">1900</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<span id=\"more\"></span>\n\n<p>So that, if you enter any date as 15, it assumes the date is 1915 instead of 2015.</p>\n<p>Now, we are talking about code here that has been around since the DOS days, and I’m pretty sure this particular routine has been around since then too.  I’m sure when it was coded, the year 2015 seemed so distant, that no one considered that the program might actually still be running in some form.</p>\n<p>But, that’s just the problem with Magic Strings and Magic Numbers.  They can appear to work for years, even decades, and then one day they show themselves for the evil they are.</p>\n<p>So, how can you guard yourself against using Magic Strings or Magic Numbers? That’s just the issue.  You can’t.  Sometimes they are only obvious once they manifest themselves as a bug.  However, here are a set of common places you should look.</p>\n<h2 id=\"Are-you-working-with-dates\"><a href=\"#Are-you-working-with-dates\" class=\"headerlink\" title=\"Are you working with dates?\"></a>Are you working with dates?</h2><p>Yeah, I know, this one is obvious since that’s what we are talking about.  But here are some other places you might want to look.</p>\n<p>As I’ve considered how I might fix this bug, I’ve decided that what I’ll do is get the current year, find the two digit version and add three to it.  I’ll use that computed date as the century roll over.</p>\n<p>But code is immortal.  That’s not the only place in this code that needs fixing.  The other place is the 1900 and 2000.  Those should be computed as well.  Not that I plan on being around, in the year 2100 and following, but as long as this code has been around, I should plan on the code being around then.  And it won’t be that much more work to compute those centuries as  century of today and century of today minus 100.</p>\n<p>The only constant I can see using in the code above is the 100.  Even if it does change, I don’t think anyone will complain too loudly when it does.</p>\n<h2 id=\"Databases\"><a href=\"#Databases\" class=\"headerlink\" title=\"Databases\"></a>Databases</h2><p>Another obvious place to look is in your database code.</p>\n<p>Actually, if you aren’t careful, there are a lot of mistakes you can make here.  But for now, let’s just stick to magic string issues.</p>\n<h3 id=\"Connection-Strings\"><a href=\"#Connection-Strings\" class=\"headerlink\" title=\"Connection Strings\"></a>Connection Strings</h3><p>By now, this should be obvious.  Don’t include the connection string to your database in the code of your program.  At the very least, put it in your web.config or app.config file so it can be changed without recompiling your code.</p>\n<h3 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a>SQL</h3><p>If you’ve done any amount of programming, you should know by now that your SQL belongs in your SQL database as a stored procedure.  That’s the best place for it.  However, I’ve had occasions where getting the SQL changed by the SQL gods, otherwise known as the DBAs, is so painful, that including the SQL in your code is much more practical.</p>\n<p>Here’s a tip.  Keep your SQL code separate from your other code.  Put it in a resource file.  Put it in a text file.  Just don’t put it in your C# or VB.NET code.</p>\n<h3 id=\"POCOs\"><a href=\"#POCOs\" class=\"headerlink\" title=\"POCOs\"></a>POCOs</h3><p>Are you generating POCOs to accompany your SQL?  Assuming you can’t use Entity Framework and you have to generate your own POCOs, you should generate your POCOs from your SQL.  That way, if your SQL changes, your POCO code changes automatically.</p>\n<h3 id=\"Schemas-Change\"><a href=\"#Schemas-Change\" class=\"headerlink\" title=\"Schemas Change\"></a>Schemas Change</h3><p>And while we are talking about Schemas, I’ll remind you that Schemas change.  Do you have a strategy in place so that you can tell what version of the database schema you are using at any particular time?</p>\n<h2 id=\"The-File-System\"><a href=\"#The-File-System\" class=\"headerlink\" title=\"The File System\"></a>The File System</h2><p>File system issues have frustrated me on several occasions.  The most obvious one is the difference between Mac&#x2F;Linux and Windows.  Now that .NET is going to be available on Mac and Linux, this is something you’ll want to pay attention too.  But, you should also pay attention to assumptions like drive letters.  Will you always want your code saved in this location.</p>\n<p>We had an issue years ago with the same code base I referred to above when Vista came out and you could no longer save your data files with your program files.  It took several hours of refactoring to get that code into a location that the user had rights to.  That should be a lesson for you.  Once again, just because a hard coded value works today, doesn’t mean it will work tomorrow.</p>\n<h2 id=\"Dave’s-Law-of-N\"><a href=\"#Dave’s-Law-of-N\" class=\"headerlink\" title=\"Dave’s Law of N\"></a>Dave’s Law of N</h2><p>This next one is not one you’d naturally think of as a Magic Number, but it is.</p>\n<p>You go to the customer and get requirements that say there will be two of something.  Maybe the contact record will have two phone numbers.  Or maybe they say there will be three of something.  It doesn’t really matter.  The magic number here is in the number of items that you need to store.</p>\n<p>I’ve seen this violated in a number of ways.  But the interview question I now ask is something along the lines of, “You need to store a person class in the database with FirstName, LastName, BirthDate, HomePhone, and CellPhone.  Create a database schema to hold this information.</p>\n<p>If they don’t come back to me with at least two tables, one for the Person and one for Phone numbers, I won’t hire them.  They get bonus points if they also create a third table so that we can classify the phone numbers in the phone number table.</p>\n<p>And that’s where “Dave’s Law of N” comes in.</p>\n<blockquote>\n<p>If there is two of something there WILL be three of something. </p>\n</blockquote>\n<p>Code it today so that tomorrow we can add the third item without coding.  It won’t take you any longer to do it right today and it will save us time when they eventually realize they should have asked for more.</p>\n<p>Well, I’m sure that’s not all of the places you should look.  But that’s a start to get you thinking in the right direction.</p>\n",
            "tags": [
                "c#",
                "vb.net",
                "magic numbers",
                "magic strings"
            ]
        },
        {
            "id": "http://davembush.github.com/value-type-vs-reference-type/",
            "url": "http://davembush.github.com/value-type-vs-reference-type/",
            "title": "Value Type vs Reference Type",
            "date_published": "2014-11-27T12:00:00.000Z",
            "content_html": "<p>It is amazing to me how few programmers understand the fundamentals of how variables work.  Not just in .NET or C# specifically, but in every language they work in.  It amazes me for two reasons.  First, I don’t think I could program if I didn’t understand what was physically happening as a result of the code I was writing.  Not knowing how the variables relate to the memory that they use would be, to me, a major limitation.  But it also amazes me because I don’t think anyone can program intelligently until they do know what is happening. So, I’ll start from the outside and move in to what’s happening in memory.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"What-is-A-Value-Type\"><a href=\"#What-is-A-Value-Type\" class=\"headerlink\" title=\"What is A Value Type\"></a>What is A Value Type</h2><p>The first question we need to qualify is, “What types in .NET are referred to as Value types?  Common value types are int, double, float, decimal, and bool.  What we ypically refer to as “primitives”.  But, there are other types that are also value types.  Enums, structs, and DateTime(because it is a struct) are also value types.</p>\n<h2 id=\"What-is-a-Reference-Type\"><a href=\"#What-is-a-Reference-Type\" class=\"headerlink\" title=\"What is a Reference Type\"></a>What is a Reference Type</h2><p>Reference types are any types in .NET that derive from a Class and require the “new” keyword in order to have an instance of a variable of that type. Why didn’t I just say, “any type that derives from a Class?”  Well, the fact of the matter is that every type in .NET derives from a Class.  The top most class is “Object”.  All of the value types derive from the subclass of Object named, “System.ValueType”.</p>\n<h2 id=\"What-Happens-In-Memory\"><a href=\"#What-Happens-In-Memory\" class=\"headerlink\" title=\"What Happens In Memory\"></a>What Happens In Memory</h2><p>But it is what happens in memory when we use these variable types that is of interest to us. When you declare a variable that is a Value type and then assign a value to it, the memory that variable occupies holds the value you assigned to it.  The variable is just a representation of the actual value. Contrast this to a reference type.  When you new up (instantiate) a variable that is a reference type, the first thing that is happening is that memory is being allocated to hold the variables in the class and then memory is being set aside to hold a pointer to the memory we just allocated. So, with a reference type, we are only pointing to the memory we are actually using.  With a value type the variable IS the value we are using. This has implications to how the memory is used when we do assignments.</p>\n<h2 id=\"Value-Example\"><a href=\"#Value-Example\" class=\"headerlink\" title=\"Value Example\"></a>Value Example</h2><p>For example, look at the code below.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">int</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"built_in\">int</span> b = <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">a = b;</span><br></pre></td></tr></table></figure>\n\n<p>When we assign b to a, we are copying the value occupied by b into the memory location occupied by a.</p>\n<h2 id=\"Reference-Example\"><a href=\"#Reference-Example\" class=\"headerlink\" title=\"Reference Example\"></a>Reference Example</h2><p>But what happens when we do the same thing with a reference type?</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"built_in\">string</span> Name;</span><br><span class=\"line\">    <span class=\"built_in\">int</span> age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> joe = <span class=\"keyword\">new</span> Person();</span><br><span class=\"line\">joe.Name = <span class=\"string\">&quot;Joe&quot;</span>;</span><br><span class=\"line\">joe.age = <span class=\"number\">23</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> alice = <span class=\"keyword\">new</span> Person();</span><br><span class=\"line\">alice.Name = <span class=\"string\">&quot;alice&quot;</span>;</span><br><span class=\"line\">alice.age = <span class=\"number\">33</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">joe = alice;</span><br><span class=\"line\">joe.age = <span class=\"number\">50</span>;</span><br></pre></td></tr></table></figure>\n\n<p>What will be the value of alice.age? You should say 50 because once we assigned alice to joe, alice and joe point to the same Person object and the Person object that alice pointed to is no longer available.</p>\n<h2 id=\"How-About-Structs\"><a href=\"#How-About-Structs\" class=\"headerlink\" title=\"How About Structs?\"></a>How About Structs?</h2><p>But what happens if we make the Person class a struct instead?</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> Person</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"built_in\">string</span> Name;</span><br><span class=\"line\">    <span class=\"built_in\">int</span> age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Person joe;</span><br><span class=\"line\">joe.Name = <span class=\"string\">&quot;Joe&quot;</span>;</span><br><span class=\"line\">joe.age = <span class=\"number\">23</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Person alice;</span><br><span class=\"line\">alice.Name = <span class=\"string\">&quot;Alice&quot;</span>;</span><br><span class=\"line\">alice.age = <span class=\"number\">33</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">joe = alice;</span><br><span class=\"line\">joe.age = <span class=\"number\">50</span>;</span><br></pre></td></tr></table></figure>\n\n<p>Now, what is the value of alice.age? In this case, you should say that alice is still 33 because when we assigned alice to joe, joe got a copy of everything that alice had. So, joe’s name is “alice” and before we asign 50 to joe.age, joe.age holds the value of 33.  But the assignment has no impact on the value of alice.age.</p>\n<h2 id=\"Stacks-And-Heaps\"><a href=\"#Stacks-And-Heaps\" class=\"headerlink\" title=\"Stacks And Heaps\"></a>Stacks And Heaps</h2><p>Now, no description of value types and reference types would be complete without some discussion of stacks and heaps. The stack is the location in memory that holds value types and reference pointers (remember I said the variable points to the memory being occupied by the value?) in your method. So when you declare a variable inside of a method that memory gets “Pushed” onto the stack. When you pass a variable to another method, that variable gets copied into a temporary variable and placed on the stack. So, doing something like</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Foo</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"built_in\">int</span> i = <span class=\"number\">23</span>;</span><br><span class=\"line\">    Foo2(i);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Foo2</span>(<span class=\"params\"><span class=\"built_in\">int</span> f</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   <span class=\"comment\">// do something with f</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>will copy 23 so that the variable f in Foo2 will not be the variable i in Foo. So if we change the value of f in Foo2 to 32, what will be the value of i when Foo2 returns? Because it is a copy, it will still be 23. The heap, on the other hand, is a location in memory that is outside of the scope of the methods we create.  So the only thing being passed around in our functions that use reference variables is pointers.  But, because they are pointers, any thing we do do a reference object inside of a method will be reflected in the variable located inside of the method that called it.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Foo</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> p = <span class=\"keyword\">new</span> Person();</span><br><span class=\"line\">    p.age = <span class=\"number\">24</span>;</span><br><span class=\"line\">    Foo2(p);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Foo2</span>(<span class=\"params\">Person person</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    person.age = <span class=\"number\">44</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>So when Foo2 returns, p.age will be 44. However, if we change what person is pointing to…</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Foo2</span>(<span class=\"params\">Person person</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    person = <span class=\"keyword\">new</span> Person();</span><br><span class=\"line\">    person.age = <span class=\"number\">44</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>p would remain unchanged and p.age would still be 24.</p>\n<h2 id=\"Values-Inside-of-a-Class\"><a href=\"#Values-Inside-of-a-Class\" class=\"headerlink\" title=\"Values Inside of a Class\"></a>Values Inside of a Class</h2><p>The final question that you should be asking at this point is when I declare a value type as a member variable of my class, as I’ve done with the age variable in Person above, where is the age variable located, on the stack or on the heap? The answer to that would be it is located in the heap because it is a member of a class that is located in the heap.  And if we created another person object inside of person, the pointer would also be located in the heap and it would point to another location of the heap.</p>\n",
            "tags": [
                "programming",
                "c#",
                "reference types",
                "value types",
                "objects"
            ]
        },
        {
            "id": "http://davembush.github.com/c-properties-get-and-set/",
            "url": "http://davembush.github.com/c-properties-get-and-set/",
            "title": "C# Properties Get and Set",
            "date_published": "2014-11-13T12:00:00.000Z",
            "content_html": "<p>My son is learning to program.  Last week he asked me to explain C# properties get and set and, as it turns out, it looks like many others are asking for the same.  So, I’ve decided to spend the time on this post, explaining getters and setters in about as much detail as one can expect. So here it goes…</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Member-Variables\"><a href=\"#Member-Variables\" class=\"headerlink\" title=\"Member Variables\"></a>Member Variables</h2><p>So, a class has “member variables” that are typically scoped as private, although they could be (but shouldn’t be) scoped as public.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">SomeClass</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"built_in\">int</span> _someMemberIntegerVariable;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Inside the class definition but not in the methods.  You’ll also sometimes see this referred to as a “field”.  I call them “member variables” because that is what I learned them as back when I was programming C++.</p>\n<h2 id=\"Local-Variables\"><a href=\"#Local-Variables\" class=\"headerlink\" title=\"Local Variables\"></a>Local Variables</h2><p>If the variable is in a method, it is called a “local variable”</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">SomeClass</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">SomeMethod</span>()</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">int</span> someLocalIntegerVariable;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Class-“State”\"><a href=\"#Class-“State”\" class=\"headerlink\" title=\"Class “State”\"></a>Class “State”</h2><p>Now, the reason we have member variables is because they hold the “state” of the object.  For example, you might have a person class (typical example).  The Person class would have a firstName, lastName, birthDate as member variables so that when the class is created (and becomes an object) they can hold the state of the person. “Dave”, “Bush”, 6&#x2F;20&#x2F;61.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"built_in\">string</span> _firstName;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"built_in\">string</span> _lastName;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date _birthDate;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Old-Time-Get-and-Set\"><a href=\"#Old-Time-Get-and-Set\" class=\"headerlink\" title=\"Old Time Get and Set\"></a>Old Time Get and Set</h2><p>Now, in the old days (my C++ days) we’d just make those member variables public so that any other class could access them directly.  The problem with that is that any other class could access them directly leaving our class unable to control what exactly came into them.  And so, some gatekeeping was added.  In C++ and Java, that was done with setter methods and getter methods.  In Java that may have changed since the days I programmed in Java, but they started that way at least. That is, setFirstName(string name), setLastName(string name), setBirthDay(date birthday)</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"built_in\">string</span> _firstName;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"built_in\">string</span> _lastName;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date _birthDate;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">setFirstName</span>(<span class=\"params\">firstName</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _firstName = firstName;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">setLastName</span>(<span class=\"params\">lastName</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _lastName = lastName;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">setFirstName</span>(<span class=\"params\">Date birthDate</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _birthDate = birthDate;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>  and to retrieve them…. getFirstName(), getLastName(), getBirthDate() the setters and getters are public (or protected, or private as needed) but the member variables are always private so that only the class they are declared in can access them. Inside the setter, we make sure the data is valid before we set the member variable, or possibly do some sort of computation before we store it, or even pass it on to some other location. But as far as anyone using the class is concerned, it is set setting a value and when it calls the getter, it retrieves the value, or something similar.</p>\n<h2 id=\"C-Properties-Get-and-Set\"><a href=\"#C-Properties-Get-and-Set\" class=\"headerlink\" title=\"C# Properties - Get and Set\"></a>C# Properties - Get and Set</h2><p>So along comes C# and that language says, “having a getter method and a setter method is pretty dumb, we should syntactically stich them together.” And so they came up with properties The syntax for that is</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> datatype _propertyName;</span><br><span class=\"line\"><span class=\"keyword\">public</span> datatype PropertyName</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">get</span> &#123;<span class=\"keyword\">return</span> _propertyName;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">set</span>&#123;_propertyName = <span class=\"keyword\">value</span>;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Which is all declared inside a class.  The member variable doesn’t have to be named the same as the property, but it often is .  It is customary to name member variables with a leading underscore.  Local variables start with a lowercase character. So, properties and member variables are distinct. Although, you may have thought they were essentially the same thing. At the end of the day, once they are compiled, properties are just methods. But syntactically, you access them as though they were variables.  In fact, if you looked at a property in Intermediate Language (IL), the language that all .NET code compiles to, you would see that it is just a method. To access a property from within your code, you would access it as</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">someObject.FirstName = <span class=\"string\">&quot;Dave&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>or</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">someVariable = someObject.FirstName;</span><br></pre></td></tr></table></figure>\n\n<p>the only reason they exist at all is to keep the outside world (outside the class) from stomping on the member variables of the class directly. The compiler does for us what the old timers did (and the Java guys still do) using getMethod and setMethod So, as it turns out, we need all that gatekeeping, but the fact of the matter is, many times we don’t. When I was teaching, I’d have guys say, “if I don’t need the gatekeeper, why even bother with the properties?” Which is kind of a valid point But I always countered, “But what if you eventually do?</p>\n<h2 id=\"Enhanced-Properties\"><a href=\"#Enhanced-Properties\" class=\"headerlink\" title=\"Enhanced Properties\"></a>Enhanced Properties</h2><p>I think Microsoft heard that so they embellished the language so that we don’t have to declare the member variable if all we are going to do is just pass the data on through to it. That syntax is</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> dataType PropertyName &#123;<span class=\"keyword\">get</span>;<span class=\"keyword\">set</span>;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>the compiler generates the member variable for you So if I wanted to actually do something with the member variable, you would need to declare the member variable. It depends on what you were going to do with it. If you just wanted to retrieve the data at some other point in your application, you’d just use the property.  But if you needed to manipulate the data as it was being set or retrieved, you’d have to use the original syntax. And that’s properties up until today.</p>\n",
            "tags": [
                "c#",
                ".net",
                "get",
                "properties",
                "set"
            ]
        },
        {
            "id": "http://davembush.github.com/selenium-performance-improvements/",
            "url": "http://davembush.github.com/selenium-performance-improvements/",
            "title": "Selenium Performance Improvements",
            "date_published": "2014-10-02T10:00:00.000Z",
            "content_html": "<p>As many of you know, I’ve been using <a href=\"//www.seleniumhq.org/\">Selenium</a> to do my website testing.  And, if you’ve done any testing with Selenium yourself, you know that Selenium can be even slower if you are using Selenium Grid. There are several things you might do today to achieve Selenium Performance improvements in order to increase the speed that your of your test run.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"CacheLookup-attribute-or-Annotation-if-you-are-using-Java\"><a href=\"#CacheLookup-attribute-or-Annotation-if-you-are-using-Java\" class=\"headerlink\" title=\"CacheLookup attribute (or Annotation if you are using Java)\"></a>CacheLookup attribute (or Annotation if you are using Java)</h2><p>This is probably the most obvious place for improvement.  Assuming you are using the Page Model pattern in your testing, your page model should have properties that already look something like:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">FindsBy(How = How.Id, Using = <span class=\"string\">&quot;radioButton&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"keyword\">private</span> IWebElement RadioButton&#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>;&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>What you may not know is that the way this works is that EVERY time you access the property named RadioButton it will lookup the location of the radio button.  The RadioButton property is actually a proxy for the real IWebElement that it will lookup on the fly. So, if you are using the element more than once in your test, it will perform the lookup each time you access the RadioButton property. By adding the CacheLookup attribute to the RadioButton property,</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">FindsBy(How = How.Id, Using = <span class=\"string\">&quot;radioButton&quot;</span>), CacheLookup</span>]</span><br><span class=\"line\"><span class=\"keyword\">private</span> IWebElement RadioButton&#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>;&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>you can force the RadioButton to be resolved once and only once. Most of my test ask for elements once per test, so I didn’t see any major performance gains by adding this.  Your mileage may vary.</p>\n<h2 id=\"CacheLookup-Warning\"><a href=\"#CacheLookup-Warning\" class=\"headerlink\" title=\"CacheLookup Warning\"></a>CacheLookup Warning</h2><p>Be careful when adding CacheLookup to your properties because any time the HTML is recreated, the element will become “stale” and you’ll need to look it up again. For example, in one of the pages I’m testing, I have two modal windows that get created as part of the test.  Each time they are created, they have to be resolved again because the old ones no longer exist. It would be like trying to reference a pointer to an object that no longer exist because something else deleted it.  Actually, that’s exactly what is happening.</p>\n<h2 id=\"CacheLookup-Only-Solves-One-of-Your-Problems\"><a href=\"#CacheLookup-Only-Solves-One-of-Your-Problems\" class=\"headerlink\" title=\"CacheLookup Only Solves One of Your Problems\"></a>CacheLookup Only Solves One of Your Problems</h2><p>But if all you do to your site is add CacheLookup, you are wasting your time.  You have to start thinking like your code. Did you know that every time you access a property on an IWebElement, Selenium has to make a call to the browser to access the current value? Yep. Actually, if you think about it, this is what you hope it does.  It is what makes code like this work:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Wait.Until(x =&gt; Page.RadioButton.GetAttrinbute(<span class=\"string\">&quot;disabled&quot;</span>));</span><br></pre></td></tr></table></figure>\n\n<p>But how many times to we write code that goes after a property multiple times when we know the value, or at least we assume the value, hasn’t changed? Or how many of you are doing the same thing multiple times in the same test? For example, in the code I’m testing currently, I have a header and a footer that I need to hide so that when an element is scrolled into view by Selenium, it doesn’t scroll under the header or the footer. I’m currently hiding and showing every time I perform some action on an element.  But now that I’m starting to think about performance, I’m asking myself, “What was I thinking?!” In this case, I would save a lot of time by turning the header off once a the beginning of my test.  I bet my test end up running twice as fast simply by doing that. So, keep in mind that every Selenium call you make is probably going to have to access the server in order to perform the action or retrieve the value you are looking for and try to write your code so that you are only making that call to the server one time per test. I bet you see some performance improvements.</p>\n",
            "tags": [
                "tdd",
                "c#",
                "bdd",
                "selenium",
                "java"
            ]
        },
        {
            "id": "http://davembush.github.com/running-selenium-in-parallel-with-any-net-unit-testing-tool/",
            "url": "http://davembush.github.com/running-selenium-in-parallel-with-any-net-unit-testing-tool/",
            "title": "Running Selenium In Parallel With Any .NET Unit Testing Tool",
            "date_published": "2014-07-31T17:15:00.000Z",
            "content_html": "<p>Running Selenium in parallel from .NET seems to be a problem because, as of the time of this writing, I’ve yet to find a viable way of running selenium test on multiple browsers using <a href=\"//docs.seleniumhq.org/docs/07_selenium_grid.jsp\">Selenium Grid</a>.  This doesn’t mean that there aren’t a few articles out there that have some kind of solution.  But they’ve never satisfied me as something that I could easily plug into my already created test. While my preferred testing tools are <a href=\"//www.nunit.org/\">NUnit</a> and <a href=\"//www.specflow.org/\">SpecFlow</a>, the method I am about to propose should work with any existing test harness you might want to use.  The only prerequisite is that you are using <a href=\"//code.google.com/p/selenium/wiki/PageObjects\">Page Models</a> to wrap your access to any particular web page. This article assumes that you already:</p>\n<ul>\n<li>know how to write Selenium tests</li>\n<li>know how to use Selenium Grid</li>\n<li>know how to use the Page Model pattern</li>\n<li>know how to use your chosen test harness.</li>\n</ul>\n<span id=\"more\"></span>\n\n<h2 id=\"Here-Is-The-Problem\"><a href=\"#Here-Is-The-Problem\" class=\"headerlink\" title=\"Here Is The Problem\"></a>Here Is The Problem</h2><p>In order to run multiple browsers at the same time, the easiest way is to provide a wrapper Page Model that calls multiple instances of the page model at the same time. The hard way of doing this would be to create an Interface that represented the real page model and then create a proxy class that would hold a list of all of the real page model objects we needed to call.  Each time a property or method on the proxy gets called, all it would do would be to pass the call down into the real objects in parallel. This would work, but the main draw back is that I really don’t want to have to write a method for each method in my real page model.  So the question is, how can we get around this?</p>\n<h2 id=\"DynamicObject-To-The-Rescue\"><a href=\"#DynamicObject-To-The-Rescue\" class=\"headerlink\" title=\"DynamicObject To The Rescue\"></a>DynamicObject To The Rescue</h2><p>Enter the little known class, <a href=\"//msdn.microsoft.com/en-us/library/system.dynamic.dynamicobject(v=vs.110).aspx\">DynamicObject</a>.   In .NET 4, Microsoft introduced the dynamic keyword.  One of the main uses is for places where  you need to be able to declare a variable in your code that the compiler won’t know how to resolve the type of until runtime.  I could have used this several years ago when I had two assemblies that needed to reference each other.  In that case, I used reflection.  But dynamic would have worked with a lot less work. DynamicObject is a specific class that allows us to resolve property and method calls at runtime using our own logic. We will also use the Task Parallel library to implement our parallel calls. For completeness, and so that no one is confused when they try to implement this code, you’ll need the following using statements at the top of the CS file.</p>\n<h2 id=\"Using-Statements-And-Constructor\"><a href=\"#Using-Statements-And-Constructor\" class=\"headerlink\" title=\"Using Statements And Constructor\"></a>Using Statements And Constructor</h2><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Concurrent;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Dynamic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Reflection;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br></pre></td></tr></table></figure>\n\n<p>So, let’s get started.  The first thing we will need is a class declaration:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">ParallelPageModel</span>&lt;<span class=\"title\">TPage</span>&gt;:  <span class=\"title\">DynamicObject</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>TPage allows us to specify the Interface the real Page Model implements.  Yes, we still need the interface, but we won’t need to create a new wrapper class for every page model we want to wrap.  The class  inherits from DynamicObject so that all of our on the fly goodness will work. Next, we’ll need some place to store an array of PageObjects we want to proxy.  So we add a private variable _page for that purpose.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> TPage[] _pages;</span><br></pre></td></tr></table></figure>\n\n<p>By using TPage[], we create a variable that is the same type array as the Page Models we are proxying. Next we need a constructor.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ParallelPageModel(<span class=\"keyword\">params</span> TPage[] pages)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    _pages = pages;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>By using the params keyword, we can either  pass in page objects as an array or as individual parameters. The magic happens in three overridden methods that are in DynamicObject:</p>\n<ul>\n<li>TryInvokeMember – resolves any method calls.</li>\n<li>TrySetMember – resolves any property setters</li>\n<li>TryGetMember – resolves any property getters</li>\n</ul>\n<p>So let’s add those methods next:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">override</span> <span class=\"built_in\">bool</span> <span class=\"title\">TryInvokeMember</span></span></span><br><span class=\"line\"><span class=\"function\">    (<span class=\"params\">InvokeMemberBinder binder,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">      <span class=\"built_in\">object</span>[] args,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">      <span class=\"keyword\">out</span> <span class=\"built_in\">object</span> result</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">override</span> <span class=\"built_in\">bool</span> <span class=\"title\">TrySetMember</span></span></span><br><span class=\"line\"><span class=\"function\">    (<span class=\"params\">SetMemberBinder binder, <span class=\"built_in\">object</span> <span class=\"keyword\">value</span></span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">override</span> <span class=\"built_in\">bool</span> <span class=\"title\">TryGetMember</span></span></span><br><span class=\"line\"><span class=\"function\">    (<span class=\"params\">GetMemberBinder binder, <span class=\"keyword\">out</span> <span class=\"built_in\">object</span> result</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"TryInvokeMember\"><a href=\"#TryInvokeMember\" class=\"headerlink\" title=\"TryInvokeMember\"></a>TryInvokeMember</h2><p>Inside of the TryInvokeMember method, the first thing we will want to do is to use reflection to call into the real methods.  Since we could have multiple instances of the same method we need to call we will want to do this in a loop. When I first worked this out, I started by just implementing a foreach loop but we are going to jump right to using Parallel.ForEach() Parallel.ForEach() will let us pass in an array and run a lambda expression on each element in the array.  So, our foreach loop will look like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> results = <span class=\"keyword\">new</span> ConcurrentBag&lt;<span class=\"built_in\">object</span>&gt;();</span><br><span class=\"line\">Parallel.ForEach(_pages, page =&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> thisResult = <span class=\"keyword\">typeof</span> (TPage)</span><br><span class=\"line\">       .InvokeMember(binder.Name,</span><br><span class=\"line\">        BindingFlags.InvokeMethod |</span><br><span class=\"line\">        BindingFlags.Public |</span><br><span class=\"line\">        BindingFlags.Instance,</span><br><span class=\"line\">        <span class=\"literal\">null</span>, page, args);</span><br><span class=\"line\">    results.Add(thisResult);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>Note that our lambda expression is not doing anything more than a simple reflection call. The result that is returned is added to our ConcurrentBag collection.  ConcurrentBag is a collection that is specifically made for parallel calls.  We could get into trouble if we added something to a List&lt;&gt; collection unless we added some parallelization gatekeeping around it.  I’m for doing as little work as possible. The second thing we want to do is to process the return results. For this we need to setup a basic foreach loop.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> thisResult <span class=\"keyword\">in</span> results)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Inside the foreach loop we will process the results collection. If the type that got  returned is the same type as the type that the page is proxying for, we just make our result value, the return value the TryInvokeMember is going to return for us to the code that called the proxy, equal to the proxy object.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (thisResult <span class=\"keyword\">is</span> TPage)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    result = <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>If the result is not null, meaning either that a previous result was null or we haven’t processed the loop yet, we want to check to see if the value of the current loop result is the same as the loop results we’ve already processed.  If it isn’t, we throw an exception.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (result != <span class=\"literal\">null</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!result.Equals(thisResult)) <span class=\"comment\">// not the same value</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Exception</span><br><span class=\"line\">           (<span class=\"string\">&quot;Call to method returns different values.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Finally, we just set the result to whatever we have at this point.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    result = thisResult;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>And then the last thing we want to do is to return true to tell the system we were able to process the method.</p>\n<h2 id=\"TryGetMember\"><a href=\"#TryGetMember\" class=\"headerlink\" title=\"TryGetMember\"></a>TryGetMember</h2><p>Since the implementation for TryGetMember looks very similar to TryInvokeMethod we’ll tackle that next. In fact, the only difference between the two methods is the code inside of the Parallel.ForEach parameter block. So, here it is:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Parallel.ForEach(_pages, page =&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> thisResult = <span class=\"keyword\">typeof</span>(TPage)</span><br><span class=\"line\">        .GetProperty(binder.Name).GetValue(page);</span><br><span class=\"line\">    results.Add(thisResult);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"TrySetMember\"><a href=\"#TrySetMember\" class=\"headerlink\" title=\"TrySetMember\"></a>TrySetMember</h2><p>TrySetMember is the easiest implementation of all since there are no results to worry about.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Parallel.ForEach(_pages,</span><br><span class=\"line\">     page =&gt; <span class=\"keyword\">typeof</span> (TPage)</span><br><span class=\"line\">        .GetProperty(binder.Name).SetValue(page, <span class=\"keyword\">value</span>));</span><br><span class=\"line\"><span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Casting\"><a href=\"#Casting\" class=\"headerlink\" title=\"Casting\"></a>Casting</h2><p>So the code above will work, but you won’t get any intellisense help from Visual Studio if you use this code without tweaking it. What we need is some way of casting the ParallelPageModel object to the TPage type that we pass in. For that we are going to use a cool library I found called <a href=\"//github.com/ekonbenefits/impromptu-interface\">ImpromptuInterface</a>. You’ll need to add a using statement.</p>\n<p>using ImpromptuInterface;</p>\n<p>And then you’ll need to add this method to the ParallelPageModel class.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> TPage <span class=\"title\">Cast</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.ActLike();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>You would use this like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IMyPageModel p = pageModelProxy.Cast();</span><br></pre></td></tr></table></figure>\n\n<p>Where IMyPageModel is the interface that specifies what your real PageModel class looks like. Just in case someone is tempted to mention this in the comments, you can’t us operator overloading to achieve the cast because we need it to return TPage, which could be anything and the compiler can’t deal with that.  If you really want to use operator overloading you’ll need to provide your own specific implementation that ends up calling the code above.</p>\n<h2 id=\"Calling-The-ParallelPageModel\"><a href=\"#Calling-The-ParallelPageModel\" class=\"headerlink\" title=\"Calling The ParallelPageModel\"></a>Calling The ParallelPageModel</h2><p>To setup the ParallelPageModel, your code would look something like this, assuming that you have a page model class called MyPageModel with an interface of IMyPageModel.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> pages = <span class=\"keyword\">new</span> ConcurrentStack&lt;IMyPageModel&gt;();</span><br><span class=\"line\">Parallel.Invoke(</span><br><span class=\"line\">    () =&gt;</span><br><span class=\"line\">        pages.Push(PageFactory.GetPageModel(<span class=\"string\">&quot;FireFoxGrid&quot;</span>),</span><br><span class=\"line\">    () =&gt;</span><br><span class=\"line\">        pages.Push(PageFactory.GetPageModel(<span class=\"string\">&quot;IE11Grid&quot;</span>));</span><br><span class=\"line\"><span class=\"keyword\">var</span> pagesArray = pages.ToArray();</span><br><span class=\"line\">MyTypedPage =</span><br><span class=\"line\">    <span class=\"keyword\">new</span> ParallelPageModel&lt;IMyPageModel&gt;(pagesArray).Cast();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Considerations\"><a href=\"#Considerations\" class=\"headerlink\" title=\"Considerations\"></a>Considerations</h2><p>I only just started using this.  It works for my current implementation.  But you may need to tweak it so that it works for you. For example, my assumption here is that you are only dealing with simple types or the page model type you are a proxy for.  There is no code here that will handle a situation where the call to a method would return a entirely new page model. Since the code I am testing is a collection of Single Page Applications and I am not testing navigation at this point, this is not a consideration for me.  But it would be relatively easy code to implement.  If I did that, I would probably handle it but subclassing this main class that does the bulk of the work and override the Try*Member method that needed to deal with that situation.  The other possible way of dealing with the situation is to pass in a list of types that need to be wrapped in their own parallelization object as parameters in the constructor and add some generic code in the ParallelPageModel class. Finally, I am well aware that this code may have bugs.  If you find one, go ahead and fix it. You can leave a comment so that others will benefit.   There is a <a href=\"//github.com/DaveMBush/ParallelSeleniumUsingNUnit\">demo project on GitHub.</a></p>\n<h4 id=\"Other-Places-Talking-about-Parallel-Selenium\"><a href=\"#Other-Places-Talking-about-Parallel-Selenium\" class=\"headerlink\" title=\"Other Places Talking about Parallel Selenium\"></a>Other Places Talking about Parallel Selenium</h4><ul>\n<li><a href=\"//slmoloch.blogspot.com/2009/12/design-of-selenium-tests-for-aspnet_19.html\">Using MbUnit to achieve parallelization</a></li>\n<li><a href=\"//www.browserstack.com/automate/c-sharp\">Use Browser Stack</a></li>\n</ul>\n<p>And of course a ton of links to people asking how this can be achieved.</p>\n",
            "tags": [
                "c#",
                "testing",
                ".net",
                "nunit",
                "parallel",
                "selenium"
            ]
        },
        {
            "id": "http://davembush.github.com/why-get-certified/",
            "url": "http://davembush.github.com/why-get-certified/",
            "title": "Why Get Certified?",
            "date_published": "2014-07-24T17:00:00.000Z",
            "content_html": "<p>Last week I mentioned that I’m working toward getting my MCSD certification.  Several weeks ago I received my <a href=\"//www.scrumalliance.org/community/profile/dbush2\">ScrumMaster Certification</a>.  This raises the question, “Why get certified at all?” What follows is a list of reasons why I am perusing certification.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"I-don’t-know-what-I-don’t-know\"><a href=\"#I-don’t-know-what-I-don’t-know\" class=\"headerlink\" title=\"I don’t know what I don’t know\"></a>I don’t know what I don’t know</h2><p>I know what I know.  And I can figure stuff out pretty fast when I need to know it.  So working without certification has been working for me for a pretty long time.  However, while I was studying for my ScrumMaster Certification, I realized that while I had most of the concepts right, there where a few holes in my thinking.  Studying for the ScrumMaster certification filled in those holes.</p>\n<h2 id=\"Authority\"><a href=\"#Authority\" class=\"headerlink\" title=\"Authority\"></a>Authority</h2><p>The reason I went after ScrumMaster certification was because everywhere I go, everyone has  their own definition of what Scrum looks like.  Most of them only know about Scrum from what they’ve heard about it from very informal sources. Only one that I know of is certified. But when I was talking about Scrum or Agile, it was my opinion against someone else’s opinion.  While I was sure I was right, if I were honest about it I had no more reason to believe I was right than anyone else. Now, with the certification, I have someone else saying I know what I’m talking about.  And since I got 100% of the 30, rather difficult, questions right, I have a higher confidence that my understanding of the subject is correct.</p>\n<h2 id=\"Fear\"><a href=\"#Fear\" class=\"headerlink\" title=\"Fear\"></a>Fear</h2><p>After I passed the test for the ScrumMaster certification, I realized that I am afraid of tests.  I used to say that all a certification did was show that you could pass a test.  But I’ve realized recently that that may have just been a cover because I didn’t want to take the test and fail. So, the reason I’m going after my MCSD is because I’m afraid of the test.  So, I fail.  So what?  At least in the process of studying for the test I’ll learn a few things.  The worse thing that can happen is that I don’t get the certification.  Ironically, from that point of view, not trying to get certified puts me in the same, if not worse, situation.  Not studying means no certification AND I haven’t learned anything in the process of studying for the exams.</p>\n<h2 id=\"Birds-of-a-feather\"><a href=\"#Birds-of-a-feather\" class=\"headerlink\" title=\"Birds of a feather\"></a>Birds of a feather</h2><p>I find it interesting that I personally only know one person who has their  MCSD.  Could that be because I don’t have MY MCSD?  Could it be that the organizations where all of the people who have their MCSD only hire people who have their MCSD?  I know several really good programmers.  Only one has their MCSD.  The others could get it if they wanted to.  But are they stuck in their current position because they aren’t certified?  It’s worth finding out.</p>\n<h2 id=\"The-test-isn’t-a-joke-anymore\"><a href=\"#The-test-isn’t-a-joke-anymore\" class=\"headerlink\" title=\"The test isn’t a joke anymore\"></a>The test isn’t a joke anymore</h2><p>For the longest time, my attitude about the test, as I mentioned above, was that it only showed that you could pass the test.  It didn’t really say you knew how to program or that you knew how to use the APIs.  I’m not the only one who felt this way.  Do a search online and you’ll find statements from years ago that say as much. While I’m sure it might be possible to pass the exams and still know nothing about how to program or how to use the APIs, it does seems that Microsoft is doing a much better job at ensuring that people who pass this certification can actually do the work as well.</p>\n<h4 id=\"Other-places-talking-about-the-MCSD\"><a href=\"#Other-places-talking-about-the-MCSD\" class=\"headerlink\" title=\"Other places talking about the MCSD\"></a>Other places talking about the MCSD</h4><ul>\n<li><a href=\"/pluralsightMCSDpath\" title=\"MCSD Learning Path\">PluralSight Learning Path for MCSD</a></li>\n</ul>\n",
            "tags": [
                "c#",
                "certification",
                "mcsd",
                "microsoft"
            ]
        },
        {
            "id": "http://davembush.github.com/csharp-idisposable-confusion/",
            "url": "http://davembush.github.com/csharp-idisposable-confusion/",
            "title": "CSharp IDisposable Confusion",
            "date_published": "2014-07-17T17:00:00.000Z",
            "content_html": "<p>I’m planning to get my MCSD certification next and the first exam I plan to take is the 70-483 which will test my knowledge of CSharp. To study, I got this free PDF: <a href=\"//www.it-ebooks.info/book/2564/\">MCSD Certification Toolkit (Exam 70-483)</a> (Which I wouldn’t recommend, but I haven’t found anything yet that I WOULD recommend, so this will have to do.) In this book (Chapter 5) and other places on the web, it makes this statement:</p>\n<span id=\"more\"></span>\n\n<ul>\n<li>If a class contains no managed resources and no unmanaged resources, it doesn’t need to implement IDisposable or have a destructor.</li>\n<li>If the class has only managed resources, it should implement IDisposable but it doesn’t need a destructor. (When the destructor executes, you can’t be sure managed objects still exist, so you can’t call their Dispose methods anyway.)</li>\n<li>If the class has only unmanaged resources, it needs to implement IDisposable and needs a destructor in case the program doesn’t call Dispose.</li>\n<li>The Dispose method must be safe to run more than once.  You can achieve that by using a variable to keep track of whether it has been run before.</li>\n<li>The Dispose method should free both managed and unmanaged resources.</li>\n<li>The destructor should free only unmanaged resources.  (When the destructor executes, you can’t be sure managed objects still exist, so you can’t call their Dispose methods anyway.)</li>\n<li>After freeing resources, the destructor should call GC.SuppressFinalize, so the object can skip the finalization queue.</li>\n</ul>\n<h2 id=\"Managed-VS-Unmanaged\"><a href=\"#Managed-VS-Unmanaged\" class=\"headerlink\" title=\"Managed VS Unmanaged?\"></a>Managed VS Unmanaged?</h2><p>So what is the difference between a managed resource and an unmanaged resource?  An unmanaged resource is something that is not under the direct control of the .NET memory manager.  So, file handles, connections to the database, memory handles, and other OS items fall under the realm of “unmanaged.”  Managed code is everything else. So, if you read the points above and read the statements about managed resources, you would think, or should think, “That’s already under the control of the .NET memory manager, so I shouldn’t have to do ANYTHING!” But with one little tweak, this all becomes clear.  What this block of text is talking about specifically is managed code that is referencing other code that implements IDisposable.</p>\n<h2 id=\"Corrected-Version\"><a href=\"#Corrected-Version\" class=\"headerlink\" title=\"Corrected Version\"></a>Corrected Version</h2><p>So, let’s rephrase the block of text to the following:</p>\n<ul>\n<li>If a class contains no managed resources that implement IDisposable and no unmanaged resources, it doesn’t need to implement IDisposable or have a destructor.</li>\n<li>If the class has only managed resources that reference resources that implement IDisposable, it should implement IDisposable but it doesn’t need a destructor. (When the destructor executes, you can’t be sure managed objects still exist, so you can’t call their Dispose methods anyway.)</li>\n<li>If the class has only unmanaged resources, it needs to implement IDisposable and needs a destructor in case the program doesn’t call Dispose.</li>\n<li>The Dispose method must be safe to run more than once.  You can achieve that by using a variable to keep track of whether it has been run before.</li>\n<li>The Dispose method should free both managed resources that implement IDisposable and unmanaged resources.</li>\n<li>The destructor should free only unmanaged resources.  (When the destructor executes, you can’t be sure managed objects still exist, so you can’t call their Dispose methods anyway.)</li>\n<li>After freeing resources, the destructor should call GC.SuppressFinalize, so the object can skip the finalization queue.</li>\n</ul>\n<h2 id=\"One-Other-Circumstance\"><a href=\"#One-Other-Circumstance\" class=\"headerlink\" title=\"One Other Circumstance\"></a>One Other Circumstance</h2><p>There is one other situation where you might want to implement IDisposable on a class that doesn’t reference an object that implements IDisposable.  While this particular case is rare, I think it is probably good to list it here for completeness. If you have a class that will consume a lot of memory either directly or indirectly, you might want to consider implementing IDisposable and the Dispose method so that any class that is calling this method has a way of immediately releasing the memory the class is using by dereferencing the memory it is using, and then calling:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GC.Collect();</span><br><span class=\"line\">GC.WaitForPendingFinalizers();</span><br><span class=\"line\">GC.Collect();</span><br></pre></td></tr></table></figure>\n\n<p>I can already hear some of you saying, “but you shouldn’t have to ever need to do this!” And yes, 99% of the time, you shouldn’t.  But, if you have an issue with this, talk to <a href=\"//www.microsoftvirtualacademy.com/training-courses/developer-training-with-programming-in-c\">the guys over at the Microsoft Virtual Academy</a> where I learned this.</p>\n<h4 id=\"Other-Places-Talking-About-IDisposable-and-NET-Memory-Management\"><a href=\"#Other-Places-Talking-About-IDisposable-and-NET-Memory-Management\" class=\"headerlink\" title=\"Other Places Talking About IDisposable and .NET Memory Management\"></a>Other Places Talking About IDisposable and .NET Memory Management</h4><ul>\n<li><a href=\"//coding.abel.nu/2011/12/idisposable-and-using-in-c/\">IDisposable and Using in C#</a></li>\n<li><a href=\"//manski.net/2012/01/idisposable-finalizer-and-suppressfinalize/\">IDisposable, Finalizer, and SuppressFinalize in C# and C++</a></li>\n<li><a href=\"//manski.net/2012/01/idisposable-finalizer-and-suppressfinalize/\">Common Pitfalls with IDisposable and Using</a></li>\n<li><a href=\"//www.technofranchise.com/c-memory-management/\">CSharp Memory Management</a></li>\n<li><a href=\"//www.go4expert.com/articles/disposal-garbage-collection-c-sharp-t30059/\">Disposal and Garbage Collection in CSharp</a></li>\n</ul>\n",
            "tags": [
                "c#",
                "idisposable"
            ]
        },
        {
            "id": "http://davembush.github.com/csharp-numeric-overflows/",
            "url": "http://davembush.github.com/csharp-numeric-overflows/",
            "title": "CSharp Numeric Overflows",
            "date_published": "2014-07-03T17:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2014/06/NumericOverflow.png\" alt=\"NumericOverflow\" title=\"NumericOverflow\">Did you know that when you are dealing with numbers, by default, .NET will do, or try to do exactly what you tell it to do?  If you tell it to do the impossible, it will do the next most logical thing.  It won’t throw any errors in the process.</p>\n<p>No, neither did I.  But then, most of the time I don’t write code where this would matter, and I bet you don’t either.</p>\n<p>So here are some examples.</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Integer-Types\"><a href=\"#Integer-Types\" class=\"headerlink\" title=\"Integer Types\"></a>Integer Types</h2><p>What happens if you write code that looks like this?</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">long</span> l = <span class=\"built_in\">long</span>.MaxValue;</span><br><span class=\"line\"><span class=\"built_in\">int</span> i;</span><br><span class=\"line\">i = (<span class=\"built_in\">int</span>) l;</span><br></pre></td></tr></table></figure>\n\n<p>Well, if we are working with the compiler set with default settings, you’ll end up with the variable l having the value of 9223372036854775807 and the value of i having the value of -1.</p>\n<p>Why is this?  Because, by default, .NET does not check for numeric overflow.</p>\n<p>However, if you wanted to add the ability to check for numeric overflow, you would wrap this code in a checked block.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    checked</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">long</span> l = <span class=\"built_in\">long</span>.MaxValue;</span><br><span class=\"line\">        <span class=\"built_in\">int</span> i;</span><br><span class=\"line\">        i = (<span class=\"built_in\">int</span>)l;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// handle overflow exception here</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>You can force all of your code to be checked by changing your compiler settings.  In Visual Studio 2013, go to Project Properties –&gt; Build.  Click the “Advanced” button (bottom right corner) and then check the “Check for … overflow” checkbox.</p>\n<p>Once you’ve done that, all of your code will be checked by default.  If you don’t want to check for overflows while you are working on a block of code, for performance reasons, wrap the code in an unchecked block instead.</p>\n<h2 id=\"Float-to-Int\"><a href=\"#Float-to-Int\" class=\"headerlink\" title=\"Float to Int\"></a>Float to Int</h2><p>Now, what about putting a floating point number in an integer?</p>\n<p>Let’s say that instead of a long, we use a float.</p>\n<p>First, let’s look at a simple case:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">float</span> l = <span class=\"number\">3.563f</span>;</span><br><span class=\"line\"><span class=\"built_in\">int</span> i;</span><br><span class=\"line\">i = (<span class=\"built_in\">int</span>) lf</span><br></pre></td></tr></table></figure>\n\n<p>In this case, you’ll end up with f holding a floating point number of 3.563 and i holding an integer of 3.  The rule is pretty simple, floats always have the decimal portion stripped off and assigned to the integer, short, or long.</p>\n<h2 id=\"Large-Float-to-Int\"><a href=\"#Large-Float-to-Int\" class=\"headerlink\" title=\"Large Float to Int\"></a>Large Float to Int</h2><p>But what happens if we use float.MaxValue?</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">float</span> f = <span class=\"built_in\">float</span>.MaxValue;</span><br><span class=\"line\"><span class=\"built_in\">int</span> i;</span><br><span class=\"line\">i = (<span class=\"built_in\">int</span>) f;</span><br></pre></td></tr></table></figure>\n\n<p>In this case, what you’ll end up with is a very large floating point number and an integer of -2147483648.  Basically it does it’s best to convert a really large integer number into the int and just uses what it can.  Not really what you probably have in mind.</p>\n<p>The solution is the same.  Use a checked block or compile with checked turned on.</p>\n<h2 id=\"Double-to-Float\"><a href=\"#Double-to-Float\" class=\"headerlink\" title=\"Double to Float\"></a>Double to Float</h2><p>Now, you would expect that if I had a really large double and tried to assign that to a float, something similar would happen. </p>\n<p>You’d be right, kind of.</p>\n<p>If you assign a double that is too large for a float to a float variable, the float variable will end up with infinity.  But, unlike the shorts, ints, and longs, you can’t wrap the code in a checked block to cause it to throw an exception.  No.  In this case you must always check for infinity once you’ve done the assignment.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">double</span> d = <span class=\"built_in\">double</span>.MaxValue;</span><br><span class=\"line\"><span class=\"built_in\">float</span> f;</span><br><span class=\"line\">f = (<span class=\"built_in\">float</span>)d;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"built_in\">float</span>.IsInfinity(f))</span><br><span class=\"line\">    <span class=\"comment\">// do something intelligent here</span></span><br></pre></td></tr></table></figure>\n\n<p>So there you have it.  This is how you really deal with numeric casting in your CSharp code.</p>\n",
            "tags": [
                "c#",
                "checked",
                "double",
                "float",
                "int",
                "long",
                "short",
                "unchecked"
            ]
        },
        {
            "id": "http://davembush.github.com/selenium-with-nunit-presentation/",
            "url": "http://davembush.github.com/selenium-with-nunit-presentation/",
            "title": "Selenium with NUnit Presentation",
            "date_published": "2014-02-17T23:00:00.000Z",
            "content_html": "<p><img src=\"/uploads/2014/01/Selenium.png\"></p>\n<p>On Monday 2&#x2F;17&#x2F;14 I gave a presentation at the CT .NET User’s Group on using Selenium and NUnit to test your web application.  The following is a list of resources from that presentation:</p>\n<ul>\n<li><a href=\"/uploads/2014/02/SeleniumDemoTest.zip\">The demo code</a>.</li>\n<li><a href=\"//docs.seleniumhq.org/download/\">The Selenium IDE Plugin for FireFox and the IE Driver Server</a></li>\n<li><a href=\"//www.nunit.org/\">NUnit</a> </li>\n<li><a href=\"//selenium.googlecode.com/git/docs/api/dotnet/index.html\">Selenium CSharp API Documentation</a></li>\n<li><a href=\"//docs.seleniumhq.org/docs/\">Selenium Users Manual</a></li>\n</ul>\n",
            "tags": [
                "c#",
                "nunit",
                "selenium"
            ]
        },
        {
            "id": "http://davembush.github.com/dispose-finalize-and-suppressfinalize/",
            "url": "http://davembush.github.com/dispose-finalize-and-suppressfinalize/",
            "title": "Dispose, Finalize and SuppressFinalize",
            "date_published": "2013-06-12T08:04:38.000Z",
            "content_html": "<p><img src=\"/uploads/2009/07/fooddrk017.jpg\" alt=\"food-drk-017\" title=\"food-drk-017\"> I got the following question recently.</p>\n<blockquote>\n<p>What is the difference between Dispose and SupressFinalize in garbage collection?”</p>\n</blockquote>\n<p>The problem with this question is it assumes Dispose and SupressFinalize have similarities, which I’m sure is not what is being asked here.  So let’s rephrase it in terms that make sense.</p>\n<blockquote>\n<p>I see three methods available to me in .NET that all seem to have something to do with garbage collection.  Can you explain what Dispose, Finalize, and SupressFinalize do and why I could use or call each one in my code?”</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<p>Now, that’s something we can answer.</p>\n<h2 id=\"A-Brief-History-of-Memory-Management\"><a href=\"#A-Brief-History-of-Memory-Management\" class=\"headerlink\" title=\"A Brief History of Memory Management\"></a>A Brief History of Memory Management</h2><p>Before we answer the question, we need to review how memory management works in .NET compared to historical languages such as C&#x2F;C++.</p>\n<p>In the old days, if an application allocated memory on the heap (generally done with the “new” keyword in CSharp) the application was also responsible for releasing the memory.  In languages such as C++, this was done with the “delete” keyword which triggered a call to a special method called a destructor.  If the object was holding on to memory or other resources, it was the destructor’s job to release those resources.</p>\n<p>In .NET memory is deallocated for us using garbage collection.  We no longer call the destructor using anything like a delete keyword and the deallocation process happens at some point in time that is after the memory goes out of scope.  This might be immediately after the object goes out of scope or it could be hours or days.</p>\n<p>Generally, this is not a problem, but what about an object that is holding on to additional resources that need to be freed up right away? For that we have the Dispose() method.</p>\n<h2 id=\"Dispose-is-the-new-destructor\"><a href=\"#Dispose-is-the-new-destructor\" class=\"headerlink\" title=\"Dispose is the new destructor\"></a>Dispose is the new destructor</h2><p>While we don’t need a destructor to handle our memory, we do need something to release resources.</p>\n<p>This is why the IDisposable interface was created with one method that needs to be implemented called Dispose().</p>\n<p>If your class allocates resources that need to be freed up that aren’t memory, you should implement the IDisposable interface on that class and implement the Dispose() method.  Inside that method, you would release any resources that the class may have created and not freed.</p>\n<h2 id=\"Dispose-will-then-automatically-get-called-by-Finalize\"><a href=\"#Dispose-will-then-automatically-get-called-by-Finalize\" class=\"headerlink\" title=\"Dispose() will then automatically get called by Finalize()\"></a>Dispose() will then automatically get called by Finalize()</h2><p>When the garbage collector starts releasing memory, one of the things it will do is that it will go through your code and call Finalize() on each of the objects.  Finalize() will then call any dispose methods that are available.</p>\n<p>This is done to protect the programmer from himself, not because it is expected.  Remember I said the memory will get freed up at some indeterminate point in the future but the Dispose() method was created so we could free up the resources right away? What we really want to do is call Dispose() ourselves.  We call Dispose from our own code.  Finalize() only exists so that Dispose() will get called if we don’t.</p>\n<h2 id=\"And-that’s-where-SupressFinalize-fits-in\"><a href=\"#And-that’s-where-SupressFinalize-fits-in\" class=\"headerlink\" title=\"And that’s where SupressFinalize() fits in.\"></a>And that’s where SupressFinalize() fits in.</h2><p>If my code calls Dispose() then there is no reason for the Finalizer to run at all.  Without SupressFinalize() we would need to set a flag in our class indicating that Dispose() had already been called so that when Finalize() called it, we didn’t re-run the clean up code.</p>\n<p>With SupressFinalize() we can just call SuppressFinalize() from within Dispose() and that will tell .NET to not run the Finalize method when it gets to our object.</p>\n<p>Your call to SupressFinalize() should almost always look like</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GC.SuppressFinalize(<span class=\"keyword\">this</span>);</span><br></pre></td></tr></table></figure>\n\n<p>but you can pass in any object instead of “this.”</p>\n",
            "tags": [
                "c#",
                "idisposable",
                "dispose",
                "finalize",
                "suppressfinalize"
            ]
        },
        {
            "id": "http://davembush.github.com/test-sending-email-without-a-server-in-asp-net/",
            "url": "http://davembush.github.com/test-sending-email-without-a-server-in-asp-net/",
            "title": "Test Sending Email without a Server in ASP.NET",
            "date_published": "2013-06-05T07:36:19.000Z",
            "content_html": "<p><img src=\"/uploads/2009/08/back041.jpg\" alt=\"back-041\" title=\"back-041\"> By now, most people are familiar with the fact that ASP.NET will send mail from the codebehind by simply adding a few lines to your web.config file and adding another few lines of code in the codebehind file.</p>\n<p>But it wasn’t until recently that I found that you don’t need to have access to an SMTP server to test your code.</p>\n<span id=\"more\"></span>\n\n<p>In fact, this little trick will allow you to read the email without clogging up your email client with email you only wanted for testing purposes.</p>\n<p>Instead of the normal entry of</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mailSettings</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">smtp</span> <span class=\"attr\">from</span>=<span class=\"string\">&quot;you@domain.com&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">network</span> <span class=\"attr\">host</span>=<span class=\"string\">&quot;maiServerl&quot;</span> <span class=\"attr\">password</span>=<span class=\"string\">&quot;password&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">           <span class=\"attr\">userName</span>=<span class=\"string\">&quot;loginName&quot;</span> <span class=\"attr\">port</span>=<span class=\"string\">&quot;25&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">smtp</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mailSettings</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>You can use</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mailSettings</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">smtp</span> <span class=\"attr\">from</span>=<span class=\"string\">&quot;you@domain.com&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">deliveryMethod</span>=<span class=\"string\">&quot;SpecifiedPickupDirectory&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">specifiedPickupDirectory</span></span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">pickupDirectoryLocation</span>=<span class=\"string\">&quot;c:\\\\mail&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">smtp</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mailSettings</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>This will drop your email message in the c:\\mail directory as an *.eml file which you can open with Outlook Express.</p>\n<p>The code you would write to send the mail is still the same:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SmtpClient smtp = <span class=\"keyword\">new</span> SmtpClient();</span><br><span class=\"line\">MailAddress <span class=\"keyword\">from</span> = <span class=\"keyword\">new</span> MailAddress(fromEmail, fromEmail);</span><br><span class=\"line\">MailAddress to = <span class=\"keyword\">new</span> MailAddress(emailAddress, emailAddress);</span><br><span class=\"line\">MailMessage message = <span class=\"keyword\">new</span> MailMessage(<span class=\"keyword\">from</span>, to);</span><br><span class=\"line\">message.Subject = SubjectLine;</span><br><span class=\"line\">message.Body = htmlString;</span><br><span class=\"line\">message.From = <span class=\"keyword\">from</span>;</span><br><span class=\"line\">message.To.Add(to);</span><br><span class=\"line\">message.IsBodyHtml = <span class=\"literal\">true</span>;</span><br><span class=\"line\">smtp.Send(message);</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "c#",
                "testing",
                "vb.net",
                "asp.net",
                "email",
                "mailaddress",
                "mailmessage",
                "smtpclient"
            ]
        },
        {
            "id": "http://davembush.github.com/determine-the-role-of-a-user-in-asp-net/",
            "url": "http://davembush.github.com/determine-the-role-of-a-user-in-asp-net/",
            "title": "Determine The Role of a User in ASP.NET",
            "date_published": "2009-10-13T10:46:21.000Z",
            "content_html": "<p><img src=\"/uploads/2009/10/winter016.jpg\" alt=\"winter-016\" title=\"winter-016\"></p>\n<p>There are several controls that allow you to display content based on the role a user is in, including:</p>\n<ul>\n<li>LoginView</li>\n<li>LoginStatus</li>\n</ul>\n<p>And the web.config file allows us to control which pages can be viewed based on which role a user is in.</p>\n<p>But what if you need to determine the role a user is in using the APIs? How do you do that?</p>\n<span id=\"more\"></span>\n\n<p>It turns out that the API for this is really rather straightforward.</p>\n<p>If you are in an ASPX or ASCX file, you can use</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(User.IsInRole(<span class=\"string\">&quot;roleNameHere&quot;</span>))</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">// do something here</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>If you are in other code where the User property is not available, you’ll need to use the HttpContext class like we’ve used previously this week to get access to the current context.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(HttpContext.Current.User.IsInRole(<span class=\"string\">&quot;roleName&quot;</span>))</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">// do something here</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "c#",
                "asp.net",
                "authentication",
                "isinrole",
                "roles",
                "user"
            ]
        },
        {
            "id": "http://davembush.github.com/setting-up-your-forms-based-authentication-database/",
            "url": "http://davembush.github.com/setting-up-your-forms-based-authentication-database/",
            "title": "Setting Up Your Forms Based Authentication Database",
            "date_published": "2009-09-14T09:41:24.000Z",
            "content_html": "<p><img src=\"/uploads/2009/09/B01I0003.jpg\" alt=\"B01I0003\" title=\"B01I0003\"></p>\n<p>I was recently asked if I would cover some topics related to Forms Based Authentication.  The person who requested this information has some specific issues that he wants covered that I won’t be covering for a while because I think there are some other issues that need to be covered first.</p>\n<p>One of those is setting up the database.</p>\n<span id=\"more\"></span>\n\n<p>When I owned my hosting companies, I saw more confusion in this area than just about any other topic that came up.</p>\n<p>So here’s the step-by-step process you need to go through to set up your database for Forms Based Authentication.</p>\n<p>In your hosting company’s control panel, create the SQL database.  You’ll want to create a database with a size of at least 10 meg with 5 meg allocated to the log file and 5 meg allocated to the database.  You’ll also want to make sure the user you attach to the database has DBO rights.  You may need to contact support to enable this.</p>\n<p>Next, you’ll want to run aspnet_regsql.exe which you can find under c:\\windows\\Microsoft.NET\\Framework\\v2.0.50727.  This will provide you a wizard interface and will ultimately create the appropriate tables for you. The wizard is self explanatory, so I won’t repeat it here except to say that you’ll want to enter your connection information to connect to the server you just created your database on, not one of your databases locally.</p>\n<p>Next you’ll need to add the connection information to your web.config file for the application you are setting up Forms Based Authentication for.</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">connectionStrings</span>&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">remove</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;LocalSqlServer&quot;</span>/&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">add</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;LocalSqlServer&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">connectionString</span>=<span class=\"string\">&quot;Data Source=sqlserverGoesHere;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    Initial Catalog=YourDatabaseName;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    Persist Security Info=True;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    User ID=YourSqlUserID;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    password=YourSqlPassword&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">providerName</span>=<span class=\"string\">&quot;System.Data.SqlClient&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">connectionStrings</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>The “remove” element is needed because typically the machine.config file on the server has its own entry that you won’t be using.</p>\n<p>Unfortunately, you’ll need to create your own UI for adding users and assigning them to roles.  It isn’t that hard to do and once you’ve done it you can move the administration controls from project to project.  If I were you, I’d create the control set once in a special sub-directory so that I could move it from project to project.</p>\n",
            "tags": [
                "c#",
                "asp.net",
                "aspnet_regsql",
                "forms based authentication"
            ]
        },
        {
            "id": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-%E2%80%93-finishing-up/",
            "url": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-%E2%80%93-finishing-up/",
            "title": "iTextSharp – HTML to PDF – Finishing Up",
            "date_published": "2009-08-12T10:19:24.000Z",
            "content_html": "<p><img src=\"/uploads/2009/08/tiger.jpg\" alt=\"tiger\" title=\"tiger\"> In the last post I mentioned there were a few topics we need to close up today.  The two topics we’ve left undone are popping the attribute information off the stack when we hit a closing element and dealing with the paragraph gap that normally appears between paragraph elements.</p>\n<p>The first thing you’ll want to do when you hit a closing element is to retrieve its name again.  Just like we did at the beginning element.  Once you have that you can pop the attribute information off the stack(s).</p>\n<p>You’ll also want to undo any indentation that you applied during the opening element.</p>\n<p>To handle the paragraph break, I defined a _crlfAtEnd attribute in my resource file.  If it was defined as true, I added an extra line feed at the end to account for the gap.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">isBlock = Resources.html2pdf</span><br><span class=\"line\">  .ResourceManager</span><br><span class=\"line\">  .GetString(tagName + <span class=\"string\">&quot;_isBlock&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (isBlock != <span class=\"literal\">null</span> &amp;&amp;</span><br><span class=\"line\">  isBlock.ToLower() == <span class=\"string\">&quot;true&quot;</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  isBlock = Resources.html2pdf</span><br><span class=\"line\">    .ResourceManager</span><br><span class=\"line\">    .GetString(tagName + <span class=\"string\">&quot;_crlfAtEnd&quot;</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (isBlock != <span class=\"literal\">null</span> &amp;&amp;</span><br><span class=\"line\">    isBlock.ToLower() == <span class=\"string\">&quot;true&quot;</span>)</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    et = stack.Peek();</span><br><span class=\"line\">    Font f = getCurrentFont();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (et <span class=\"keyword\">is</span> Phrase)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      ((Phrase)(et)).Add(</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Chunk(<span class=\"string\">&quot;\\n&quot;</span>, f));</span><br><span class=\"line\">      stack.Pop();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  p = <span class=\"keyword\">new</span> Paragraph();</span><br><span class=\"line\">  ((Paragraph)p).Add(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">  ((Paragraph)p).SetLeading(m_leading, <span class=\"number\">1</span>);</span><br><span class=\"line\">  list.Add(p);</span><br><span class=\"line\">  stack.Push(p);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>One problem I’ve had with this in the past is that this cr&#x2F;lf gets added at the end even if the block is the last block.  I really need to find some way to detect that this is the last place this occurs either nested or in the outermost block.  But I’ll leave that enhancement for you.</p>\n",
            "tags": [
                "c#",
                ".net",
                "html",
                "iTextSharp",
                "PDF"
            ]
        },
        {
            "id": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-%E2%80%93-writing-the-pdf/",
            "url": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-%E2%80%93-writing-the-pdf/",
            "title": "iTextSharp – HTML to PDF – Writing the PDF",
            "date_published": "2009-08-04T10:24:18.000Z",
            "content_html": "<p><img src=\"/uploads/2009/08/B03B0085.jpg\" alt=\"B03B0085\" title=\"B03B0085\"></p>\n<p>Last week we parsed the HTML and created code that keeps track of the various attributes we are going to need when we create the PDF.  Today we will finish the code and create the Elements that we can include in our PDF document.</p>\n<p>One consideration we will need to keep in mind as we write out the PDF is that we have pushed various font characteristics that may overlap onto our stack.</p>\n<p>To get the current font, we will need to combine the attributes.  For example, HTML that looks like this:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">u</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">b</span>&gt;</span>this should be bold<span class=\"tag\">&lt;/<span class=\"name\">b</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">u</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>Should render as bold, italics, underlined text.  But we only pushed one element at a time, so if all we look at is the last element we pushed onto the stack, all we will get is a bold font.</p>\n<p>To help with this, I created a helper method that does all the work of determining the correct current font and returning that to the caller.</p>\n<p>The first part of the method does the bulk of the work.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">string</span>[] fontArray = fontCharacteristicStack.ToArray();</span><br><span class=\"line\"><span class=\"built_in\">int</span> fontIndex = <span class=\"number\">0</span>;</span><br><span class=\"line\">fontNormalBoldItalic nbi = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (; fontIndex &lt; fontArray.Length; fontIndex++)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (fontArray[fontIndex].ToLower())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;bold&quot;</span>:</span><br><span class=\"line\">            nbi |= fontNormalBoldItalic.Bold;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;italic&quot;</span>:</span><br><span class=\"line\">            nbi |= fontNormalBoldItalic.Italic;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;bolditalic&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;italicbold&quot;</span>:</span><br><span class=\"line\">            nbi |= fontNormalBoldItalic.BoldItalic;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;underline&quot;</span>:</span><br><span class=\"line\">            nbi |= fontNormalBoldItalic.Underline;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;boldunderline&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;underlinebold&quot;</span>:</span><br><span class=\"line\">            nbi |= fontNormalBoldItalic.UnderlineBold;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;italicunderline&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;underlineitalic&quot;</span>:</span><br><span class=\"line\">            nbi |= fontNormalBoldItalic.UnderlineItalic;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;underlinebolditalic&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;underlineitalicbold&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;boldunderlineitalic&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;bolditalicunderline&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;italicunderlinebold&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&quot;italicboldunderline&quot;</span>:</span><br><span class=\"line\">            nbi |= fontNormalBoldItalic.UnderlineBoldItalic;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>The fontNormalBoldItalic thing is an enumeration that I used to allow me to merge the font characteristics.</p>\n<p>The second half gets the remainder of the font information which can be determined from the current element and applies the characteristics we determined above into the font.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Font font = FontFactory.getFont(currentFontName);</span><br><span class=\"line\"><span class=\"built_in\">string</span> s = FontFactory.TIMES;</span><br><span class=\"line\"><span class=\"keyword\">switch</span> (nbi)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> fontNormalBoldItalic.Bold:</span><br><span class=\"line\">        font.setStyle(Font.BOLD);</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> fontNormalBoldItalic.Italic:</span><br><span class=\"line\">        font.setStyle(Font.ITALIC);</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> fontNormalBoldItalic.BoldItalic:</span><br><span class=\"line\">        font.setStyle(Font.BOLDITALIC);</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> fontNormalBoldItalic.Underline:</span><br><span class=\"line\">        font.setStyle(Font.UNDERLINE);</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> fontNormalBoldItalic.UnderlineBold:</span><br><span class=\"line\">        font.setStyle(Font.UNDERLINE | Font.BOLD);</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> fontNormalBoldItalic.UnderlineItalic:</span><br><span class=\"line\">        font.setStyle(Font.UNDERLINE | Font.ITALIC);</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> fontNormalBoldItalic.UnderlineBoldItalic:</span><br><span class=\"line\">        font.setStyle(Font.UNDERLINE | Font.BOLDITALIC);</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">font.setSize(currentFontSize);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (currentFontColor.StartsWith(<span class=\"string\">&quot;#&quot;</span>))</span><br><span class=\"line\">    font.setColor(System.Convert.ToInt32(currentFontColor.Substring(<span class=\"number\">1</span>, <span class=\"number\">2</span>), <span class=\"number\">16</span>),</span><br><span class=\"line\">        System.Convert.ToInt32(currentFontColor.Substring(<span class=\"number\">3</span>, <span class=\"number\">2</span>), <span class=\"number\">16</span>),</span><br><span class=\"line\">        System.Convert.ToInt32(currentFontColor.Substring(<span class=\"number\">5</span>, <span class=\"number\">2</span>), <span class=\"number\">16</span>));</span><br><span class=\"line\"><span class=\"keyword\">else</span> font.setColor(System.Drawing.Color.FromName(currentFontColor));</span><br><span class=\"line\"><span class=\"keyword\">return</span> font;</span><br></pre></td></tr></table></figure>\n\n<p>This is all called from our case statement when the element is text.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">case</span> XmlNodeType.Text:</span><br><span class=\"line\">    et = stack.Peek();</span><br><span class=\"line\">    Font font = getCurrentFont();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (et <span class=\"keyword\">is</span> Phrase)</span><br><span class=\"line\">        ((Phrase)(et)).<span class=\"keyword\">add</span>(</span><br><span class=\"line\">            <span class=\"keyword\">new</span> Chunk(reader.Value.</span><br><span class=\"line\">                Replace(<span class=\"string\">&quot; &amp;amp; &quot;</span>, <span class=\"string\">&quot; &amp; &quot;</span>).</span><br><span class=\"line\">                Replace(<span class=\"string\">&quot;&amp;nbsp;&quot;</span>,<span class=\"string\">&quot; &quot;</span>), font));</span><br><span class=\"line\">    <span class=\"keyword\">break</span>;</span><br></pre></td></tr></table></figure>\n\n<p>You’ll notice that I’ve also added code at this point that translates the ampersand and the none breaking space so they render correctly in the PDF document.</p>\n<p>Next time we address this topic we will try to close this all up with popping the attributes off the stack and dealing with the gaps between block elements that should (or should not) appear.</p>\n",
            "tags": [
                "c#",
                "html",
                "iTextSharp",
                "PDF",
                "fonts",
                "stack"
            ]
        },
        {
            "id": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-%E2%80%93-parsing-html/",
            "url": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-%E2%80%93-parsing-html/",
            "title": "iTextSharp – HTML to PDF – Parsing HTML",
            "date_published": "2009-07-28T11:03:54.000Z",
            "content_html": "<p><img src=\"/uploads/2009/07/iStock_000004663193Medium.jpg\" alt=\"iStock_000004663193Medium\" title=\"iStock_000004663193Medium\"></p>\n<p>Now that we have the HTML cleaned up, the next thing we will want to do is to parse the HTML.</p>\n<p>In my actual code for this, I parse the HTML and create the PDF at the same time, but for the purposes of these posts, I’m going to deal primarily with parsing the HTML here and then deal with the PDF creation code later.</p>\n<p>The key to parsing the HTML is that it is in XHTML form.  This allows us to use the XML APIs that are built into .NET.  For the purposes of parsing the HTML so that we can convert it to PDF code, we need to use the XMLTextReader.</p>\n<p>Every time you Read() an XMLTextReader object, you will either be on a beginning tag, an ending tag, or text.  So the core of our loop looks something like this</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">XmlTextReader reader =</span><br><span class=\"line\">    <span class=\"keyword\">new</span> XmlTextReader(xhtmlString,</span><br><span class=\"line\">        XmlNodeType.Element, <span class=\"literal\">null</span>);</span><br><span class=\"line\"><span class=\"keyword\">while</span> (reader.Read())</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (reader.NodeType)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> XmlNodeType.Element:</span><br><span class=\"line\">            <span class=\"comment\">// appropriate code break;</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> XmlNodeType.EndElement:</span><br><span class=\"line\">            <span class=\"comment\">// appropriate code break;</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> XmlNodeType.Text:</span><br><span class=\"line\">            <span class=\"comment\">// appropriate code break;</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> XmlNodeType.Whitespace:</span><br><span class=\"line\">            <span class=\"comment\">// appropriate code break;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>where xhtmlString is the cleaned up HTML code from last week.</p>\n<p>The core part of the translation is dependent on the fact that we have matching open and closing tags and that each time we hit an open tag, we can determine what the characteristics of that tag are.  Bold, underline, font, font size, etc.</p>\n<p>So each time we hit the open tag, we will look up the characteristics.  For simplicity, I put this information in a resource file so that I could just look it up using code that looks something like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fontName = Resources.html2pdf .ResourceManager</span><br><span class=\"line\">    .GetString(tagName + <span class=\"string\">&quot;_fontName&quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>rather than having another long case statement in my code.</p>\n<p>Once we have the information we want from the resource file, we place the current characteristics on a stack.  I created a different stack for each element, but in hindsight, it might have been better to create a structure with the information and use one stack of type in that structure.</p>\n<p>Here’s the code that does that</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (!reader.IsEmptyElement)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    fontName = Resources.html2pdf.</span><br><span class=\"line\">        ResourceManager.</span><br><span class=\"line\">        GetString(tagName + <span class=\"string\">&quot;_fontName&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fontName != <span class=\"literal\">null</span>)</span><br><span class=\"line\">        currentFontName = fontName;</span><br><span class=\"line\">    fontSize = Resources.html2pdf.</span><br><span class=\"line\">        ResourceManager.</span><br><span class=\"line\">        GetString(tagName + <span class=\"string\">&quot;_fontSize&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fontSize != <span class=\"literal\">null</span>)</span><br><span class=\"line\">        currentFontSize = System.</span><br><span class=\"line\">            Convert.ToSingle(fontSize);</span><br><span class=\"line\">    fontColor = Resources.html2pdf.</span><br><span class=\"line\">        ResourceManager.</span><br><span class=\"line\">        GetString(tagName + <span class=\"string\">&quot;_fontColor&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fontColor != <span class=\"literal\">null</span>)</span><br><span class=\"line\">        currentFontColor = fontColor;</span><br><span class=\"line\">    fontCharacteristics = Resources.html2pdf.</span><br><span class=\"line\">        ResourceManager.</span><br><span class=\"line\">        GetString(tagName + <span class=\"string\">&quot;_fontCharacteristics&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fontCharacteristics != <span class=\"literal\">null</span>)</span><br><span class=\"line\">        currentFontCharacteristics =</span><br><span class=\"line\">            fontCharacteristics;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Note that we only push the attributes of the element onto the stack if there is no content in the element.  This is because the closing node type will never be triggered on an element that has no content inside of it (BR and IMG tags, for example).</p>\n<p>The final thing you’ll need to keep track of is if the element is a block element (P, DIV, etc) an inline tag (SPAN, A, etc) a list (OL,UL,LI), or even how much indentation is needed (primarily for list).</p>\n<p>Frankly, the code for this was not fun to write.  Keep in mind too that there is nothing in here to handle special font characteristic attributes.  So your DIV tags can’t specify what font they should use or even how wide the font should be.  Not because it can’t be done, but because I have not had the need.</p>\n<p>Here’s that code</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">strIndent = Resources.html2pdf.ResourceManager.GetString(tagName + <span class=\"string\">&quot;_indent&quot;</span>);</span><br><span class=\"line\">isBlock = Resources.html2pdf.ResourceManager.GetString(tagName + <span class=\"string\">&quot;_isBlock&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">string</span> isList = Resources.html2pdf.ResourceManager.GetString(tagName + <span class=\"string\">&quot;_isList&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (isBlock != <span class=\"literal\">null</span> &amp;&amp; isBlock.ToLower() == <span class=\"string\">&quot;true&quot;</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"built_in\">string</span> strIsList =</span><br><span class=\"line\">        Resources.html2pdf .ResourceManager</span><br><span class=\"line\">        .GetString(tagName + <span class=\"string\">&quot;_isULList&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (strIsList != <span class=\"literal\">null</span> &amp;&amp;</span><br><span class=\"line\">        strIsList.ToLower() == <span class=\"string\">&quot;true&quot;</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        p = <span class=\"keyword\">new</span> List(<span class=\"literal\">false</span>,</span><br><span class=\"line\">            System.Convert .ToSingle(strIndent));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        strIsList = Resources</span><br><span class=\"line\">            .html2pdf.ResourceManager</span><br><span class=\"line\">            .GetString(tagName + <span class=\"string\">&quot;isOLList&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (strIsList != <span class=\"literal\">null</span> &amp;&amp; strIsList.ToLower() == <span class=\"string\">&quot;true&quot;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            p = <span class=\"keyword\">new</span> List(<span class=\"literal\">true</span>,</span><br><span class=\"line\">                System.Convert.ToSingle(strIndent));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isList != <span class=\"literal\">null</span> &amp;&amp; isList.ToLower() == <span class=\"string\">&quot;true&quot;</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                p = <span class=\"keyword\">new</span> iTextSharp.text.ListItem();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                p = <span class=\"keyword\">new</span> Paragraph();</span><br><span class=\"line\">                ((Paragraph)p)</span><br><span class=\"line\">                    .SetLeading(m_leading, <span class=\"number\">1</span>);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (stack.Count != <span class=\"number\">0</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    IElement e = stack.Pop();</span><br><span class=\"line\"></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (isList != <span class=\"literal\">null</span> &amp;&amp; isList.ToLower() == <span class=\"string\">&quot;true&quot;</span>)</span><br><span class=\"line\">        ((iTextSharp.text.List)</span><br><span class=\"line\">            (list[list.Count - <span class=\"number\">1</span>])).Add(p);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> list.Add(p);</span><br><span class=\"line\">    stack.Push(p);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>You’ll notice that there is a bit of code in here that deals with a p variable.  This code is needed so that if we are dealing with a block tag, we have a paragraph or list item to put the other content inside of the block when we hit it.  If we are dealing with an inline tag, we deal with that when we add the text.</p>\n<p>Next week, we will show how to handle text and closing tags.</p>\n",
            "tags": [
                "c#",
                "asp.net",
                "html",
                "iTextSharp",
                "PDF",
                "parsing",
                "xhtml"
            ]
        },
        {
            "id": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-%E2%80%93-cleaning-html/",
            "url": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-%E2%80%93-cleaning-html/",
            "title": "iTextSharp – HTML to PDF – Cleaning HTML",
            "date_published": "2009-07-20T10:23:07.000Z",
            "content_html": "<p><img src=\"/uploads/2009/07/H05K0013.jpg\" alt=\"H05K0013\" title=\"H05K0013\"> The last prerequisite step prior to actually converting our HTML into PDF code is to clean up the HTML. The method I use takes advantage of the XML parser in .NET but in order to use that we have to have XHTML compliant XML. For this exercise, what I am most concerned about is that the HTML tags all have matching closing tags, that the tags are nested in a hierarchical structure, and that the tags all are lower case. Some of this we will have to rely on the user to provide, like properly nesting the tags.  But some of this we can attempt to clean up in our code.  If you know you will have complete control over your HTML, you might be able to skip this step.  But I think the code is simple enough that you’ll want to add it anyhow.  In my code, I have a function that accepts the HTML string and returns a collection of IElements that my main code will insert into the PDF.  The first thing I do in that function is make sure the code starts and ends with an open and close paragraph tag.  This is to ensure that I have at least one element that I can work with when I do the translation.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (!xhtmlString.ToLower().StartsWith(<span class=\"string\">&quot;&lt;p&gt;&quot;</span>))</span><br><span class=\"line\">    xhtmlString = <span class=\"string\">&quot;&lt;p&gt;&quot;</span> + xhtmlString + <span class=\"string\">&quot;&lt;/p&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>The next thing I do is make sure that all of the white space that isn’t the space character is removed from the code.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xhtmlString = xhtmlString</span><br><span class=\"line\">    .Replace(<span class=\"string\">&quot;\\</span></span><br><span class=\"line\"><span class=\"string\">&quot;</span>, <span class=\"built_in\">string</span>.Empty)</span><br><span class=\"line\">    .Replace(<span class=\"string\">&quot;\\n&quot;</span>, <span class=\"built_in\">string</span>.Empty)</span><br><span class=\"line\">    .Replace(<span class=\"string\">&quot;\\t&quot;</span>, <span class=\"built_in\">string</span>.Empty);</span><br></pre></td></tr></table></figure>\n\n<p>Then we want to change our BR tags to auto close.  Since I don’t deal with IMG tags in this code I don’t bother auto closing those tags.  If you decide to embellish this code to use the IMG tag, you’ll want to add code to fix that as well.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xhtmlString = xhtmlString</span><br><span class=\"line\">    .Replace(<span class=\"string\">&quot;&lt;BR&gt;&quot;</span>, <span class=\"string\">&quot;&lt;br /&gt;&quot;</span>)</span><br><span class=\"line\">    .Replace(<span class=\"string\">&quot;&lt;br&gt;&quot;</span>, <span class=\"string\">&quot;&lt;br /&gt;&quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>Since my code currently ignores any attributes in the SPAN tag, I then remove the span tag’s attributes.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">System.Text.RegularExpressions.Regex re = <span class=\"literal\">null</span>;</span><br><span class=\"line\">System.Text.RegularExpressions.Match match = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">re = <span class=\"keyword\">new</span> System.Text.RegularExpressions.Regex(<span class=\"string\">&quot;&lt;span.*?&gt;&quot;</span>);</span><br><span class=\"line\">match = re.Match(xhtmlString);</span><br><span class=\"line\"><span class=\"keyword\">while</span> (match.Success)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">foreach</span> (System.Text.RegularExpressions.Capture c <span class=\"keyword\">in</span> match.Captures)</span><br><span class=\"line\">        xhtmlString = xhtmlString.Replace(c.Value, <span class=\"built_in\">string</span>.Empty);</span><br><span class=\"line\">    match = match.NextMatch();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Then I force all my tags to lower case</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">re = <span class=\"keyword\">new</span> System.Text.RegularExpressions.Regex(<span class=\"string\">&quot;&lt;\\\\\\w+?&quot;</span>);</span><br><span class=\"line\">match = re.Match(xhtmlString);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">while</span> (match.Success)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">foreach</span> (System.Text.RegularExpressions.Capture c <span class=\"keyword\">in</span> match.Captures)</span><br><span class=\"line\">        xhtmlString = xhtmlString.Replace(c.Value, c.Value.ToLower());</span><br><span class=\"line\">    match = match.NextMatch();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">re = <span class=\"keyword\">new</span> System.Text.RegularExpressions.Regex(<span class=\"string\">&quot;&lt;/\\\\w+?&gt;&quot;</span>);</span><br><span class=\"line\">match = re.Match(xhtmlString);</span><br><span class=\"line\"><span class=\"keyword\">while</span> (match.Success)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">foreach</span> (System.Text.RegularExpressions.Capture c <span class=\"keyword\">in</span> match.Captures)</span><br><span class=\"line\">        xhtmlString = xhtmlString.Replace(c.Value, c.Value.ToLower());</span><br><span class=\"line\">    match = match.NextMatch();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Because the PDF code will treat each white space character as a character and HTML treats a string of white space characters as one space, I strip out any extra white space characters.  </p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span> (xhtmlString.Contains(<span class=\"string\">&quot;&gt; &quot;</span>))</span><br><span class=\"line\">    xhtmlString = xhtmlString.Replace(<span class=\"string\">&quot;&gt; &quot;</span>, <span class=\"string\">&quot;&gt;&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">while</span> (xhtmlString.Contains(<span class=\"string\">&quot;  &quot;</span>))</span><br><span class=\"line\">    xhtmlString = xhtmlString.Replace(<span class=\"string\">&quot;  &quot;</span>, <span class=\"string\">&quot; &quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>And then I convert any special HTML strings to their text equivalent.  Right now, I only have to deal with the ampersand character.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xhtmlString = xhtmlString.Replace(<span class=\"string\">&quot; &amp; &quot;</span>, <span class=\"string\">&quot; &amp;amp; &quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>Lastly, in order to ensure that my html string gets parsed correctly, I attempt to quote all my attributes</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">int</span> length = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (length != xhtmlString.Length)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    length = xhtmlString.Length;</span><br><span class=\"line\">    xhtmlString = System.Text</span><br><span class=\"line\">        .RegularExpressions.Regex .Replace(xhtmlString,</span><br><span class=\"line\">        <span class=\"string\">&quot;(&lt;.+?\\\\s+\\\\w+=)(\\[^\\&quot;&#x27;\\]\\\\S*?)(\\[\\\\s&gt;\\])&quot;</span>, <span class=\"string\">&quot;$1\\&quot;$2\\&quot;$3&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>With the exception of some features I’ve already noted that you might want to add, we’ve done all we can to clear up the code.  Any other problems are user input errors that will need to be corrected manually. Next, we can parse this HTML and convert it into PDF IElements. This process of cleaning up the HTML would all be a lot easier if HTML Tidy were converted to a managed code library.  (Yes, I know you can run it from .NET, but so far it is an external EXE, not managed code.)</p>\n",
            "tags": [
                "c#",
                "html",
                "iTextSharp",
                "PDF",
                "htmltidy"
            ]
        },
        {
            "id": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-prerequisites/",
            "url": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-prerequisites/",
            "title": "iTextSharp – HTML to PDF - Prerequisites",
            "date_published": "2009-07-14T10:40:39.000Z",
            "content_html": "<p><img src=\"/uploads/2009/07/animal015.jpg\" alt=\"animal-015\" title=\"animal-015\"></p>\n<p>Before we get into the nitty gritty of parsing the HTML so that we can create PDF code from it, it is important that we develop the concept of how text layout works in iTextSharp.  So today we will cover those basics.</p>\n<p>The first type of element we want to deal with when we parse our HTML into a PDF is the Paragraph element.</p>\n<p>When we get to actually parsing our HTML to PDF code we will use the Paragraph object for all of our block elements.  This allows us to add other Paragraphs and Chunks into it which we can format.</p>\n<p>A Chunk is our second object that we will be using.  The Chunk is the main object that will allow us to format the font.  In fact, even if our block element specifies some sort of specific font, the font doesn’t actually get applied in the code until we add the text.</p>\n<p>Typical code to place text into a PDF document would look something like this</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = <span class=\"keyword\">new</span> Paragraph(<span class=\"keyword\">new</span> Chunk(<span class=\"string\">&quot;text that needs a font&quot;</span>,</span><br><span class=\"line\">    FontFactory.GetFont(<span class=\"string\">&quot;Arial&quot;</span>, <span class=\"number\">10</span>, Font.NORMAL, Color.BLACK)));</span><br><span class=\"line\">p.Alignment = (Element.ALIGN_CENTER);</span><br><span class=\"line\">ct.AddElement(p);</span><br></pre></td></tr></table></figure>\n\n<p>where “ct” is an object of type ColumnText that we discussed last week.</p>\n<p>The only other two classes we need to discuss are the list classes.  We use the List to create an item that will handle both the OL and UL tags.  The ListItem class will handle the individual items within the list.  The List constructor handles which of the two types of list we are dealing with by specifying true or false in the first parameter, numbered.</p>\n<p>I have not yet added the ability to handle tables to my HTML parser mainly because I have not had the need.  I think once I show you how to create tables and how to parse HTML you should be able to handle adding table parsing code yourself.</p>\n",
            "tags": [
                "c#",
                "asp.net",
                "html",
                "iTextSharp",
                "PDF"
            ]
        },
        {
            "id": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-%E2%80%93-positioning-text/",
            "url": "http://davembush.github.com/itextsharp-%E2%80%93-html-to-pdf-%E2%80%93-positioning-text/",
            "title": "iTextSharp – HTML to PDF – Positioning Text",
            "date_published": "2009-07-08T10:50:15.000Z",
            "content_html": "<p><img src=\"/uploads/2009/07/misc_vol1_012.jpg\"></p>\n<p>The next series of things I’m going to introduce about using iTextSharp are all going to lead toward taking HTML text and placing it on the PDF document.</p>\n<p>There are several items we need to cover before we even get to the part about converting the text from HTML to PDF text.  The first is placing the text on the document where it is supposed to be.</p>\n<p><em>Once again, we are building on previous articles about using iTextSharp.  So if you are just jumping in, you might want to go take a look at the other articles.  You can find a list at the bottom of this post.</em></p>\n<p>To place a block of text on the screen that is going to have multiple formats in it (bold, underline, etc) I use the ColumnText class.  This allows me to specify the rectangle or, if I want, some irregular shape, to place the text in.  I handle determining where this rectangle is on the page in the same way that I determine where an image should go.  I have the designer place a form field on the screen and then I use that to get my coordinates.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">float</span>[] fieldPosition = <span class=\"literal\">null</span>;</span><br><span class=\"line\">fieldPosition =</span><br><span class=\"line\">    fields.GetFieldPositions(<span class=\"string\">&quot;fieldNameInThePDF&quot;</span>);</span><br><span class=\"line\">left = fieldPosition[<span class=\"number\">1</span>];</span><br><span class=\"line\">right = fieldPosition[<span class=\"number\">3</span>];</span><br><span class=\"line\">top = fieldPosition[<span class=\"number\">4</span>];</span><br><span class=\"line\">bottom = fieldPosition[<span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (rotation == <span class=\"number\">90</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    left = fieldPosition[<span class=\"number\">2</span>];</span><br><span class=\"line\">    right = fieldPosition[<span class=\"number\">4</span>];</span><br><span class=\"line\">    top = pageSize.Right - fieldPosition[<span class=\"number\">1</span>];</span><br><span class=\"line\">    bottom = pageSize.Right - fieldPosition[<span class=\"number\">3</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Once I have the position, the next thing I need to do is to create my ColumnText object.  This requires the same ContentByte object that we used for the images.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PdfContentByte over = stamp.GetOverContent(<span class=\"number\">1</span>);</span><br><span class=\"line\">ColumnText ct = <span class=\"keyword\">new</span> ColumnText(over);</span><br></pre></td></tr></table></figure>\n\n<p>And now I can set the rectangle to print into.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ct.SetSimpleColumn(left, bottom, right, top,</span><br><span class=\"line\">    <span class=\"number\">15</span>, Element.ALIGN_LEFT);</span><br></pre></td></tr></table></figure>\n\n<p>The 15 represents the leading you want (space between characters vertically). You may need to adjust that number.</p>\n<p>Once you have your rectangle, you can add paragraphs to it.  Paragraphs are composed of smaller units called chunks that can be formatted.  If you want a paragraph that is all formatted the same you can make a call that looks like this.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Paragraph p = <span class=\"keyword\">new</span> Paragraph(</span><br><span class=\"line\">    <span class=\"keyword\">new</span> Chunk(<span class=\"string\">&quot;Some Text here&quot;</span>,</span><br><span class=\"line\">        FontFactory.GetFont(</span><br><span class=\"line\">          <span class=\"string\">&quot;Arial&quot;</span>, <span class=\"number\">14</span>, Font.BOLD, Color.RED)));</span><br></pre></td></tr></table></figure>\n\n<p>and then add the paragraph to your rectangle</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ct.AddElement(p);</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "c#",
                "asp.net",
                "iTextSharp",
                "PDF"
            ]
        },
        {
            "id": "http://davembush.github.com/itextsharp-%E2%80%93-adding-images/",
            "url": "http://davembush.github.com/itextsharp-%E2%80%93-adding-images/",
            "title": "iTextSharp – Adding Images",
            "date_published": "2009-06-30T11:33:00.000Z",
            "content_html": "<p><img src=\"/uploads/2009/06/AutumnLeaves.jpg\" alt=\"Maple leaves in Autumn.\" title=\"Maple leaves in Autumn.\"></p>\n<p>Last week I showed how to use form fields to control placement of dynamic data.</p>\n<p>But what if you want to dynamically place images in your PDF?  You can stuff them into a form field like you can with text.</p>\n<span id=\"more\"></span>\n\n<p>However, one of the items you can retrieve from the form field is its location on the screen.  Using this, a little math, and some iTextSharp image code, we can place images in our PDF where the form field was located.  Here’s how I do it.</p>\n<p>First, this code builds on the previous code I’ve already demonstrated in previous articles.  If this is your first time here, you’ll want to scroll to the bottom of this post where it says, “Other Posts in iTextSharp” and read them first.</p>\n<p>To retrieve the position of the form field, you’ll need to call the field’s GetFieldPositions() method.  It is plural because it is going to get the position of every field in the document with the name you specify.  For our purposes, we will assume that the field only exists once and is on the first page.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">float</span>[] topImagePosition = <span class=\"literal\">null</span>;</span><br><span class=\"line\">topImagePosition =</span><br><span class=\"line\">    fields.GetFieldPositions(<span class=\"string\">&quot;m_topPicture&quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>The float array that is returned has five elements:</p>\n<ul>\n<li>Page Number (starting at 1)</li>\n<li>Left</li>\n<li>Bottom</li>\n<li>Right</li>\n<li>Top</li>\n</ul>\n<p>If the page rotation is 90 degrees, you’ll want to rotate the position information.  You can check the rotation using</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rotation = pdfReader.GetPageRotation(<span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n\n<p>Where <code>GetPageRotation()</code> takes a parameter representing the page number, starting at 1.</p>\n<p>You can rotate the positions using this code.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">left = topImagePosition[<span class=\"number\">1</span>];</span><br><span class=\"line\">right = topImagePosition[<span class=\"number\">3</span>];</span><br><span class=\"line\">top = topImagePosition[<span class=\"number\">4</span>];</span><br><span class=\"line\">bottom = topImagePosition[<span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (rotation == <span class=\"number\">90</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    left = topImagePosition[<span class=\"number\">2</span>];</span><br><span class=\"line\">    right = topImagePosition[<span class=\"number\">4</span>];</span><br><span class=\"line\">    top = pageSize.Right - topImagePosition[<span class=\"number\">1</span>];</span><br><span class=\"line\">    bottom = pageSize.Right - topImagePosition[<span class=\"number\">3</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Next, you’ll want to retrieve the image you want to display on the PDF.  There are APIs for retrieving the image from a web site, but most of the time you’ll be retrieving the image from your hard drive.  Here is the code to do that.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">iTextSharp.text.Image topImage =</span><br><span class=\"line\">    iTextSharp.text.Image.GetInstance(</span><br><span class=\"line\">    Server.MapPath(imagelocation +</span><br><span class=\"line\">    productRow.imagefilename));</span><br></pre></td></tr></table></figure>\n\n<p>Before we place the image on the page, the next thing you’ll want to do is scale the image so that it fits in the rectangle</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">topImage.ScaleToFit(right - left, top - bottom);</span><br></pre></td></tr></table></figure>\n\n<p>And then we position it</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">topImage.SetAbsolutePosition(</span><br><span class=\"line\">    left + ((right - left) - topImage.ScaledWidth) /</span><br><span class=\"line\">    <span class=\"number\">2</span>, top - topImage.ScaledHeight);</span><br></pre></td></tr></table></figure>\n\n<p>and then we put it into the PDF</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PdfContentByte contentByte = stamp.GetOverContent(<span class=\"number\">1</span>);</span><br><span class=\"line\">contentByte.AddImage(topImage);</span><br></pre></td></tr></table></figure>\n\n<p>Notice the contextByte thing.  That’s the critical part of how we get the images into the PDF.</p>\n<p>Finally, you’ll want to remove the field from the form so that it doesn’t show up.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fields.RemoveField(<span class=\"string\">&quot;m_topPicture&quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>I’m not sure this is really needed, but it doesn’t hurt to clean up things you no longer need.</p>\n",
            "tags": [
                "c#",
                "images",
                "iTextSharp",
                "PDF"
            ]
        },
        {
            "id": "http://davembush.github.com/net-string-pool-%E2%80%93-not-just-for-the-compiler/",
            "url": "http://davembush.github.com/net-string-pool-%E2%80%93-not-just-for-the-compiler/",
            "title": ".Net String Pool – Not Just For The Compiler",
            "date_published": "2009-04-22T08:34:00.000Z",
            "content_html": "<p><img src=\"/uploads/2009/04/b03b0055.jpg\" alt=\"B03B0055\" title=\"B03B0055\"> On Monday, I was corrected in my assertion that creating multiple empty strings would create multiple objects.  Turns out the compiler automatically puts all of the strings that are exactly the same in a “string pool” so that there is only ever one empty string in the entire application you’ve created.</p>\n<span id=\"more\"></span>\n\n<p>Duh! I should have known this, or at least I should have expected that this was so since it has been true with every other compiled language I’ve worked with.</p>\n<p>But what I didn’t know and couldn’t expect is that we can make use of this string pool programmatically as well.</p>\n<p><strong>Why would you want to do this yourself?</strong></p>\n<p>Keep in mind that string concatenation in .NET requires the creation of a new object.  So, code such as this,</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String a = <span class=\"string\">&quot;abcd&quot;</span>;</span><br><span class=\"line\">String b = <span class=\"string\">&quot;efgh&quot;</span>;</span><br><span class=\"line\">a += b;</span><br></pre></td></tr></table></figure>\n\n<p>creates a new object at line 3 every time it is executed.</p>\n<p>So that if we add the following line:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">b = <span class=\"string\">&quot;abcdefgh&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>we would not be pointing to the same object.  That is, a and b would contain the same content but would be pointing to two entirely different objects.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (a == b)</span><br><span class=\"line\">    Trace.Write(<span class=\"string\">&quot;A and B contain the same data&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (String.ReferenceEquals(a,b))</span><br><span class=\"line\">    Trace.Write(<span class=\"string\">&quot;A and B are the same object&quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<p><strong>String.Intern Consolidates The Data</strong></p>\n<p>By using String.Intern() we can get both evaluations to be true.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String a = <span class=\"string\">&quot;abcd&quot;</span>;</span><br><span class=\"line\">String b = <span class=\"string\">&quot;efgh&quot;</span>;</span><br><span class=\"line\">a = String.Intern(a + b);</span><br><span class=\"line\">b = <span class=\"string\">&quot;abcdefgh&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>Now both evaluations above will be true because line 3 places the string “abcdefgh” in the pool and line 4 uses that same string from the pool to assign to b.  Where we might have created two objects, we are now only creating one and referring to it both times.</p>\n<p>You could also use String.IsInterned(string) to determine if a string has already been placed in the string pool and execute optional code based on that.</p>\n<p><strong>When Would You Use This?</strong></p>\n<p>I still stand by my statement that optimizations should be saved for last.  You would not do this if this was the only place where you were doing the concatenation.  But you might consider doing this if your concatenations were in a loop that was taking a significant amount of processing time.</p>\n<p>Other things you might also want to consider would be to consolidate concatenations on the same line and&#x2F;or using the StringBuilder class for concatenations.  Keep in mind that StringBuilder is only really useful once you get past three concatenations due to the overhead of creating the StringBuilder object vs. creating new objects during the normal concatenation process.</p>\n",
            "tags": [
                "c#",
                "vb.net",
                ".net",
                "string",
                "intern"
            ]
        },
        {
            "id": "http://davembush.github.com/c-%E2%80%9C%E2%80%9D-better-than-string-empty/",
            "url": "http://davembush.github.com/c-%E2%80%9C%E2%80%9D-better-than-string-empty/",
            "title": "C# “” better than string.Empty?",
            "date_published": "2009-04-20T08:43:00.000Z",
            "content_html": "<p><img src=\"/uploads/2009/04/arct013.jpg\" alt=\"arct-013\" title=\"arct-013\">I recently read an article that argued that “” is “Better than String.Empty”</p>\n<p>The argument is that since string.Empty doesn’t work in all situations, we should not use it at all.  He further argues that since the compiler can’t optimize code using string.Empty, the performance gains we might lose due to our lack of this optimization further supports the argument that we should not use it at all.</p>\n<p>But at what price?</p>\n<span id=\"more\"></span>\n\n<p>First, it is impressive that he took the time to evaluate the performance hit that using String.Empty can cause.  I’m pretty sure his evaluation of using String.Empty in a case statement is from his attempt to do so only to find out he couldn’t.</p>\n<p>However, he seems to have overlooked the price of not using String.Empty.  Certainly, Microsoft didn’t put that there without thinking about what they were doing.</p>\n<p>So let’s further evaluate what is happening in our code when we use “” rather than using String.Empty.</p>\n<p><strong>Consider Real World Optimization</strong></p>\n<p>In the article referenced, he does one, and only one, bench mark to prove that “” is faster than String.Empty by putting the code in a loop that could be optimized out.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"built_in\">string</span>.Empty == <span class=\"literal\">null</span>) &#123; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Exception(); &#125;</span><br></pre></td></tr></table></figure>\n\n<p>vs</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"string\">&quot;&quot;</span> == <span class=\"literal\">null</span>) &#123; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Exception(); &#125;</span><br></pre></td></tr></table></figure>\n\n<p>But what about a real world scenario where the code is NOT optimized out?</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String s = String.Empty;</span><br></pre></td></tr></table></figure>\n\n<p>vs</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String x = <span class=\"string\">&quot;&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>In my test, there was no noticeable difference.  Sometimes string.Empty was faster and sometimes the empty string was faster.   And I expect the reason they are about the same is because the compiler optimized out the assignment.</p>\n<p>In real life, I would expect String.Empty to take just slightly longer.  But not enough to make it worth worrying about.</p>\n<p><strong>Consider String Comparison Cost</strong></p>\n<p>Second, string comparisons are notoriously expensive in every language I’ve ever worked in.  Including the .NET languages.  Instead of arguing that we can’t using String.Empty in a case statement, we would do better to argue that using a string in a case statement is the last of the possible alternatives we might use.</p>\n<p>When evaluating for the empty string, for example, you might check the string’s length rather than checking the string itself. For other strings, you might check the first character of the string.</p>\n<p><strong>Writing Code is About Solving Problems</strong></p>\n<p>When I started my career, computers were slow and had a limited amount of memory.  Writing the smallest amount of code that performed in the most efficient way was half the struggle of writing the application.</p>\n<p>Today, neither of those issues are of primary concern.  The first order of concern is to write an application that works.  Once it is DOING what it is supposed to do, IF there are performance issues, we should do proper code evaluation to determine where the performance bottlenecks are and then, and only then, should we optimize our code for performance.</p>\n<p>Generally, using String.Empty will serve you better than using “”.  In the cases where String.Empty will not work either because of the code evaluation OR because of the performance considerations, yes, use “” instead.  But, do it because there is a supportable reason, not because you think it may produce faster code.</p>\n<p>In fact, I would argue that if your code has performance problems, the last place you should be looking is at this issue.  You’ll get negligible gains. Your real problem is more likely in file IO, including database access and network access.</p>\n",
            "tags": [
                "c#",
                "empty",
                "string"
            ]
        },
        {
            "id": "http://davembush.github.com/just-say-%E2%80%9Cno-%E2%80%9D-to-c-regions-really/",
            "url": "http://davembush.github.com/just-say-%E2%80%9Cno-%E2%80%9D-to-c-regions-really/",
            "title": "Just say “No!” to C# Regions?  Really?!",
            "date_published": "2009-04-16T10:31:49.000Z",
            "content_html": "<p><img src=\"/uploads/2009/04/other042.jpg\" alt=\"other-042\" title=\"other-042\">  I just read a post by Casademora on “public abstract string[]  Blog()”</p>\n<p><a href=\"//extractmethod.wordpress.com/2008/02/29/just-say-no-to-c-regions/\">Just say No! to C# Regions « public abstract string[] Blog()</a></p>\n<p>and</p>\n<p><a href=\"//extractmethod.wordpress.com/2008/06/02/i-still-say-regions-are-not-usefulbut/\">I still say Regions are not useful… but…</a></p>\n<p>Arguing that not only should we NOT use code regions, but if we do, we are hiding “bad code.”  He uses words like “retarded,” “lame excuse for a preprocessor tag,” etc.</p>\n<span id=\"more\"></span>\n\n<p>You’d think maybe this guy (gal?) just had a bad day when he wrote this, but no, he goes on to further defend his position in a later post.</p>\n<p>And what I don’t understand at all is how his original post ended up on DotNetKicks today.  It’s an old post that was written last year but was just kicked up to the front page?  I figure someone MUST agree with him or it wouldn’t be there.</p>\n<p>So, are Regions really as evil as Casademora argues that they are?</p>\n<p><strong>First what is a region?</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">region</span> Member Variables</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"built_in\">bool</span> _refreshState;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"built_in\">bool</span> _isRefresh;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endregion</span> Member Variables</span></span><br></pre></td></tr></table></figure>\n\n<p>That’s a region.  See the #region and the #endregion preprocessor tags?  They define a named region in your code.</p>\n<p><strong>Why do they exist?</strong></p>\n<p>Any code you surround with a region is collapsible, just like your methods and properties are.  If you collapse the region above, all you see in your editor is:</p>\n<p><img src=\"/uploads/2009/04/image1.png\" alt=\"image\" title=\"image\"></p>\n<p><strong>Are they hiding “bad” code?</strong></p>\n<p>The main argument that Casademora makes is that the use of regions hides “bad” code.  He defines bad code as:</p>\n<p>Oh… wait!  He never defines “Bad” he only defines “Better.”</p>\n<p>But I doubt that anyone could argue that declaration of private member variables is “bad” in any sense of the word.  In fact this code is from one of the best programmers I know.  Here’s a screen grab of the methods in this file:</p>\n<p><img src=\"/uploads/2009/04/image2.png\" alt=\"image\" title=\"image\"></p>\n<p>And the code in those methods is just as pretty.  In fact, Mike’s code is consistently well structured, well organized, follows good naming conventions.  I wish my code looked as good.</p>\n<p>But when you first open the file, this is what you see:</p>\n<p><img src=\"/uploads/2009/04/image3.png\" alt=\"image\" title=\"image\"></p>\n<p>I don’t know about you, but I always feel like I’ve been hit with a breath of fresh air when I open Mike’s code.  Instead of being assaulted with 201 lines of code (that’s how many lines are in this file) I see this.</p>\n<p>So the question is, would Mike’s code be as organized without the regions?  So I asked him.</p>\n<p>He says, “I’d try to do it anyway, but the regions make it easier.  Like, if I need to add a new private method, I go right to that region.  I find it most useful to separate out the properties and event handlers.”</p>\n<p>So, contrary to Casademora’s statement, regions actually help Mike structure his code so that it is easy to read.  They aren’t hiding “bad” code.  If anything they are “hiding” good code.</p>\n<p><strong>Hiding Code is Good</strong></p>\n<p>When you are working on code with lots of properties, methods, and event handlers.  Do you really need to see the member variables at the same time you are working on an Event handler?  Most of the time we don’t.</p>\n<p>Regions, used correctly, make your code more readable, and hide code you aren’t working on so that you can easily find and work on the code you do need to work on.  That’s the whole point.</p>\n<p>I’m sure one could find uses of regions that have nothing to do with code structure.  Uses that obfuscate the code rather than making it easier to maintain.  But if you use the code in a logical way, they can significantly increase the readability of your code.</p>\n",
            "tags": [
                "c#",
                "regions"
            ]
        },
        {
            "id": "http://davembush.github.com/windows-forms-passing-parameters-at-runtime/",
            "url": "http://davembush.github.com/windows-forms-passing-parameters-at-runtime/",
            "title": "Windows Forms - Passing Parameters at Runtime",
            "date_published": "2009-03-09T11:37:11.000Z",
            "content_html": "<p><img src=\"/uploads/2009/03/misc-vol4-028.jpg\" alt=\"misc_vol4_028\"> I received the following question over the weekend:</p>\n<blockquote>\n<p>I’ve made a C# form application and I need to send a report name at runtime. How do I add an incoming parameter to the command line? Such as “crFORM.exe Shipform.rpt”</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<p>I have to assume the question relates more to how to retrieve the parameter in the code than how to pass it because the example shows how we’d pass it. All WinForms CSharp programs have a static method called Main() that looks something like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">STAThread</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    Application.EnableVisualStyles();</span><br><span class=\"line\">    Application.SetCompatibleTextRenderingDefault(<span class=\"literal\">false</span>);</span><br><span class=\"line\">    Application.Run(<span class=\"keyword\">new</span> Form1());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>If you are using Visual Studio 2008 to build your applications, this code can be found in Program.cs. To accept parameters you will need to modify this method so that it accepts a string array as a parameter.  Most people name this parameter “args.”</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">STAThread</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\">String[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>If a parameter was passed, args will have a length greater than zero.  To retrieve the command line arguments all you need to do is retrieve the parameters out of args.</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">STAThread</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\">String[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (args.Length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">string</span> arg1 = args[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"comment\">// do something appropriate with</span></span><br><span class=\"line\">        <span class=\"comment\">// arg1 here. &#125;</span></span><br><span class=\"line\">    Application.EnableVisualStyles();</span><br><span class=\"line\">    Application.SetCompatibleTextRenderingDefault(<span class=\"literal\">false</span>);</span><br><span class=\"line\">    Application.Run(<span class=\"keyword\">new</span> Form1());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "c#",
                "winforms",
                "arguements",
                "command line",
                "main"
            ]
        },
        {
            "id": "http://davembush.github.com/what-is-the-global-keyword-in-csharp/",
            "url": "http://davembush.github.com/what-is-the-global-keyword-in-csharp/",
            "title": "What is the global keyword in CSharp?",
            "date_published": "2008-12-29T12:01:15.000Z",
            "content_html": "<p>During the Christmas break, I received the following question: What does C# global keyword actually do? Code example, from table adapter code:</p>\n<span id=\"more\"></span>\n\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">global::System.CodeDom.Compiler.GeneratedCodeAttribute(<span class=\"string\">&quot;System.Data.Design.TypedDataSetGenerator&quot;</span>, <span class=\"string\">&quot;2.0.0.0&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">global::System.Serializable()</span>]</span><br><span class=\"line\">[<span class=\"meta\">global::System.ComponentModel.DesignerCategoryAttribute(<span class=\"string\">&quot;code&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">global::System.ComponentModel.ToolboxItem(true)</span>]</span><br><span class=\"line\">[<span class=\"meta\">global::System.Xml.Serialization.XmlSchemaProviderAttribute(<span class=\"string\">&quot;GetTypedDataSetSchema&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">global::System.Xml.Serialization.XmlRootAttribute(<span class=\"string\">&quot;AutoTwitDataSet&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">global::System.ComponentModel.Design.HelpKeywordAttribute(<span class=\"string\">&quot;vs.data.DataSet&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">partial</span> <span class=\"keyword\">class</span> <span class=\"title\">AutoTwitDataSet</span> : <span class=\"title\">global</span>::<span class=\"title\">System.Data.DataSet</span> &#123;</span><br></pre></td></tr></table></figure>\n\n<p>The global keyword tells the compiler to start looking for the namespace or class starting from the root.  You’ll see it in system-generated code so that the code always works.  That way if you have a namespace right under your current namespace that is the same as the top-level namespace the code is trying to access, there won’t be a conflict.</p>\n<p>For example, say you have namespace A and namespace B and namespace B.A if I write code in namespace B.A that needs to reference a class in namespace A, without global:: I have no way of getting to it.  If I reference A.classname, the compiler will look for classname in B.A.  With global:: I can tell it to look for classname in global::A.classname and it will find classname in the proper location.</p>\n<p>This keyword snuck in during version 2.0.  Since most of us don’t need it, most of us don’t even know it exists.  I didn’t until this past weekend.</p>\n",
            "tags": [
                "c#",
                "global"
            ]
        },
        {
            "id": "http://davembush.github.com/unsafe-mode-in-c/",
            "url": "http://davembush.github.com/unsafe-mode-in-c/",
            "title": "Unsafe Mode in C#",
            "date_published": "2008-12-15T13:14:08.000Z",
            "content_html": "<p><img src=\"/uploads/2008/12/tp-vol4-006.jpg\" alt=\"tp_vol4_006\"> One of the “advantages” of using CSharp instead of VB.NET is that if programmers want to, they have the option of bypassing the memory management of .NET and working with memory directly.  This is called “unsafe” mode.</p>\n<p>While I will show you how to use this keyword, I have to tell you up front that I’ve been using CSharp since Beta 2 of .NET 1.0 and I’ve NEVER needed to switch into unsafe mode to do any of the work that I’ve done.</p>\n<span id=\"more\"></span>\n\n<p>I’ve even written code that bridged down to some unmanaged C++ code and still have not needed to use unsafe mode.  One of the main advantages of using .NET to begin with is the fact that .NET manages our memory for us.  I’ve worked on far too many C++ programs that leaked memory due to their complexity and bad architecture to purposely go back to that model.</p>\n<p>Yes, it is true that you might get a slight performance improvement by bypassing the memory management and working with the memory directly.  But is that slight improvement worth the risk of all of the issues that arise when using memory directly? If you find that you need to use unsafe mode, I would recommend that you consider writing that part of your code in a language that was designed for that level of coding.  Assembler or C++ are some good choices.</p>\n<p>If these are not options, here’s where the unsafe keyword comes in. Any code you wrap in the unsafe keyword:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">unsafe</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// this code is unmanaged</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>becomes unmanaged.  You will also need to add the &#x2F;unsafe compiler switch to your compiler options. You can also make an entire method unsafe by adding the keyword to the method declaration:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">unsafe</span> <span class=\"keyword\">void</span> <span class=\"title\">Foo</span>(<span class=\"params\"><span class=\"built_in\">int</span> *i</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// i is a pointer that is unsafe</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>In a future post, we’ll look at some ways of using pointers in CSharp code.</p>\n",
            "tags": [
                "c#",
                "pointers",
                "unsafe"
            ]
        },
        {
            "id": "http://davembush.github.com/advantages-of-using-class-diagram/",
            "url": "http://davembush.github.com/advantages-of-using-class-diagram/",
            "title": "Advantages of Using Class Diagram",
            "date_published": "2008-11-20T13:02:47.000Z",
            "content_html": "<p><img src=\"/uploads/2008/11/misc-vol4-063.jpg\" alt=\"misc_vol4_063\"> One of the new tools that showed up in Visual Studio 2005 that I don’t see many people taking much advantage of is the Class Diagram.</p>\n<span id=\"more\"></span>\n\n<p>The class diagram displays the classes you drag onto it in a visual representation much like a UML class diagram does.  It also lets you see relationships between your classes.  But the greatest advantage of the Class Diagram is that it will write a lot of your code for you.  The Class Diagram is available in both CSharp and VB.NET and works similarly in both.  My description of the tool will be using CSharp in Visual Studio 2008.  There may be a few quirky differences if you are using VB.NET and&#x2F;or Visual Studio 2005. I was reminded of this tool a couple of days ago when I needed to override a method but I couldn’t remember its name.  I could have spend a few minutes looking in the parent class for the name of the method I needed to override, but instead I created a new Class Diagram file and did a drag and drop of the class I was working on onto the Class Diagram’s surface.  This then let me right-click on the class and select “Intellisense” &gt; “Override members…” from the context menu.</p>\n<p>This will bring up a dialog that will list ALL of the classes the class inherits from (so it helps to know what class the method you want to override is in).  You can then check off the members you want to override from the list supplied.  When you press OK, the methods will be stubbed out for you in the source code.  All you need to do is provide the functionality. You can use this same type of process to add new methods, add properties, and add member variables.</p>\n<p>If you haven’t broken out the class diagram recently, I suggest you give it a try.</p>\n",
            "tags": [
                "c#",
                "class diagram",
                "vb.net",
                "visual studio"
            ]
        },
        {
            "id": "http://davembush.github.com/why-you-can-t-cast-an-integer-to-a-string/",
            "url": "http://davembush.github.com/why-you-can-t-cast-an-integer-to-a-string/",
            "title": "Why you can't cast an integer to a string.",
            "date_published": "2008-06-23T09:59:21.000Z",
            "content_html": "<p>I saw a question on Channel 9 that I’ve heard before. My guess is that there are enough people who have the same question that it’s worth addressing.</p>\n<blockquote>\n<p>I know there’s probably a really good reason for this, but I can’t think of what it is, and it keeps bugging me. Why can’t you do int x &#x3D; 10; string y &#x3D; (string)x; in C#? I mean, you could simply use x.ToString(), but why doesn’t the explicit cast do the same?</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"Why-do-you-think-you-can-do-this-in-the-first-place\"><a href=\"#Why-do-you-think-you-can-do-this-in-the-first-place\" class=\"headerlink\" title=\"Why do you think you can do this in the first place?\"></a>Why do you think you can do this in the first place?</h2><p>The people who tend to ask this question are people coming out of a VB background. In VB, we have functions that will allow us to convert any type to any other type. CStr() is one of those functions. Give it an integer and it will convert it to a string. CInt() is another. Give it a value and it will convert it to an integer.</p>\n<p>So, when people from that background first learn about casting, the only thing they have to hook the concept to in their thinking, is the conversion functions that are available in VB. You can’t blame them, really.</p>\n<p>But a cast is not a conversion. A conversion operation actually returns a completely different value. To do a similar operation in CSharp, you’d actually use the functions in the Convert class.</p>\n<p>A cast, on the other hand, doesn’t change the variable. It just lets us access it as though it were another type. And you can only cast if the data you are pointing to is related, via inheritance, to the type you want to cast it to.</p>\n<h2 id=\"So-the-simple-answer-is-“because-an-int-is-not-a-string”\"><a href=\"#So-the-simple-answer-is-“because-an-int-is-not-a-string”\" class=\"headerlink\" title=\"So the simple answer is, “because an int is not a string”\"></a>So the simple answer is, “because an int is not a string”</h2><p>When dealing with an object-oriented language, particularly .NET languages, everything except for the Object type derives from some other object. So technically, a string IS AN object, an int IS AN object, in fact, everything IS AN object. If I have a class “Person” and a class named “Employee” that derives from “Person” and another class “Customer” that derives from “Person” I can say that an “Employee” is a “Person” and that a “Customer” is a “Person” but I can’t say that a “Customer” is an “Employee”.</p>\n<p>Neither can I say that a “Person” is a “Customer”, or that a “Person” is an “Employee”. It doesn’t make sense. So, if I have an object of type Employee, I can cast that object to a type Person. But I can’t cast it to a type of Customer because there is no “is a” relationship between the two.</p>\n<h2 id=\"So-how-does-this-relate-to-Strings-and-ints\"><a href=\"#So-how-does-this-relate-to-Strings-and-ints\" class=\"headerlink\" title=\"So, how does this relate to Strings and ints?\"></a>So, how does this relate to Strings and ints?</h2><p>Well, if you look at the inheritance tree for .NET, you will see that a String inherits directly from the Object class. You will also see that an int inherits from the ValueType class, which inherits from the Object class. Since neither type is derived from the other, you can’t cast them–you can only convert them.</p>\n<p>A little-known fact about VB.NET is that it also has a casting “function.” It looks like a function to the VB guys, but it is really an operator disguised as a function. directcast() takes an object as the first parameter and the type you want to cast it to as the second parameter. The operator does the same thing that the casting operator in CSharp does.</p>\n",
            "tags": [
                "c#",
                "vb.net",
                ".net",
                "casting",
                "convert"
            ]
        },
        {
            "id": "http://davembush.github.com/serializable-attribute-vs-serializable-interface/",
            "url": "http://davembush.github.com/serializable-attribute-vs-serializable-interface/",
            "title": "Serializable attribute vs Serializable Interface",
            "date_published": "2008-04-09T11:11:33.000Z",
            "content_html": "<p>Judging from the comments I received yesterday, it looks like we need to review  serialization in .NET.</p>\n<h2 id=\"The-Easy-Way\"><a href=\"#The-Easy-Way\" class=\"headerlink\" title=\"The Easy Way\"></a>The Easy Way</h2><p>There are two ways of making an object serializable.  The first, and easiest way is by applying the Serializable attribute to the class.  Once you’ve done this all of the member variables in the class will get stored into the stream unless you’ve attributed one of the variables with NonSerialized.</p>\n<p>This method is useful for objects you want to be able to store temporarily.  For example, you might use this to transfer objects using Web Services or if you wanted to store the object in a session variable when your sessions are being stored in a session server.  You would never use this to store the object to a file that you want to be able to retrieve some time in the future after restarting your application.  That is, you would never use this method to implement the <a href=\"/2008/04/08/unauthorizedaccessexception-writing-to-hklm/\">Registry solution</a> I mentioned yesterday.</p>\n<h2 id=\"The-Reliable-Way\"><a href=\"#The-Reliable-Way\" class=\"headerlink\" title=\"The Reliable Way\"></a>The Reliable Way</h2><p>What you need instead is the Serializable Interface, or more correctly, you want to implement ISerializable on your class.  Using the ISerializable interface gives you a lot more control.  Used correctly, you can store an object to a file system, shut down your application, install an upgrade to the application with additional information (or less information) in the class, and still successfully load the object from the file system.  So, let’s illustrate with a simple class:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">Demo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"built_in\">int</span> m_intVar;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Demo</span>()</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"The-Basics\"><a href=\"#The-Basics\" class=\"headerlink\" title=\"The Basics\"></a>The Basics</h2><p>This is a pretty simple class.  It has one member variable that we will use to save some sort of state information and will need to get stored to the stream when we save the object instance.  To implement the interface, we need to change the class to look like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Serializable</span>]</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">Demo</span> : <span class=\"title\">ISerializable</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"built_in\">int</span> m_intVar;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Demo</span>()</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Demo</span>(<span class=\"params\">SerializationInfo info, StreamingContext context</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        m_intVar = info.GetInt32(<span class=\"string\">&quot;m_intVar&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">GetObjectData</span>(<span class=\"params\">SerializationInfo info,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">        StreamingContext context</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        info.AddValue(<span class=\"string\">&quot;m_intVar&quot;</span>, m_intVar);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>The thing to watch out for here is that you need a constructor that takes SerializationInfo and StreamingContext as parameters.  Since the interface can’t remember this, you’ll have to remember it.</p>\n<p>You’ll notice that we’ve taken control of storing and retrieving the data by using the AddValue and GetInt32 calls inside of the new, required, constructor and the GetObjectData method.  GetObjectData is called when the data is being saved.  The constructor gets called when the data is being loaded.</p>\n<h2 id=\"Protecting-For-The-Future\"><a href=\"#Protecting-For-The-Future\" class=\"headerlink\" title=\"Protecting For The Future\"></a>Protecting For The Future</h2><p>If we leave the code as it is above, we are no better off than if we had simply implemented the Serializable attribute.  What we need to add to this code is some way of versioning the object.  This is easy to do by adding a few more lines of code: When we initially create the object, all we need to do is add one line of code to our GetObjectData method</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">GetObjectData</span>(<span class=\"params\">SerializationInfo info,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    StreamingContext context</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    info.AddValue(<span class=\"string\">&quot;VERSION&quot;</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">    info.AddValue(<span class=\"string\">&quot;m_intVar&quot;</span>, m_intVar);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"The-Future\"><a href=\"#The-Future\" class=\"headerlink\" title=\"The Future\"></a>The Future</h2><p>Some time later, we decide to add another variable to our class:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"built_in\">int</span> m_intVar;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"built_in\">string</span> m_stringVar;</span><br></pre></td></tr></table></figure>\n\n<p>And save it as part of GetObjectData.  Because we’ve added another variable, we need to increment the version number.  So, GetObjectData now looks like:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">GetObjectData</span>(<span class=\"params\">SerializationInfo info, StreamingContext context</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    info.AddValue(<span class=\"string\">&quot;VERSION&quot;</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    info.AddValue(<span class=\"string\">&quot;m_intVar&quot;</span>, m_intVar);</span><br><span class=\"line\">    info.AddValue(<span class=\"string\">&quot;m_stringVar&quot;</span>, m_stringVar);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>and our constructor now looks like:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Demo</span>(<span class=\"params\">SerializationInfo info, StreamingContext context</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"built_in\">int</span> VERSION = info.GetInt32(<span class=\"string\">&quot;VERSION&quot;</span>);</span><br><span class=\"line\">    m_intVar = info.GetInt32(<span class=\"string\">&quot;m_intVar&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (VERSION &gt; <span class=\"number\">1</span>)</span><br><span class=\"line\">        m_stringVar = info.GetString(<span class=\"string\">&quot;m_stringVar&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> m_stringVar = <span class=\"string\">&quot;default string&quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>By incrementing the version number every time we make a change to the class and testing for the appropriate version number when we load the object, we can avoid having our application crash simply because the class has changed between the time we save the object and the time we loaded the object from the stream.</p>\n",
            "tags": [
                "c#",
                "serialization"
            ]
        },
        {
            "id": "http://davembush.github.com/object-initialization-in-csharp-3-0-and-vb-net-9/",
            "url": "http://davembush.github.com/object-initialization-in-csharp-3-0-and-vb-net-9/",
            "title": "Object Initialization in CSharp 3.0 and VB.NET 9",
            "date_published": "2007-11-28T14:24:13.000Z",
            "content_html": "<p>Yesterday we looked at the new var keyword in CSharp.  This makes CSharp variable declaration similar to VB.  After all, they’ve had the DIM keyword for years which essentially does the same thing.</p>\n<p>Today, we’re going to look at object initializers, which have been added to both CSharp and VB.</p>\n<span id=\"more\"></span>\n\n<p>Let’s say we have a class named, “Customer” with the properties: FirstName, LastName, Address, City, and State.  If you wanted to initialize those properties as part of the object creation process you basically had two choices.  You could create a constructor with each of the properties represented as a parameter, or you could use the default constructor and then initialize each property individually immediately after you instantiate the object.  Using CSharp, that process would look something like:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Customer c = <span class=\"keyword\">new</span> Customer()</span><br><span class=\"line\">c.FirstName = <span class=\"string\">&quot;Dave&quot;</span>;</span><br><span class=\"line\">c.LastName = <span class=\"string\">&quot;Bush&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>in VB you could write code similar to the CSharp code above, with obvious syntax changes for VB, or you could use the WITH keyword to simplify it.</p>\n<figure class=\"highlight vb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Dim</span> c <span class=\"keyword\">As</span> <span class=\"built_in\">New</span> Customer()</span><br><span class=\"line\"><span class=\"keyword\">With</span> c</span><br><span class=\"line\">  .FirstName = <span class=\"string\">&quot;Dave&quot;</span></span><br><span class=\"line\">  .LastName = <span class=\"string\">&quot;Bush&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">With</span></span><br></pre></td></tr></table></figure>\n\n<p>The new versions of these languages make the initialization process a bit easier.  Now, your CSharp code can look like:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Customer c = <span class=\"keyword\">new</span> Customer()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    FirstName = <span class=\"string\">&quot;Dave&quot;</span>,</span><br><span class=\"line\">    LastName = <span class=\"string\">&quot;Bush&quot;</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>and your VB code can look like this:</p>\n<figure class=\"highlight vb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Dim</span> c <span class=\"keyword\">As</span> <span class=\"built_in\">New</span> Customer() <span class=\"keyword\">With</span> &#123; _</span><br><span class=\"line\">  .FirstName = <span class=\"string\">&quot;Dave&quot;</span>, _</span><br><span class=\"line\">  .LastName = <span class=\"string\">&quot;Bush&quot;</span> _</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Keep in mind that the code that I just wrote compiles into the code I wrote using the old syntax.  This means that we can use this syntax in Visual Studio 2008 even if we are writing code for .NET 2.0.  Secondly, this means that it would still be faster to use the constructor with parameters if it is available.</p>\n<p>My fear is that some of the new features in the compilers will allow lazy programmers to write crappy code.  The point of the object initialization syntax is not to help you avoid creating parameterized constructors.  The point is to make your coding life easier when, and only when, the proper parameterized constructors do not exist.</p>\n",
            "tags": [
                "c#",
                "vb.net",
                "visual studio",
                "tutorial",
                "object initializers",
                "video"
            ]
        },
        {
            "id": "http://davembush.github.com/csharp-adds-the-var-keyword/",
            "url": "http://davembush.github.com/csharp-adds-the-var-keyword/",
            "title": "CSharp adds the var keyword!",
            "date_published": "2007-11-27T12:56:11.000Z",
            "content_html": "<p>There have been several new features added to the CSharp language that will significantly reduce the amount of code that ends up in our source files.  It will not significantly reduce the amount of code that we have to write. One of those language features is the ability to create properties, <a href=\"/2007/11/22/simple-properties-in-c-35/\" title=\"Simple properties in CSharp\">which we looked at last week.</a> Another of those features is the new var keyword. So, instead of writing:</p>\n<span id=\"more\"></span>\n\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MyClass c = <span class=\"keyword\">new</span> MyClass();</span><br></pre></td></tr></table></figure>\n\n<p>  you can now write:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> c = <span class=\"keyword\">new</span> MyClass();</span><br></pre></td></tr></table></figure>\n\n<p>Which isn’t a lot of code until you start qualifying the Class name with namespaces.</p>\n<p>During the beta cycle, I saw a demo that let you declare a variable, var c, and then several lines later initialize it with, new MyClass(), which gave the appearance that var was more like the var keyword in javascript, and therefore a variant than what it really is.</p>\n<p>In the release version of CSharp 3.0, if you use the var keyword to declare a variable, you MUST initialize it on the same line, or you will get a compiler error.  I suppose it makes writing the compiler a whole lot easier this way too.</p>\n<p>One other small thing to note, which should be obvious by now.  Since we have to initialize the variable to some object or value, and since we can’t initialize it anywhere other than on the line it is declared on, you can’t treat the variable as a variant.  A variable declared as var is as strongly typed as any other variable you would create.  So, if I did something like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> c = <span class=\"keyword\">new</span> MyClass();</span><br><span class=\"line\">c = <span class=\"string\">&quot;Some string here&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>I would get a compiler error because I’m trying to assign a string type to a MyClass variable.  <code>var</code> does not stand for “variant,” it stands for “variable.”  All the compiler does when it sees this is look at the type being assigned to the variable and replaces the var keyword with that type.</p>\n<p>So, when the compiler processes the code, it takes this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> c = <span class=\"keyword\">new</span> MyClass();</span><br></pre></td></tr></table></figure>\n\n<p>and turns it into this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MyClass c = <span class=\"keyword\">new</span> MyClass();</span><br></pre></td></tr></table></figure>\n\n<p>Finally, it may be helpful to point out here that this whole process happens at compile time.  This should be obvious by the fact that this works in both .NET 2.0 code compiled with the CSharp 3.0 compiler as well as .NET 3.x code.  But, sometimes the obvious isn’t obvious until someone states it explicitly.</p>\n",
            "tags": [
                "c#",
                "visual studio",
                "tutorial"
            ]
        },
        {
            "id": "http://davembush.github.com/simple-properties-in-c-3-5/",
            "url": "http://davembush.github.com/simple-properties-in-c-3-5/",
            "title": "Simple Properties in C# 3.5",
            "date_published": "2007-11-22T10:49:00.000Z",
            "content_html": "<p>It’s such a little thing.  But, how much of our CSharp code looks something like this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"built_in\">string</span> _propertyName;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"built_in\">string</span> PropertyName</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">get</span> &#123; <span class=\"keyword\">return</span> _propertyName; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">set</span> &#123; _propertyName = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<span id=\"more\"></span>\n\n<p>When I teach other programmers how to use CSharp (or VB) I always stress the importance of using properties instead of public member variables.  You never know when you’ll want your set to do some sort of validation and just about all of the databinding stuff requires us to use properties instead of member variables.  But, that’s a lot of code to write when all you want to do is wrap a member variable. Well, in CSharp 3.5, life just got a lot sweeter.  That code above just got replace with this:</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"built_in\">string</span> PropertyName &#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>; &#125;</span><br></pre></td></tr></table></figure>\n\n<p>You can still use the code above if you want to.  But, why write all that code, even if you write it using a code snippet, when you can just write that one line?</p>\n",
            "tags": [
                "c#",
                "visual studio",
                "tutorial"
            ]
        }
    ]
}