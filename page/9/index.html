<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>Dave&#39;s Notebook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Dave&#39;s Notebook">
<meta property="og:url" content="http://davembush.github.com/page/9/index.html">
<meta property="og:site_name" content="Dave&#39;s Notebook">
<meta property="og:locale" content="English">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dave&#39;s Notebook">
  
    <link rel="alternate" href="/atom.xml" title="Dave&#39;s Notebook" type="application/atom+xml">
  
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" integrity="sha384-XdYbMnZ/QjLh6iI4ogqCTaIjrFk87ip+ekIjefZch0Y+PvJ8CDYtEs1ipDmPorQ+" crossorigin="anonymous">

  <link rel="stylesheet" href="/css/styles.css">
  

</head>
</html>
<body>
  <nav class="navbar navbar-inverse">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="main-menu-navbar">
      <ul class="nav navbar-nav">
        
          <li><a class=""
                 href="/index.html">Home</a></li>
        
          <li><a class=""
                 href="/archives/">Archives</a></li>
        
      </ul>

      <!--
      <ul class="nav navbar-nav navbar-right">
        
          <li><a href="/atom.xml" title="RSS Feed"><i class="fa fa-rss"></i></a></li>
        
      </ul>
      -->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

  <div class="container">
    <div class="blog-header">
  <h1 class="blog-title">Dave&#39;s Notebook</h1>
  
</div>

    <div class="row">
        <div class="col-sm-8 blog-main">
          
  
    <article id="post-4-reasons-to-drop-mvvm" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/4-reasons-to-drop-mvvm/">4 Reasons To Drop MVVM</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/4-reasons-to-drop-mvvm/" class="article-date"><time datetime="2016-07-27T10:30:00.000Z" itemprop="datePublished">2016-07-27</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>The MVVM design pattern has been around for quite a while now.  It has a lot of strengths when done correctly.</p>
<p>But, I believe the time has come to recognize that MVVM has a lot of shortcomings that point to its demise.  Since I primarily develop web applications, I will keep this discussion centered on the use of MVVM in web applications.  The use of MVVM for desktop may or may not have these same issues.</p>
<p>I realize that for some of you, the very suggestion of dropping MVVM will invoke a negative emotional response.  Some very smart people have quit their job at the suggestion that MVVM and its close cousin two-way data-binding, be abandoned in favor of another way.  But just for a few minutes, I would like for you to stop treating programming as a religion and consider the possibility that there may be a better way.</p>
<p><img src="/uploads/2016/07/image-2.png" alt="image" title="image"></p>
<h2 id="History-of-MVVM"><a href="#History-of-MVVM" class="headerlink" title="History of MVVM"></a>History of MVVM</h2><p>MVVM was originally created by John Gossman to support the XAML syntax used to create Windows™ desktop applications and Silver Light applications.  Its main advantage has always been that it provides an easy way to decouple the View code from any business logic that might need to run.  Because of this decoupling, our applications become much easier to unit test.</p>
<p>The next major implementation of MVVM that I can remember is <a href="//knockoutjs.com/">Knockout</a>.  It is the knockout framework that introduced me to MVVM and I have to say it is also the only one I feel like actually got it right.  By that I mean that it actually did what it was advertised to do.  Maybe that’s because of all the implementations I’ve used, Knockout is the only one that ONLY implemented MVVM rather than making it part of a larger framework.</p>
<h2 id="Definition-of-MVVM"><a href="#Definition-of-MVVM" class="headerlink" title="Definition of MVVM"></a>Definition of MVVM</h2><p>I’ve written about MVVM before where I’ve explained more completely what MVVM is.  But just so we have a working definition of what I mean when I talk about MVVM, let’s define it this way.</p>
<p>MVVM is a design pattern that uses two-way data-binding to get data in and out of the presentation layer, referred to as the View, without the programmer needing to do any more than specifying that this should happen in the view.  MVVM is also able to have data elements and functions in the “ViewModel” track changes so that anything that is dependent on other data is automatically recalculated without the programmer having to write a lot of code to make this happen.  This creates a model that is able to respond to events in the view, but is primarily data centric rather than event centric has we have often reasoned about our applications in the past.</p>
<p>It sounds great.  And when it works it is.  But that’s the main problem, it hardly ever works well.</p>
<h2 id="MVVM-Done-Right-is-Slow"><a href="#MVVM-Done-Right-is-Slow" class="headerlink" title="MVVM Done Right is Slow"></a>MVVM Done Right is Slow</h2><p>If you’ve had any experience or paid any attention to the implementation of MVVM using JavaScript, you will realize that the number one problem with MVVM is that it is a memory hog and performs poorly for all but the most trivial of applications.  In fact, for all of the popularity of Angular JS, the biggest complaint has been around the implementation of the data-binding.  In a large application, you might need to loop through the data multiple times to make sure it has all recalculated correctly.  If you just use the framework and let the framework deal with your sloppy code, this can make the system incredibly slow.  If you actually pay attention to what you are doing, it takes longer to implement than if you had chosen some other design pattern.</p>
<p>But doing that means we have not moved on to…</p>
<h2 id="MVVM-is-Hard-to-Implement"><a href="#MVVM-is-Hard-to-Implement" class="headerlink" title="MVVM is Hard to Implement"></a>MVVM is Hard to Implement</h2><p>Recognizing that looping through the data until it stabilizes may not be a good idea, the framework designers have developed rules such as, “We’ll only run the digest cycle once.”  and “We’ll only run it when some user interaction has occurred.”  Well, OK.  That sounds good.  At least now it will be obvious that I have a problem.  But this is where the trouble begins.  If I can’t rely on my data, and ultimately my view, responding to changes in my data correctly, I am left with having to only partially implementing MVVM so that I can work around these limitations and using other means to make sure my view is updated correctly.</p>
<p>This is to say nothing of many frameworks just not working as you would expect them to.</p>
<h2 id="MVVM-is-Hard-to-Reason-About"><a href="#MVVM-is-Hard-to-Reason-About" class="headerlink" title="MVVM is Hard to Reason About"></a>MVVM is Hard to Reason About</h2><p>Again, in all but the most trivial of applications, and because of the optimizations that various frameworks have tried to implement, MVVM becomes difficult to implement.  As I’ve tried to explain MVVM to others and even as I’ve tried to implement it myself, I’ve found that the simple act of keeping the view stuff in the view layer and the data stuff in the data layer and making sure it all updates appropriately has me, at times tearing my hair out.  Many times this is caused by incomplete implementations.  But if being hard to implement means it is hard to reason about, maybe we shouldn’t be using it to begin with.</p>
<h2 id="MVVM-is-Overkill"><a href="#MVVM-is-Overkill" class="headerlink" title="MVVM is Overkill"></a>MVVM is Overkill</h2><p>But it does work sometimes.  In really simple CRUD applications, it works great.  None of the problems I’ve mentioned.  And this is the great seduction of MVVM.  You try it on some small application and you get excited.  Like a gateway drug, it lures you in.  And when you finally go to implement it on some larger application, you find out that it really doesn’t scale all that well.  And on that small app you tried it on, couldn’t you have done that just as easily using another design pattern?</p>
<h2 id="Where-to-Go-from-Here"><a href="#Where-to-Go-from-Here" class="headerlink" title="Where to Go from Here"></a>Where to Go from Here</h2><p>As I was reviewing these arguments with a co-worker this week, he asked, “Are you saying we shouldn’t be using MVVM?”  And my answer might surprise you.</p>
<p>I said, “Given the two models we have to work within the framework we are currently using, MVVM is the best choice.” However, what we might want to consider is moving to another framework that provides a better design pattern.  There are several “One-way” design patterns that intrigue me.  The first is the basic Flux pattern that React tends to use.  Done correctly, this uses events to achieve the decoupling we all should be striving for.  At its core, it is basic MVC.</p>
<p>The second one, which is very flux like, is RxJS.  I’m still wrapping my head around how I to use it in an application and honestly don’t know enough about it at this point to say any more than that it looks interesting.</p>
<p>And even if we decided to move away from MVVM, I think using two way data-binding between the view and the ViewModel is good.  I just think the ViewModel shouldn’t try to re-compute the values as part of what it does.</p>
<p>Leave that to the developer to control.  The problem is, trying to get existing systems that implement two-way data-binding to only work at that level would not work correctly.  </p>
<h3 id="Other-places-talking-about-MVVM"><a href="#Other-places-talking-about-MVVM" class="headerlink" title="Other places talking about MVVM"></a>Other places talking about MVVM</h3><ul>
<li><a href="//blogs.msdn.microsoft.com/johngossman/2006/03/04/advantages-and-disadvantages-of-m-v-vm/">The Advantages and Disadvantages of MVVM</a> (by John Gossman himself!)</li>
</ul>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/4-reasons-to-drop-mvvm/" data-id="cku1v57gf0004fkx2053isx27" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mvvm/">mvvm</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-test-driven-development-kata-roman-to-arabic-in-javascript" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/test-driven-development-kata-roman-to-arabic-in-javascript/">Test Driven Development Kata - Roman to Arabic in JavaScript</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/test-driven-development-kata-roman-to-arabic-in-javascript/" class="article-date"><time datetime="2016-07-20T10:30:00.000Z" itemprop="datePublished">2016-07-20</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/TDD/">TDD</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>Coding Katas are a way of developing your skills as a programmer.  I thought it might be informative to tackle one of the classics as a blog post. Depending on how this works, I may or may not do another one quite so publicly. The rules I’m going to try to adhere by.</p>
<ol>
<li>I will document what I am doing as I go.</li>
<li>This is not a pre-coded blog post.  You’ll get to “see” me code as I go.</li>
<li>I will write all tests first.</li>
<li><p>I will only write enough code to make the current tests succeed.</p>
<p><img src="/uploads/2016/07/image-3.png" alt="Test Driven Kata - Roman to Arabic" title="Test Driven Kata - Roman to Arabic"></p>
</li>
</ol>
<h2 id="Today’s-problem"><a href="#Today’s-problem" class="headerlink" title="Today’s problem:"></a>Today’s problem:</h2><p>This is a pretty classic coding problem that shows up in interviews, home-work assignments, and code katas.</p>
<p>As an interview problem, I find it lacking because it typically does not represent the kind of work you will be doing other than proving that you can solve problems in your chosen language.  It is also a standard coding problem, meaning the person interviewing you is using the most obvious problem to see if you can code.  Much like asking “What is your greatest strength?” and “What is your greatest weakness?”  Finally, it takes longer to complete than I believe interview coding problems should.  This is not to say, I don’t jump through these hoops myself.</p>
<p>As a kata exercise, it is good because there are several ways you might solve the problem.  And for our purposes, it also demonstrates what Test Driven Development might look like using JavaScript.</p>
<p>So, what is the problem? Write a function that converts Roman numbers into Arabic numbers and throws an error if the Roman number is in an invalid form.</p>
<p>That sounds pretty easy.  But the first question we need to ask is, “What, exactly are the rules for converting Roman numbers into Arabic numbers?”</p>
<ol>
<li>The values for Roman numbers are as follows:</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">Roman</th>
<th style="text-align:center">Arabic</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">V</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td style="text-align:center">X</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center">L</td>
<td style="text-align:center">50</td>
</tr>
<tr>
<td style="text-align:center">C</td>
<td style="text-align:center">100</td>
</tr>
<tr>
<td style="text-align:center">D</td>
<td style="text-align:center">500</td>
</tr>
<tr>
<td style="text-align:center">M</td>
<td style="text-align:center">1000</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>Repeating a number up to three times adds that value three times.</li>
<li>A Roman ‘digit’ can’t repeat more than three times.  Instead the previous 1, 10, or 100 equivalent value is used to subtract from the next ‘digit’.  That is,</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">Roman</th>
<th style="text-align:center">Arabic</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">IV</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center">IX</td>
<td style="text-align:center">9</td>
</tr>
<tr>
<td style="text-align:center">XL</td>
<td style="text-align:center">40</td>
</tr>
<tr>
<td style="text-align:center">XC</td>
<td style="text-align:center">90</td>
</tr>
<tr>
<td style="text-align:center">CD</td>
<td style="text-align:center">400</td>
</tr>
<tr>
<td style="text-align:center">CM</td>
<td style="text-align:center">900</td>
</tr>
</tbody>
</table>
<ol start="4">
<li>With the exception of the subtraction rule above, all values must decrease in scale from left to right and are added together.</li>
</ol>
<h2 id="Test-1"><a href="#Test-1" class="headerlink" title="Test 1"></a>Test 1</h2><p>Since we will be using JavaScript, the testing framework we will be using is Jasmine.</p>
<p>Our first test will simply test that when we pass in “I” we get back 1.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">"I"</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>And the code that passes this test is:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">romanToArabic</span>(<span class="params">romanNumber</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>You might think, what’s the point?  Why just return 1 when you know you are going to have to do more?  Well, when you are doing TDD, you have to work off of what you are testing for now, not what you might test for later.  So, we return 1.</p>
<h2 id="Test-2"><a href="#Test-2" class="headerlink" title="Test 2"></a>Test 2</h2><p>From here, we can go a couple of different directions.  How about testing for rule 3 next.  How would we do that? To start with, we might just make sure that if we pass in IV, we get back 4.  Now our code is getting a bit more complicated.  But sticking with our TDD principles, we’ll just test for IV.  Another happy path test.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">"I"</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">"IV"</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>And the code that implements it:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">romanToArabic</span>(<span class="params">romanNumber</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">switch</span>(romanNumber)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'I'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'IV'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Test-3"><a href="#Test-3" class="headerlink" title="Test 3"></a>Test 3</h2><p>OK.  What happens if IV shows up twice?  That should be a failure.  IV should never show up more than once.  In fact, none of the codes that show up in rule three should show up more than once.  Let’s make sure they don’t.</p>
<p>The tests for this will be pretty simple, and to save time, we will code for all of them at once.  In fact, we are going to eventually need the conversion tables above, so let’s go ahead and put them in now.</p>
<p>Here is what our test file looks like now.  Notice that we’ve put several tests in at once.</p>
<p>Notice that I didn’t have to write multiple tests to do this.  I just created one test and iterated over it.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>And the solution also iterates.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">romanToArabic</span>(<span class="params">romanNumber</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// This block is probably inefficient, but it is</span></span><br><span class="line">    <span class="comment">// easy to reason about.</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">           <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(prop,<span class="string">'g'</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(romanNumber)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'I'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'IV'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Test-4"><a href="#Test-4" class="headerlink" title="Test 4"></a>Test 4</h2><p>Just to make sure we aren’t counting how many times in a row this all shows up, let’s add a valid Roman Number in between.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">'I'</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy + <span class="string">'I'</span> + propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Test-5"><a href="#Test-5" class="headerlink" title="Test 5"></a>Test 5</h2><p>Next, we need to make sure that none of the items in our base table show up more than 3 times.  We’ll write a similar test to what we’ve already written with a twist.  If any of those numerals show up more than 4 times, we know we have a problem either because they are out of order or because they show up all in a row.  So, we only need to check the count.  If there are four of any of them, we have a problem.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">'I'</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy + <span class="string">'I'</span> + propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy+propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>And the code to implement it.function romanToArabic(romanNumber){<br>    var minusOneTable = {<br>        IV: 4,<br>        IX: 9,<br>        XL: 40,<br>        XC: 90,<br>        CD: 400,<br>        CM: 900<br>    };<br>    var baseTable = {<br>        I: 1,<br>        V: 5,<br>        X: 10,<br>        L: 50,<br>        C: 100,<br>        D: 500,<br>        M: 1000<br>    };</p>
<pre><code>// This block is probably inefficient, but it is
// easy to reason about.
for(var prop in minusOneTable){
    if(!minusOneTable.hasOwnProperty(prop)){
       continue;
    }
    var rx = new RegExp(prop,&apos;g&apos;);
    if((romanNumber.match(rx) || []).length &gt; 1){
        throw &apos;Poorly formed Roman number!&apos;;
    }

}
for(var prop in baseTable){
    if(!baseTable.hasOwnProperty(prop)){
        continue;
    }
    var rx = new RegExp(prop,&apos;g&apos;);
    if((romanNumber.match(rx) || []).length &gt; 3){
        throw &apos;Poorly formed Roman number!&apos;;
    }

}

switch(romanNumber){
    case &apos;I&apos;:
        return 1;
    case &apos;IV&apos;:
        return 4;
}
</code></pre><p>}</p>
<h2 id="Test-6"><a href="#Test-6" class="headerlink" title="Test 6"></a>Test 6</h2><p>So, before we move on to actually computing the value of the Roman number, we should ask ourselves if there are any other ways a Roman number could be passed in incorrectly.</p>
<p>The next one that occurs to me is this.  If you have a number that contains a ‘digit’ from the minusOneTable, the character that is used to subtract should never follow the digit.  For example, if “IV” shows up, there should not be an “I” immediately after it.  That is, we shouldn’t see “IVI” anywhere in our string.  So let’s add that to our tests.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">'I'</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy + <span class="string">'I'</span> + propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy+propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        describe(<span class="string">'When '</span> + newProp + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>And the code to implement it:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">romanToArabic</span>(<span class="params">romanNumber</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// This block is probably inefficient, but it is</span></span><br><span class="line">    <span class="comment">// easy to reason about.</span></span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">var</span> rx;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">           <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(prop,<span class="string">'g'</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>),<span class="string">'g'</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(prop,<span class="string">'g'</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(romanNumber)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'I'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'IV'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Step-7"><a href="#Step-7" class="headerlink" title="Step 7"></a>Step 7</h2><p>There is one more possible problem we could encounter.  What if someone passes in a character that isn’t a valid Roman number character.  We need to make sure that the only characters that show up are Roman number characters.</p>
<p>Since testing for all of the characters isn’t practical, we are just going to test for a few and assume that if this were a real business problem we’d go to the trouble of testing more.  But, the basic test is going to look the same.  Toss in bad characters in an otherwise valid string and make sure we throw an error.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">'I'</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy + <span class="string">'I'</span> + propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy+propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        describe(<span class="string">'When '</span> + newProp + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">'2'</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>And the solution, which is pretty simple:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">romanToArabic</span>(<span class="params">romanNumber</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// This block is probably inefficient, but it is</span></span><br><span class="line">    <span class="comment">// easy to reason about.</span></span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">var</span> rx;</span><br><span class="line">    <span class="comment">// make sure minusOne only shows up once</span></span><br><span class="line">    <span class="comment">// and first character isn't also the last character. (IVI for example)</span></span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">           <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(prop,<span class="string">'g'</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>),<span class="string">'g'</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> included = <span class="string">''</span>;</span><br><span class="line">    <span class="comment">// make sure digits only show up 3 times</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        included += prop;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(prop,<span class="string">'g'</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// make sure only I, V, X, L, C and D are the only characters that show up</span></span><br><span class="line">    rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'[^'</span> + included + <span class="string">']'</span>,<span class="string">'g'</span>)</span><br><span class="line">    <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(romanNumber)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'I'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'IV'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Step-8"><a href="#Step-8" class="headerlink" title="Step 8"></a>Step 8</h2><p>OK. I think that gets all of the validations except for ensuring that the numbers show up in numerical order.  To make this work, we are going to need to work through the array and assign each digit a value.  The test we need to write is going to put values in the wrong order.</p>
<p>Our test will put the next value up after the value.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">'I'</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy + <span class="string">'I'</span> + propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy+propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        describe(<span class="string">'When '</span> + newProp + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">'2'</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>And the solution will put them in order and add them along the way.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">romanToArabic</span>(<span class="params">romanNumber</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> minusOneSub = &#123;</span><br><span class="line">        IV: <span class="string">'v'</span>,</span><br><span class="line">        IX: <span class="string">'x'</span>,</span><br><span class="line">        XL: <span class="string">'l'</span>,</span><br><span class="line">        XC: <span class="string">'c'</span>,</span><br><span class="line">        CD: <span class="string">'d'</span>,</span><br><span class="line">        CM: <span class="string">'m'</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> compositeValueTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        v: <span class="number">4</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        x: <span class="number">9</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        l: <span class="number">40</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        c: <span class="number">90</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        d: <span class="number">400</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        m: <span class="number">900</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// This block is probably inefficient, but it is</span></span><br><span class="line">    <span class="comment">// easy to reason about.</span></span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">var</span> rx;</span><br><span class="line">    <span class="comment">// make sure minusOne only shows up once</span></span><br><span class="line">    <span class="comment">// and first character isn't also the last character. (IVI for example)</span></span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">           <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(prop,<span class="string">'g'</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>),<span class="string">'g'</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> included = <span class="string">''</span>;</span><br><span class="line">    <span class="comment">// make sure digits only show up 3 times</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        included += prop;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(prop,<span class="string">'g'</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// make sure only I, V, X, L, C and D are the only characters that show up</span></span><br><span class="line">    rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'[^'</span> + included + <span class="string">']'</span>,<span class="string">'g'</span>);</span><br><span class="line">    <span class="keyword">if</span>((romanNumber.match(rx) || []).length &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// substitute the minusOnes with tokens we can use to compute value.</span></span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="built_in">RegExp</span>(prop,<span class="string">'g'</span>);</span><br><span class="line">        romanNumber = romanNumber.replace(rx,minusOneSub[prop]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> romanNumberArray = romanNumber.split(<span class="string">''</span>);</span><br><span class="line">    <span class="keyword">var</span> returnValue = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> lastValue = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> currentValue = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> numberIndex = <span class="number">0</span>;numberIndex &lt; romanNumberArray.length;numberIndex++)&#123;</span><br><span class="line">        currentValue = compositeValueTable[romanNumberArray[numberIndex]];</span><br><span class="line">        returnValue += currentValue;</span><br><span class="line">        <span class="keyword">if</span>(numberIndex &gt; <span class="number">0</span> &amp;&amp; currentValue &gt; lastValue)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">'Poorly formed Roman number'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        lastValue = currentValue;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> returnValue;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// switch(romanNumber)&#123;</span></span><br><span class="line">    <span class="comment">//     case 'I':</span></span><br><span class="line">    <span class="comment">//         return 1;</span></span><br><span class="line">    <span class="comment">//     case 'IV':</span></span><br><span class="line">    <span class="comment">//         return 4;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Step-9"><a href="#Step-9" class="headerlink" title="Step 9"></a>Step 9</h2><p>And finally we add some test to verify that we get the right result.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">'I'</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy + <span class="string">'I'</span> + propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy+propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        describe(<span class="string">'When '</span> + newProp + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">'2'</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        II: <span class="number">2</span>,</span><br><span class="line">        III: <span class="number">3</span>,</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        VI: <span class="number">6</span>,</span><br><span class="line">        VII: <span class="number">7</span>,</span><br><span class="line">        VIII: <span class="number">8</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        XI: <span class="number">11</span>,</span><br><span class="line">        XII: <span class="number">12</span>,</span><br><span class="line">        XIII: <span class="number">13</span>,</span><br><span class="line">        XIV: <span class="number">14</span>,</span><br><span class="line">        XV: <span class="number">15</span>,</span><br><span class="line">        XVI: <span class="number">16</span>,</span><br><span class="line">        XVII: <span class="number">17</span>,</span><br><span class="line">        XVIII: <span class="number">18</span>,</span><br><span class="line">        XIX: <span class="number">19</span>,</span><br><span class="line">        XX: <span class="number">20</span>,</span><br><span class="line">        XXI: <span class="number">21</span>,</span><br><span class="line">        XXII: <span class="number">22</span>,</span><br><span class="line">        XXIII: <span class="number">23</span>,</span><br><span class="line">        XXIV: <span class="number">24</span>,</span><br><span class="line">        XXV: <span class="number">25</span>,</span><br><span class="line">        XXVI: <span class="number">26</span>,</span><br><span class="line">        XXVII: <span class="number">27</span>,</span><br><span class="line">        XXVIII: <span class="number">28</span>,</span><br><span class="line">        XXIX: <span class="number">29</span>,</span><br><span class="line">        XXX: <span class="number">30</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XLIV: <span class="number">44</span>,</span><br><span class="line">        XLV: <span class="number">45</span>,</span><br><span class="line">        XLVI: <span class="number">46</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        LIV: <span class="number">54</span>,</span><br><span class="line">        LV: <span class="number">55</span>,</span><br><span class="line">        LVI: <span class="number">56</span>,</span><br><span class="line">        LX: <span class="number">60</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        CI: <span class="number">101</span>,</span><br><span class="line">        CXI: <span class="number">111</span>,</span><br><span class="line">        CMXCIX: <span class="number">999</span>,</span><br><span class="line">        MDCLXVI: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                returnValue = romanToArabic(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            it(<span class="string">'should return '</span> + romanNumbers[propCopy] ,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(returnValue).toBe(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Review"><a href="#Review" class="headerlink" title="Review"></a>Review</h2><p>What?! I thought we were done? Well, we are and we aren’t.  We have code that works.  But is it the best code we can write? Here is what I like about this code:</p>
<ol>
<li>It is easy to reason about.</li>
<li>It allows me to add additional roman numbers by expanding my tables.  No additional code would be needed. (And while it is hard to represent using Arabic letters, there are additional symbols.)</li>
<li>It works reasonably fast.</li>
</ol>
<p>But, it does seem to me that we might make it a bit more efficient without sacrificing these advantages too much.  And the great news is, since we have our test in place, we can refactor with impunity.  No worries about breaking something because we will know as soon as we have and we can revert back to the code that was working.</p>
<h2 id="Step-12"><a href="#Step-12" class="headerlink" title="Step 12"></a>Step 12</h2><p>One pretty simple change we can make is that our error message is scattered throughout our code.  Let’s make that a variable and just throw the variable.</p>
<p>The other thing I wonder about is how much of our validations can be combined? One check we might safely eliminate at this point is the check to make sure the minus values only show up once.  If any of them were to show up more than once, they would either show up one after the other, which we still can check for, or they would be in the wrong value order which our final check will catch.  So, let’s eliminate that code as well and re-run our tests to make sure nothing broke.</p>
<p>And now that we’ve eliminated that check, we can create one big string for checking conditions like “IVI” into one string and check it once instead of creating a new RegExp object multiple times.</p>
<p>Here is the code we have so far:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">'I'</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy + <span class="string">'I'</span> + propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy+propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        describe(<span class="string">'When '</span> + newProp + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">'2'</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        II: <span class="number">2</span>,</span><br><span class="line">        III: <span class="number">3</span>,</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        VI: <span class="number">6</span>,</span><br><span class="line">        VII: <span class="number">7</span>,</span><br><span class="line">        VIII: <span class="number">8</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        XI: <span class="number">11</span>,</span><br><span class="line">        XII: <span class="number">12</span>,</span><br><span class="line">        XIII: <span class="number">13</span>,</span><br><span class="line">        XIV: <span class="number">14</span>,</span><br><span class="line">        XV: <span class="number">15</span>,</span><br><span class="line">        XVI: <span class="number">16</span>,</span><br><span class="line">        XVII: <span class="number">17</span>,</span><br><span class="line">        XVIII: <span class="number">18</span>,</span><br><span class="line">        XIX: <span class="number">19</span>,</span><br><span class="line">        XX: <span class="number">20</span>,</span><br><span class="line">        XXI: <span class="number">21</span>,</span><br><span class="line">        XXII: <span class="number">22</span>,</span><br><span class="line">        XXIII: <span class="number">23</span>,</span><br><span class="line">        XXIV: <span class="number">24</span>,</span><br><span class="line">        XXV: <span class="number">25</span>,</span><br><span class="line">        XXVI: <span class="number">26</span>,</span><br><span class="line">        XXVII: <span class="number">27</span>,</span><br><span class="line">        XXVIII: <span class="number">28</span>,</span><br><span class="line">        XXIX: <span class="number">29</span>,</span><br><span class="line">        XXX: <span class="number">30</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XLIV: <span class="number">44</span>,</span><br><span class="line">        XLV: <span class="number">45</span>,</span><br><span class="line">        XLVI: <span class="number">46</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        LIV: <span class="number">54</span>,</span><br><span class="line">        LV: <span class="number">55</span>,</span><br><span class="line">        LVI: <span class="number">56</span>,</span><br><span class="line">        LX: <span class="number">60</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        CI: <span class="number">101</span>,</span><br><span class="line">        CXI: <span class="number">111</span>,</span><br><span class="line">        CMXCIX: <span class="number">999</span>,</span><br><span class="line">        MDCLXVI: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                returnValue = romanToArabic(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            it(<span class="string">'should return '</span> + romanNumbers[propCopy] ,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(returnValue).toBe(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Step-11"><a href="#Step-11" class="headerlink" title="Step 11"></a>Step 11</h2><p>Now that we have our IVI check down to one string, it occurs to me that we can combine this check with our invalid character check.  So, let’s do that next.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">'I'</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy + <span class="string">'I'</span> + propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy+propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        describe(<span class="string">'When '</span> + newProp + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">'2'</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        II: <span class="number">2</span>,</span><br><span class="line">        III: <span class="number">3</span>,</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        VI: <span class="number">6</span>,</span><br><span class="line">        VII: <span class="number">7</span>,</span><br><span class="line">        VIII: <span class="number">8</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        XI: <span class="number">11</span>,</span><br><span class="line">        XII: <span class="number">12</span>,</span><br><span class="line">        XIII: <span class="number">13</span>,</span><br><span class="line">        XIV: <span class="number">14</span>,</span><br><span class="line">        XV: <span class="number">15</span>,</span><br><span class="line">        XVI: <span class="number">16</span>,</span><br><span class="line">        XVII: <span class="number">17</span>,</span><br><span class="line">        XVIII: <span class="number">18</span>,</span><br><span class="line">        XIX: <span class="number">19</span>,</span><br><span class="line">        XX: <span class="number">20</span>,</span><br><span class="line">        XXI: <span class="number">21</span>,</span><br><span class="line">        XXII: <span class="number">22</span>,</span><br><span class="line">        XXIII: <span class="number">23</span>,</span><br><span class="line">        XXIV: <span class="number">24</span>,</span><br><span class="line">        XXV: <span class="number">25</span>,</span><br><span class="line">        XXVI: <span class="number">26</span>,</span><br><span class="line">        XXVII: <span class="number">27</span>,</span><br><span class="line">        XXVIII: <span class="number">28</span>,</span><br><span class="line">        XXIX: <span class="number">29</span>,</span><br><span class="line">        XXX: <span class="number">30</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XLIV: <span class="number">44</span>,</span><br><span class="line">        XLV: <span class="number">45</span>,</span><br><span class="line">        XLVI: <span class="number">46</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        LIV: <span class="number">54</span>,</span><br><span class="line">        LV: <span class="number">55</span>,</span><br><span class="line">        LVI: <span class="number">56</span>,</span><br><span class="line">        LX: <span class="number">60</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        CI: <span class="number">101</span>,</span><br><span class="line">        CXI: <span class="number">111</span>,</span><br><span class="line">        CMXCIX: <span class="number">999</span>,</span><br><span class="line">        MDCLXVI: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                returnValue = romanToArabic(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            it(<span class="string">'should return '</span> + romanNumbers[propCopy] ,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(returnValue).toBe(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Step-12-1"><a href="#Step-12-1" class="headerlink" title="Step 12"></a>Step 12</h2><p>And the last place we can optimize is our three digit check.  But instead of limiting it to valid Roman numbers, let’s just check for any sequence of characters that repeats 4 times or more.</p>
<p>And once we know that is working, we can combine it with our other Regular Expressions.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">'I'</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy + <span class="string">'I'</span> + propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy+propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        describe(<span class="string">'When '</span> + newProp + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">'2'</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        II: <span class="number">2</span>,</span><br><span class="line">        III: <span class="number">3</span>,</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        VI: <span class="number">6</span>,</span><br><span class="line">        VII: <span class="number">7</span>,</span><br><span class="line">        VIII: <span class="number">8</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        XI: <span class="number">11</span>,</span><br><span class="line">        XII: <span class="number">12</span>,</span><br><span class="line">        XIII: <span class="number">13</span>,</span><br><span class="line">        XIV: <span class="number">14</span>,</span><br><span class="line">        XV: <span class="number">15</span>,</span><br><span class="line">        XVI: <span class="number">16</span>,</span><br><span class="line">        XVII: <span class="number">17</span>,</span><br><span class="line">        XVIII: <span class="number">18</span>,</span><br><span class="line">        XIX: <span class="number">19</span>,</span><br><span class="line">        XX: <span class="number">20</span>,</span><br><span class="line">        XXI: <span class="number">21</span>,</span><br><span class="line">        XXII: <span class="number">22</span>,</span><br><span class="line">        XXIII: <span class="number">23</span>,</span><br><span class="line">        XXIV: <span class="number">24</span>,</span><br><span class="line">        XXV: <span class="number">25</span>,</span><br><span class="line">        XXVI: <span class="number">26</span>,</span><br><span class="line">        XXVII: <span class="number">27</span>,</span><br><span class="line">        XXVIII: <span class="number">28</span>,</span><br><span class="line">        XXIX: <span class="number">29</span>,</span><br><span class="line">        XXX: <span class="number">30</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XLIV: <span class="number">44</span>,</span><br><span class="line">        XLV: <span class="number">45</span>,</span><br><span class="line">        XLVI: <span class="number">46</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        LIV: <span class="number">54</span>,</span><br><span class="line">        LV: <span class="number">55</span>,</span><br><span class="line">        LVI: <span class="number">56</span>,</span><br><span class="line">        LX: <span class="number">60</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        CI: <span class="number">101</span>,</span><br><span class="line">        CXI: <span class="number">111</span>,</span><br><span class="line">        CMXCIX: <span class="number">999</span>,</span><br><span class="line">        MDCLXVI: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                returnValue = romanToArabic(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            it(<span class="string">'should return '</span> + romanNumbers[propCopy] ,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(returnValue).toBe(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Step-13"><a href="#Step-13" class="headerlink" title="Step 13"></a>Step 13</h2><p>We’ve cleaned up about all of the logic we can without hard coding the values.  But I would like to combine the lookup tables next.  I don’t like having three tables.  Let’s see if we can pull those into one table.</p>
<p>The first step to doing this is combining the minusOneTable and baseTable into one table.  To differentiate in the code that is using those tables, we’ll just look at the length of the property.</p>
<p>In the process of doing this, we notice that it would also make sense to combine the substitution table.  And since the values we’ve assigned to the table aren’t even being used at this point, we’ll just use the substitutions instead of the values.</p>
<p>And if we make the value of each element in the baseTable an array, we could combine the values into that table as well.  But that would over complicate our lookup logic when we compute the value.  So, I think we’ll just leave that as it is.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">'I'</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy + <span class="string">'I'</span> + propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy+propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        describe(<span class="string">'When '</span> + newProp + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">'2'</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        II: <span class="number">2</span>,</span><br><span class="line">        III: <span class="number">3</span>,</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        VI: <span class="number">6</span>,</span><br><span class="line">        VII: <span class="number">7</span>,</span><br><span class="line">        VIII: <span class="number">8</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        XI: <span class="number">11</span>,</span><br><span class="line">        XII: <span class="number">12</span>,</span><br><span class="line">        XIII: <span class="number">13</span>,</span><br><span class="line">        XIV: <span class="number">14</span>,</span><br><span class="line">        XV: <span class="number">15</span>,</span><br><span class="line">        XVI: <span class="number">16</span>,</span><br><span class="line">        XVII: <span class="number">17</span>,</span><br><span class="line">        XVIII: <span class="number">18</span>,</span><br><span class="line">        XIX: <span class="number">19</span>,</span><br><span class="line">        XX: <span class="number">20</span>,</span><br><span class="line">        XXI: <span class="number">21</span>,</span><br><span class="line">        XXII: <span class="number">22</span>,</span><br><span class="line">        XXIII: <span class="number">23</span>,</span><br><span class="line">        XXIV: <span class="number">24</span>,</span><br><span class="line">        XXV: <span class="number">25</span>,</span><br><span class="line">        XXVI: <span class="number">26</span>,</span><br><span class="line">        XXVII: <span class="number">27</span>,</span><br><span class="line">        XXVIII: <span class="number">28</span>,</span><br><span class="line">        XXIX: <span class="number">29</span>,</span><br><span class="line">        XXX: <span class="number">30</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XLIV: <span class="number">44</span>,</span><br><span class="line">        XLV: <span class="number">45</span>,</span><br><span class="line">        XLVI: <span class="number">46</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        LIV: <span class="number">54</span>,</span><br><span class="line">        LV: <span class="number">55</span>,</span><br><span class="line">        LVI: <span class="number">56</span>,</span><br><span class="line">        LX: <span class="number">60</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        CI: <span class="number">101</span>,</span><br><span class="line">        CXI: <span class="number">111</span>,</span><br><span class="line">        CMXCIX: <span class="number">999</span>,</span><br><span class="line">        MDCLXVI: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                returnValue = romanToArabic(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            it(<span class="string">'should return '</span> + romanNumbers[propCopy] ,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(returnValue).toBe(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Step-14"><a href="#Step-14" class="headerlink" title="Step 14"></a>Step 14</h2><p>Finally, I think we want to consolidate the loops into one loop.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'tests/roman-to-arabic/RomanToArabic.spec.js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        CD: <span class="number">400</span>,</span><br><span class="line">        CM: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        D: <span class="number">500</span>,</span><br><span class="line">        M: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    describe(<span class="string">'When I is passed in'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'I'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    describe(<span class="string">'When IV is passed in'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            returnValue = romanToArabic(<span class="string">'IV'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        it(<span class="string">'should return 4'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            expect(returnValue).toBe(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">'I'</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy + <span class="string">'I'</span> + propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + prop + prop + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy+propCopy+propCopy+propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.substr(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        describe(<span class="string">'When '</span> + newProp + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">'2'</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            it(<span class="string">'should throw an exception'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;romanToArabic(propCopy)&#125;).toThrow();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        I: <span class="number">1</span>,</span><br><span class="line">        II: <span class="number">2</span>,</span><br><span class="line">        III: <span class="number">3</span>,</span><br><span class="line">        IV: <span class="number">4</span>,</span><br><span class="line">        V: <span class="number">5</span>,</span><br><span class="line">        VI: <span class="number">6</span>,</span><br><span class="line">        VII: <span class="number">7</span>,</span><br><span class="line">        VIII: <span class="number">8</span>,</span><br><span class="line">        IX: <span class="number">9</span>,</span><br><span class="line">        X: <span class="number">10</span>,</span><br><span class="line">        XI: <span class="number">11</span>,</span><br><span class="line">        XII: <span class="number">12</span>,</span><br><span class="line">        XIII: <span class="number">13</span>,</span><br><span class="line">        XIV: <span class="number">14</span>,</span><br><span class="line">        XV: <span class="number">15</span>,</span><br><span class="line">        XVI: <span class="number">16</span>,</span><br><span class="line">        XVII: <span class="number">17</span>,</span><br><span class="line">        XVIII: <span class="number">18</span>,</span><br><span class="line">        XIX: <span class="number">19</span>,</span><br><span class="line">        XX: <span class="number">20</span>,</span><br><span class="line">        XXI: <span class="number">21</span>,</span><br><span class="line">        XXII: <span class="number">22</span>,</span><br><span class="line">        XXIII: <span class="number">23</span>,</span><br><span class="line">        XXIV: <span class="number">24</span>,</span><br><span class="line">        XXV: <span class="number">25</span>,</span><br><span class="line">        XXVI: <span class="number">26</span>,</span><br><span class="line">        XXVII: <span class="number">27</span>,</span><br><span class="line">        XXVIII: <span class="number">28</span>,</span><br><span class="line">        XXIX: <span class="number">29</span>,</span><br><span class="line">        XXX: <span class="number">30</span>,</span><br><span class="line">        XL: <span class="number">40</span>,</span><br><span class="line">        XLIV: <span class="number">44</span>,</span><br><span class="line">        XLV: <span class="number">45</span>,</span><br><span class="line">        XLVI: <span class="number">46</span>,</span><br><span class="line">        L: <span class="number">50</span>,</span><br><span class="line">        LIV: <span class="number">54</span>,</span><br><span class="line">        LV: <span class="number">55</span>,</span><br><span class="line">        LVI: <span class="number">56</span>,</span><br><span class="line">        LX: <span class="number">60</span>,</span><br><span class="line">        XC: <span class="number">90</span>,</span><br><span class="line">        C: <span class="number">100</span>,</span><br><span class="line">        CI: <span class="number">101</span>,</span><br><span class="line">        CXI: <span class="number">111</span>,</span><br><span class="line">        CMXCIX: <span class="number">999</span>,</span><br><span class="line">        MDCLXVI: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.hasOwnProperty(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        describe(<span class="string">'When '</span> + prop + <span class="string">' is added'</span>,(<span class="function"><span class="keyword">function</span>(<span class="params">propCopy</span>)</span>&#123;</span><br><span class="line">            beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                returnValue = romanToArabic(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            it(<span class="string">'should return '</span> + romanNumbers[propCopy] ,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                expect(returnValue).toBe(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Review-1"><a href="#Review-1" class="headerlink" title="Review"></a>Review</h2><p>There are probably a few other optimizations that could be made here.  But I’m afraid that each would sacrifice either the flexibility.  That is, we could hard code the regular expression validations, which would significantly reduce the number of lines of code.  Or we would sacrifice the readability.  Neither of which I am willing to do.</p>
<p>If you are only interested in the result, you can find the finished project at <a href="//github.com/DaveMBush/JavaScriptKatas" title="https://github.com/DaveMBush/JavaScriptKatas">https://github.com/DaveMBush/JavaScriptKatas</a></p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/test-driven-development-kata-roman-to-arabic-in-javascript/" data-id="cku1v582y005ofkx2dju353c6" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kata/">kata</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tdd/">tdd</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-7-reasons-to-evade-ext-js" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/7-reasons-to-evade-ext-js/">7 Reasons To Evade Ext JS</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/7-reasons-to-evade-ext-js/" class="article-date"><time datetime="2016-07-13T10:30:00.000Z" itemprop="datePublished">2016-07-13</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/EXTjs/">EXTjs</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>I’ve worked with Ext JS now for a total of 2.5 years.  First with Ext 4.2 and now with Ext 6.x.</p>
<p>Here’s my experience, and warning, of why you should avoid this disaster of a framework.</p>
<p><img src="/uploads/2016/07/image-1.png" alt="7 Reasons To Evade Ext JS" title="7 Reasons To Evade Ext JS"></p>
<h2 id="Jack-of-All-Trades"><a href="#Jack-of-All-Trades" class="headerlink" title="Jack of All Trades"></a>Jack of All Trades</h2><p>Master of none! One of the great selling points of using Ext JS is the fact that it comes with “Everything you need” to build a web application.  That would be great if it were true.  But the fact of the matter is, it comes with all of the features you need but the features are all only partially implemented.  I’ve complained publicly several times that Sencha can’t possibly be testing the code they release because it only works in their demos.  If you try to use a feature they have documented as being available, you are likely to find that the feature doesn’t actually work.  How is it possible that you’ve written documentation for how something is supposed to work and yet you can release it without it working properly?  I can understand fringe stuff getting by.  We can’t think of every test.  But when this happens over and over again, you start to wonder what exactly they are testing.</p>
<h2 id="A-Wolf-in-Sheep’s-Clothing"><a href="#A-Wolf-in-Sheep’s-Clothing" class="headerlink" title="A Wolf in Sheep’s Clothing"></a>A Wolf in Sheep’s Clothing</h2><p>When I first started with Ext, the only design pattern they had available was what they referred to as MVC.  It took me two months of playing with the framework before I finally realized that what they were calling MVC wasn’t anything the <a href="/designPatterns">Gang of Four</a> would recognize as MVC.  I guess if you have a View, a Model and a Controller, you can call it MVC?  It doesn’t matter that the Models define records in a table or that the Controller is tightly coupled to your view.</p>
<h2 id="Sheep-Without-Legs"><a href="#Sheep-Without-Legs" class="headerlink" title="Sheep Without Legs"></a>Sheep Without Legs</h2><p>OK.  So when they introduced the MVVM architecture I actually started to have just a bit of hope.  Yes, there were still some fundamental issues I have, but MVVM would make this tolerable.  But here is the issue.  Their idea of MVVM is that you would only need to implement it on a per page basis.</p>
<p>Let me try to explain.</p>
<h3 id="Broken-Data-Binding"><a href="#Broken-Data-Binding" class="headerlink" title="Broken Data Binding"></a>Broken Data Binding</h3><p>In my ideal world, when I build a new component, I would build that component using the framework the rest of my application is using.  So my component uses MVVM.  Sencha’s implementation gives you a View, ViewController, and ViewModel.  Mostly this looks more like MVC if you ask me but whatever, it has two-way databinding, so we’ll call it MVVM for now.  If you build a component that lives inside another component, the first thing you’ll discover is that binding only works from the top down.  That is, I can bind data at the outer layer and it will get reflected all of the way in to the inner most component that uses it.  But, if you change the data in the inner most component, it doesn’t reflect back up to the outer most component.  I’ve written a hack for this, and there is no promise from Sencha that this will ever get fixed properly, so I guess my hack is safe.</p>
<h3 id="Broken-Controllers"><a href="#Broken-Controllers" class="headerlink" title="Broken Controllers"></a>Broken Controllers</h3><p>But it gets worse.  While child components can find data in models that are in parent components properly, they can’t find references to functions in controllers in the same way.  This is particularly problematic if you write a component that is a container of other components.  You would naturally want the child components to use the controller from the component that they were declared in.  But if you have an outer component that has your container component as a child and then other components inside of that.  The only way you can control what controller the child most components are going to notify of events is by wrapping the inner most components in their own component with their own controller.  This gets to be awkward when all you want to do is provide an event handler for one control in a column of a grid control.  Again, I have a monkey patch that fixes this, but why did I have to write it? This is just one specific example of my “Jack of All Trades” point that I started with.</p>
<p>We won’t even address the question of if this is really MVVM or not!</p>
<h2 id="Never-Use-the-0-release"><a href="#Never-Use-the-0-release" class="headerlink" title="Never Use the .0 release"></a>Never Use the .0 release</h2><p>I think most of us now are generally conditioned to be wary of the .0 release of anything that hasn’t been developed using Open Source methods.  There just haven’t been enough eyes on the project to ensure that everything works as it should.</p>
<p>But with Sencha, this extends to all of the patch releases at the very least and even into some minor releases.</p>
<p>While the 4.0, 5.0, and 6.0 releases were unacceptably broken, we find that every new patch or minor release that comes out afterward breaks something that was working.  We always have to ask, “Can we live with this?”</p>
<h2 id="All-or-Nothing"><a href="#All-or-Nothing" class="headerlink" title="All or Nothing"></a>All or Nothing</h2><p>As I said at the beginning, Sencha gives you everything.  That sounds good.  You won’t have to go looking for a grid control, or many other common controls you might want to use.</p>
<p>But the bad news is, you can only use controls that were written to be used with Ext.  Which other than what Sencha provides in the framework, doesn’t give you a lot of choices.  Don’t go thinking you’ll supplement Ext with a selection of third party controls.  It’s not going to happen.</p>
<h2 id="Fences-Protect-AND-Isolate"><a href="#Fences-Protect-AND-Isolate" class="headerlink" title="Fences Protect AND Isolate"></a>Fences Protect AND Isolate</h2><p>Up until this point in my post, no one can reasonably argue that anything I’ve said is actually a benefit.  At this point we switch to points that may vary based on how well you know JavaScript, HTML, and CSS.</p>
<p>You see, the good news, and actually a major selling point to many people, is that you can write a web application using Ext without having to know much, if anything about HTML or CSS.  And for that matter even the amount of JavaScript you need to know is relatively limited.</p>
<p>That’s the good news.  The bad news is, if you know anything about any of these, you’ll probably end up frustrated by EXT.  This is because Ext’s JavaScript controls most of the layout.  So if you are used to going into developer tools to tweak the CSS and then applying that to your style sheet, you are going to be very disappointed.  Pretty much nothing you do in developer tools is going to work as you would expect.  And figuring out how to apply those to your code is going to be a lot harder than you are used to.</p>
<h2 id="Their-Way-or-the-Highway"><a href="#Their-Way-or-the-Highway" class="headerlink" title="Their Way or the Highway"></a>Their Way or the Highway</h2><p>Once again, many people see this as an advantage.  And once again if you aren’t familiar with how the rest of the JavaScript world does things, this is going to sound fine.</p>
<h3 id="Sencha-CMD"><a href="#Sencha-CMD" class="headerlink" title="Sencha CMD"></a>Sencha CMD</h3><p>Everything runs through Sencha CMD.  A tool for building all things Ext.  If you want to bundle and minify your code, the standard way of doing this is by using “requires” statements in your code and then running Sencha CMD and have it figure out what you are using and put it all in one bundle.</p>
<p>The problem with this is that there are several much better ways of doing this that are available using Node and various NPM packages.  Again, if you are a JavaScript developer, you are going to wonder what Sencha is thinking.</p>
<h3 id="Ext-define"><a href="#Ext-define" class="headerlink" title="Ext.define()"></a>Ext.define()</h3><p>Another place where proprietary shows up is in how Ext defines “Classes”.  When it was first introduced, TypeScript was new.  But now, we not only have TypeScript, which does much of what Ext does and some things it doesn’t, but we have an evolving JavaScript standard that I’m afraid Sencha won’t be able to keep up with.  They already discourage the use of ‘use strict’;.  Once again, there is only one place where this will get you in trouble, and the work around actually produces more efficient code.  But still, the point is, Sencha is relying on ECMA Script 3 standards while the world has largely moved on to ECMA 2015 and beyond.</p>
<p>Anyhow, my point here is that Ext is not just a framework but also functions, largely, as its own language.  Not quite as much a fork from the standard as Coffee Script, but also not nearly as close to the JavaScript spec as TypeScript.  So while it is still JavaScript, if you are a JavaScript programmer, it isn’t going to feel quite like JavaScript to you.</p>
<h3 id="Themes"><a href="#Themes" class="headerlink" title="Themes"></a>Themes</h3><p>The final place you will find “Proprietary” lurking is with the Themes.  There are several really good CSS frameworks out there.  Sencha uses none of them.  And while the syntax they use for creating themes has been SASS up until Ext 6, now they even have their own proprietary SASS compiler.  Watch out here because they are still using the SASS extensions so you are likely to make some assumptions here that aren’t true because, once again, they’ve only implemented enough of the SASS engine to do what THEY need to do.</p>
<h2 id="VB-All-Over-Again"><a href="#VB-All-Over-Again" class="headerlink" title="VB All Over Again"></a>VB All Over Again</h2><p>Every time I hear someone praise how great Ext is, it is normally because it has everything you need out of the box and allows you to get stuff done quickly.  </p>
<p>Basically the same argument for using Visual Basic back in the day.  And yet I learned to never take a VB job because it almost every instance, while it was possible to write well structured code in Visual Basic, it was generally so difficult to do that the code I would be maintaining would need to be rewritten in order to make any sense of it. Ext suffers the same issue.  There is nothing in Ext to force you to write well structured code.  The code I have had to maintain has almost always followed every anti-pattern known to man.  In this case, this isn’t Sencha’s fault directly other than the fact that the only reason my code tends to be cleaner than most is because I’m more likely to code a fix to an Ext bug than I am to work around the problem with an anti-pattern.</p>
<p>In comparison to other frameworks that are available, if all you want is a tool that will get you a semi working application quickly, and you don’t care so much about having to rewrite it when you need to change it in some way, Ext is your tool.  If on the other hand, you care about design and you want to be able to maintain what you’ve written, you should look elsewhere.</p>
<p>Remember, if it sounds too good to be true, it probably is.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/7-reasons-to-evade-ext-js/" data-id="cku1v57i4000cfkx2ogwwe930" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ext-js/">ext js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sencha/">sencha</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-javascript-bind-for-cleaner-code" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/javascript-bind-for-cleaner-code/">JavaScript bind() for cleaner code</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/javascript-bind-for-cleaner-code/" class="article-date"><time datetime="2016-07-06T10:30:00.000Z" itemprop="datePublished">2016-07-06</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>Several weeks ago, I wrote about <a href="/why-does-javascript-loop-only-use-last-value/">how closures impact calling asynchronous functions</a> in a loop and several ways of dealing with that problem.</p>
<p>In my recent coding, I’ve discovered an even more simple way of dealing with this problem.</p>
<p>In the process, it removes the anonymous function and eliminates the linting error, ‘Don’t make functions within a loop’ You see, I’ve been experimenting with JavaScript <code>bind()</code>.</p>
<p>And as it turns out, we can use bind in multiple situations, including dealing with the closure issue I mentioned a couple of weeks ago.</p>
<figure><img src="/uploads/2016/07/image.png" alt title="JavaScript bind() for cleaner code"><figcaption>Photo credit: <a href="//www.flickr.com/photos/connortarter/4754231502/">Connor Tarter</a> via <a href="//visualhunt.com">VisualHunt</a> / <a href="//creativecommons.org/licenses/by-sa/2.0/">CC BY-SA</a></figcaption></figure>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/javascript-bind-for-cleaner-code/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/javascript-bind-for-cleaner-code/" data-id="cku1v57vs003afkx21e62ck1q" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bind/">bind</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/callbacks/">callbacks</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/currying/">currying</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/events/">events</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-your-programming-resume-is-garbage" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/your-programming-resume-is-garbage/">Your Programming Resume is Garbage</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/your-programming-resume-is-garbage/" class="article-date"><time datetime="2016-06-30T10:30:00.000Z" itemprop="datePublished">2016-06-30</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Interview/">Interview</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>Over the last several years, I’ve had a chance to read a few Programming Resumes.  Or, I should say, TRY to read a few resumes.  But frankly, if the Programming Resume I typically see is common, everyone who reads my blog needs this advice.  I haven’t seen a barely adequate resume in years.  </p>
<p>I’m sick of it.  Oh, it’s good for me of course.  I know my resume is going to stand out as such a unique work of art compared to the others, that I will get a call back right away.  After all, if the competition is so incredibly weak, I don’t even need to try.</p>
<p>On the other hand, as someone who has to read these resumes, I’d like to have something better.</p>
<p>And no, I’m not going to go over the standard “how to make your resume awesome” stuff because evidently most programmers can’t even get the basics down.  Seriously!</p>
<figure><img src="/uploads/2016/06/image-3.png" alt title="Your Programming Resume is GARBAGE!"><figcaption>Photo credit: <a href="//www.flickr.com/photos/ollesvensson/2443240690/">ollesvensson</a> via <a href="//visualhunt.com">Visualhunt.com</a> / <a href="//creativecommons.org/licenses/by/2.0/">CC BY</a></figcaption></figure>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/your-programming-resume-is-garbage/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/your-programming-resume-is-garbage/" data-id="cku1v586t0079fkx2ly8075ie" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/interview/">interview</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/resumes/">resumes</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-exposing-secret-javascript-privates-to-unit-tests" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/exposing-secret-javascript-privates-to-unit-tests/">Exposing Secret JavaScript privates to Unit Tests</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/exposing-secret-javascript-privates-to-unit-tests/" class="article-date"><time datetime="2016-06-23T10:30:00.000Z" itemprop="datePublished">2016-06-23</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>The question comes up all the time, “How do I access JavaScript privates from my Unit Tests?”  And invariably, the purist chimes in with the answer, “you don’t”.</p>
<p>But, isn’t the point of unit testing to allow us to test UNITs?  Why artificially limit our ability to test units if we don’t need to?  If we had the ability to create protected members, wouldn’t we tests those separately? So, what follows is how I surface my private JavaScript members so I can access them during tests without having to make them public during the run of my protection code.</p>
<p><img src="/uploads/2016/06/image-2.png" alt="Exposing Secret JavaScript privates to Unit Tests" title="Exposing Secret JavaScript privates to Unit Tests"></p>
<h2 id="Lean-on-JavaScript"><a href="#Lean-on-JavaScript" class="headerlink" title="Lean on JavaScript"></a>Lean on JavaScript</h2><p>My JavaScript unit testing framework of choice is Jasmine.  Not so much because it does all I would like it to do or because there isn’t something ‘better’ available but because it has become the defacto standard for unit testing JavaScript and nothing else I’ve seen is significantly better.  There is one part of this technique that is going to lean on the fact that I am using Jasmine, but I’m sure you can adapt it to your testing framework.</p>
<p>But first, let’s review how you would create private JavaScript members in the first place.</p>
<h2 id="Creating-Private-Members"><a href="#Creating-Private-Members" class="headerlink" title="Creating Private Members"></a>Creating Private Members</h2><p>In standard ES5 code, a simple object might be defined using syntax that looks something like this.  Recognize there are multiple ways to create objects and things that look like classes in JavaScript.  What follows is just enough code to get the point across.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyClass</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">privateMember</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">publicMember</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        privateMember.apply(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.publicMember = publicMember;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Note that our privateMember is used by publicMember but is not accessible from the outside.  I’m also using apply(this) to pass the context to the privateMember function.  This may not be necessary if you aren’t using this in the privateMember function and you could use privateMember.bind(this) to make this automatic.  That’s one of the interesting things about JavaScript.  There are always multiple ways to achieve the same goal.  None of them particularly better than the other but some more standard than the other.</p>
<p>Notice that the only thing that actually makes our publicMember public is that I’ve attached the function pointer to this.</p>
<h2 id="Exposing-Private-for-Jasmine"><a href="#Exposing-Private-for-Jasmine" class="headerlink" title="Exposing Private for Jasmine"></a>Exposing Private for Jasmine</h2><p>The easiest way I know of to expose the private member variables for Jasmine is to conditionally assign the private members to this if jasmine is defined.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyClass</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">privateMember</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">publicMember</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        privateMember.apply(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.publicMember = publicMember;</span><br><span class="line">    <span class="keyword">if</span>(jasmine)&#123;</span><br><span class="line">      <span class="keyword">this</span>.privateMember = privateMember;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As long as you don’t use the jasmine global variable for something other than jasmine, this should work.</p>
<p>And now you can test your private functions.</p>
<h2 id="What-about-Spys"><a href="#What-about-Spys" class="headerlink" title="What about Spys?"></a>What about Spys?</h2><p>If you are testing your private functions on their own, you’ll probably have a need to place spys on them when you test the other functions in your application that call them.  This is where things get just a bit interesting.</p>
<p>If we leave things as they are, and you place a spy on the function that we exposed, your spy will never get called.  The reason for this is because of the way pointers work.</p>
<p>In our example above, our publicMember() function is going to call our privateMember() function regardless of how we manipulate the this.privateMember pointer.  This is because, while the variables are pointing to the same function, they are still two different variables and, because of the way spys work internally, you’ll end up changing the this.privateMember variable without impacting the call to privateMember().</p>
<p>We need to write a little extra code in our if(jasmine) block to make sure that after we’ve exposed privateMember(), the now public version of privateMember() gets call by publicMember() instead of the private version of privateMember().</p>
<p>To do this we are going to need to play “towers of hanoi” with our variables.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyClass</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">privateMember</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">publicMember</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        privateMember.apply(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> oldPrivateMember;</span><br><span class="line">    <span class="keyword">this</span>.publicMember = publicMember;</span><br><span class="line">    <span class="keyword">if</span>(jasmine)&#123;</span><br><span class="line">        <span class="keyword">if</span>(oldPrivateMember)&#123;</span><br><span class="line">            privateMember = oldPrivateMember;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            oldPrivateMember = privateMember;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.privateMember = privateMember;</span><br><span class="line">        privateMember = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.privateMember();</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The gist of what this new code does is that it captures the pointer to the privateMember() into oldPrivateMember.  Once we have that, we can make this.privateMember point to the original privateMember and then make our original privateMember point to a new method that calls this.privateMember, which is what our spy will call if we’ve set one up.</p>
<p>The if(oldPrivateMember) stuff is just protection code to make sure we don’t do this more times than we need and end up calling this.privateMember up the call stack multiple times until we finally get to the privateMember function we ultimately want to call.  Depending on how you implement classes, you may or may not need this code.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/exposing-secret-javascript-privates-to-unit-tests/" data-id="cku1v57s60029fkx2dwpq29dp" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/test-driven-development/">test driven development</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/unit-test/">unit test</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-why-does-javascript-loop-only-use-last-value" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/why-does-javascript-loop-only-use-last-value/">Why does JavaScript loop only use last value?</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/why-does-javascript-loop-only-use-last-value/" class="article-date"><time datetime="2016-06-16T10:30:00.000Z" itemprop="datePublished">2016-06-16</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>You see variations of the question, “Why does JavaScript loop only use the last value?” on StackOverflow all the time.  At work, the guy that sits next to me just ran into the same issue.  And the answer to the question requires a solid understanding of closures and <a href="/javascript-scope/">variable scope</a>.  Something I’ve <a href="/javascript-scope/">written about in the past</a>.  But, when I went back and looked at that article, I was surprised that I had not covered this particular very common topic.</p>
<p>So, here is the basic scenario.  You have some sort of for/next loop that then calls some asynchronous function.  When the function runs, what you see when the code runs is that the last value of the loop index is the value that gets used in the function for every instance that it gets called.</p>
<figure><img src="/uploads/2016/06/image-1.png" alt title="Why does JavaScript loop only use last value?"><figcaption>Photo credit: <a href="//www.flickr.com/photos/57855544@N00/340654162/">col_adamson</a> via <a href="//visualhunt.com">Visualhunt.com</a> / <a href="//creativecommons.org/licenses/by/2.0/">CC BY</a></figcaption></figure>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/why-does-javascript-loop-only-use-last-value/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/why-does-javascript-loop-only-use-last-value/" data-id="cku1v58690070fkx23jsbowiw" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/closure/">closure</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/loops/">loops</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-3-reasons-agile-will-not-succeed" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/3-reasons-agile-will-not-succeed/">3 Reasons Agile Will Not Succeed</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/3-reasons-agile-will-not-succeed/" class="article-date"><time datetime="2016-06-09T10:30:00.000Z" itemprop="datePublished">2016-06-09</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Agile/">Agile</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>I’ve written about <a href="/categories/Agile/">Agile</a> and <a href="/tags/scrum/">Scrum</a> before and most of my regular readers know that I am a huge fan.  But recently I am starting to believe the Agile movement is doomed.  In fact, the most common response to my enthusiasm for Agile and Scrum is, “Yeah, we tried that once and it was a complete failure.”  Which seems odd to me because in every instance where I’ve been able to implement it, it has worked beautifully.  </p>
<p>So why would I say Agile Will Not Succeed?</p>
<p>The buzz around Agile has become so loud that Agile has moved from strictly a software development thing, to all corners of the business world.  And yet, as much as I believe Agile is the right way to develop software, as a movement, it is doomed for failure. </p>
<p>Why?</p>
<figure><img src="/uploads/2016/06/image.png" alt title="3 Reasons Agile Will Not Succeed"><figcaption>Photo credit: <a href="//www.flickr.com/photos/timevanson/9325191852/">Tim Evanson</a> via <a href="//visualhunt.com">VisualHunt</a> / <a href="//creativecommons.org/licenses/by-sa/2.0/">CC BY-SA</a></figcaption></figure>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/3-reasons-agile-will-not-succeed/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/3-reasons-agile-will-not-succeed/" data-id="cku1v57uk002yfkx2zhajojsm" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/agile/">agile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/failure/">failure</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kanban/">kanban</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scrum/">scrum</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-how-not-to-choose-a-framework" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/how-not-to-choose-a-framework/">How Not to Choose a Framework</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/how-not-to-choose-a-framework/" class="article-date"><time datetime="2016-06-02T10:30:00.000Z" itemprop="datePublished">2016-06-02</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Programming-Best-Practice/">Programming Best Practice</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>In my job as a JavaScript architect, trainer and mentor, I’m often asked, “What’s your favorite framework?”  Or “What is the best framework?” And it surprises people when I give them two answers to that question.</p>
<p>Right now, of the frameworks I’ve looked at, my favorite framework is <a href="/tags/react-js/">React JS</a>.  But if I were picking a corporate framework, at this point I’d probably land on <a href="/angular-2-first-impressions-compared-to-angular-1/">Angular 2.0</a>.</p>
<p>But the question you are probably asking is , “Why two different selections?”  And, I think a more interesting question would be, “How did you select which one to use?” In fact, when I was thinking about writing this post, I was going to title it “How to Choose a JavaScript Framework” but as I considered what I would actually say, I realized that the factors I would use really apply to any language and any time.</p>
<p>But an even more interesting question is this.  What factors are essential when picking out a framework.  If I ignored these questions, what are the cost? So, I give you…</p>
<figure><img src="/uploads/2016/05/image-3.png" alt title="How Not to Choose a Framework"><figcaption>Photo credit: <a href="//www.flickr.com/photos/diversey/980101167/">Tony Webster</a> via <a href="//visualhunt.com">Visual hunt</a> / <a href="//creativecommons.org/licenses/by/2.0/">CC BY</a></figcaption></figure>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/how-not-to-choose-a-framework/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/how-not-to-choose-a-framework/" data-id="cku1v57t6002kfkx26k2mjft2" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular-js/">angular.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ext-js/">ext js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react-js/">react.js</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-3-reasons-you-believe-100-code-coverage-is-impossible" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/3-reasons-you-believe-100-code-coverage-is-impossible/">3 Reasons You Believe 100% Code Coverage Is Impossible</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/3-reasons-you-believe-100-code-coverage-is-impossible/" class="article-date"><time datetime="2016-05-26T10:30:00.000Z" itemprop="datePublished">2016-05-26</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/TDD/">TDD</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>I’ve written about <a href="/categories/TDD/">Test Driven Development</a> before.  I’ve even written about <a href="/100-code-coverage/">100% code coverage</a> before.  And I haven’t written much about it recently because I’ve been focused on JavaScript.  But, I’ve been thinking about the 100% code coverage debate more and I have a few more thoughts on the subject.</p>
<p>You see, the more I practice Test Driven Development, the more inclined I am to believe that there are only three reasons for arguing against 100% code coverage.</p>
<p><img src="/uploads/2016/05/image-2.png" alt="100% Code Coverage" title="100% Code Coverage"></p>
<h2 id="There-is-Something-Wrong-with-Your-Framework"><a href="#There-is-Something-Wrong-with-Your-Framework" class="headerlink" title="There is Something Wrong with Your Framework"></a>There is Something Wrong with Your Framework</h2><p>This will be the easiest one for most people to accept.  It isn’t so personal.</p>
<p>You see, I’ve been learning <a href="/tags/react-js/">React JS</a> and, as I’ve mentioned before, I decided to learn React AND learn to test it at the same time.  The thing that has impressed me from the outset is that ALL the code that I write is testable.  Where a lot of other frameworks are testable except for the View, React JS is ALL testable.</p>
<p>And this got me to thinking, if all the code you write is testable, why wouldn’t you write tests?  In fact, as I wrote in “<a href="/test-driven-learning-an-experiment/">Test Driven Learning, an Experiment</a>”, the process of writing the tests as I go has helped me understand React JS better than if I had not.</p>
<p>But compare this to other frameworks where the View is basically HTML.  There is no really easy way to write tests for HTML.  At least, none that I know about.</p>
<p>And then there are frameworks that seem to do all they can to make it hard to test.  When I was using Ext JS 4.x, I spent two years looking for a way to make my code testable without having to have the View rendered because the way they had implemented “MVC” made loading the view mandatory.  Talk about tight coupling!  Fortunately, now that they’ve implemented MVVM, if you do this correctly, it solves these problems.</p>
<p>Another place where I found testing difficult was with Angular 1.  Most of Angular 1 is quite testable.  It was created with testing in mind.  But as I was trying to add a <a href="//docs.angularjs.org/guide/decorators">decorator</a> to the <a href="//ui-grid.info/">UI Grid</a> component, I found that testing the decorator was quite difficult.  This, I believe, said more about how the UI Grid component had been created than about how the Angular framework was put together.  But this just illustrates my point.  Sometimes, the reason you can’t test has more to do with the tools you are using than any other reason.</p>
<p>Then again, the problem may be you.</p>
<h2 id="There-is-Something-Wrong-with-Your-Code"><a href="#There-is-Something-Wrong-with-Your-Code" class="headerlink" title="There is Something Wrong with Your Code"></a>There is Something Wrong with Your Code</h2><p>Now, arguably, in my last example, the reason I was not able to test the decorator for my Grid was because I was missing some fundamental concept related to testing decorators in general or how that related to the Grid.</p>
<p>The reason I say this is because the one thing I’ve noticed the more I test is this.  The more I practice TDD, the easier TDD becomes.</p>
<p>As I introduce testing into the organizations I work with and as I’ve grown in my own TDD skills, the one thing I’ve noticed is that when we start out learning TDD, it almost always starts out as DDT.  That is, Development Driven Testing.</p>
<p>This is, of course, better than not testing at all, but if you wait until after you’ve written your code, or you develop your code without thinking about how you will test it, you will almost always end up in a situation where you will have to rearrange your code to make it testable.  Untestable code is probably the single biggest reason why code doesn’t get tested.</p>
<p>If you were able to make yourself write your tests first, you would be much more likely to write test for everything you wrote.</p>
<p>This doesn’t help you though if you’ve been tasked with writing tests for all pre-existing code.  Yours on someone else’s.  In this case, the best help I can give you is to recommend the book “<a href="/qayn">Working Effectively With Legacy Code</a>” where Michael Feathers illustrates how to handle a lot of the common scenarios he has run into with various languages and how to untangle the mess so that it can be tested.  I will admit it is a tedious read, but there really is no better resource on the topic.</p>
<h2 id="Lack-of-Experience"><a href="#Lack-of-Experience" class="headerlink" title="Lack of Experience"></a>Lack of Experience</h2><p>The final reason you might want to think that 100% code coverage is impossible is that you simply don’t have enough experience.</p>
<p>As I mentioned above, my own experience has been that the more I practice TDD, the easier it gets.  When I started out, I struggled to write test at all.  Then I got to a point where I would at least attempt to write tests after I’d written some code.  I’m now at the point where I’m writing tests as I code.  Soon, I hope to achieve the ultimate goal of writing test prior to writing the real code.  But even though I wasn’t writing the tests first, I can still say that the tests were driving my development because I knew at some point, I was going to have to test the code with unit tests.</p>
<p>But as I’ve monitored the noise on the Internet about using TDD or not.  As people have discussed how much of their code should be tested.  I wonder, “Just how long has this person been trying to tests?”  Along with that, I wonder, “Do they even want to test?”  My dad used to say, “It is amazing how much I don’t understand when it doesn’t fit my plan.” Let’s face it, for most programmers, writing tests is not nearly as much fun as writing the application.  If this is true, then aren’t you already biased against writing tests for your application?  Wouldn’t you much rather write the app and toss it over the fence for someone else to tests?  I know I would.</p>
<p>Now combine that with the fact that testing is hard, and you have a recipe for excusing yourself from testing as much of your code as possible.</p>
<p>But, if you stick with it.  If you make writing bug free code a personal challenge, you will find that the rewards are worth it.</p>
<p>What would it be like to be THE developer who was always working on new features because no one could find bugs in the features you programmed in the past?  What would that do for your career?</p>
<h2 id="The-100-Code-Coverage-Payoff"><a href="#The-100-Code-Coverage-Payoff" class="headerlink" title="The 100% Code Coverage Payoff"></a>The 100% Code Coverage Payoff</h2><p>I want to conclude with another story that illustrates how writing tests paid off.</p>
<p>I’ve been working on a resource scheduling component for the last several weeks.  The bulk of the logic is that if two resources are scheduled for the same time, I need to be able to display that there is a conflict.  It sounds pretty straight forward until you look at all the various ways items can overlap.  I’ve isolated the logic for this into a class that is quite testable and I had created a test suite with about 400 tests when I was told that along with that requirement, there were a particular set of conditions where what looked like a conflict wasn’t really a conflict.  I needed to show that there was an overlap, but I need to display it in such a way as to indicate that it isn’t a conflict.</p>
<p>As I sat down to add in the new logic, I realized that the path I had been going down wasn’t going to work well given this new scenario.  What I really needed to do is to do some major refactoring.  In fact, you might even say I had to rewrite most of the code I had in place.  Now, in the past, I would have been afraid to tear up all that I had done and start over because it would have meant I would have to retest all that I had already worked on … manually!  But, since I already had tests in place, I was able to 1) commit what I had done so far to version control so I could get it back if I needed and 2) rip up what I had done, rewrite and refactor so that it would work well with the new requirement and 3) retest with the tests I ALREADY had in place.  I’ve added another 100 tests for the new scenarios and I’m pretty confident that the code I’ve written does what it should and doesn’t do what it shouldn’t.</p>
<p>And that whole refactoring exercise took less than 7 hours.</p>
<p>Oh.  And I have 100% code coverage!</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/3-reasons-you-believe-100-code-coverage-is-impossible/" data-id="cku1v57g20002fkx2k3meq75e" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/code-coverage/">code coverage</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tdd/">tdd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/test-driven-development/">test driven development</a></li></ul>


    </footer>
  </div>
  
</article>



  


  <div id="page-nav">
    <nav><ul class="pagination"><li><a class="page-prev" rel="prev" href="/page/8/"><i class="fa fa-chevron-left"></i> Prev</a></li><li><a class="page-number" href="/">1</a></li><li class="disabled"><span class="page-space">&hellip;</span></li><li><a class="page-number" href="/page/7/">7</a></li><li><a class="page-number" href="/page/8/">8</a></li><li class="active"><span class="page-number">9</span></li><li><a class="page-number" href="/page/10/">10</a></li><li><a class="page-number" href="/page/11/">11</a></li><li class="disabled"><span class="page-space">&hellip;</span></li><li><a class="page-number" href="/page/27/">27</a></li><li><a class="page-next" rel="next" href="/page/10/">Next <i class="fa fa-chevron-right"></i></a></li></ul></nav>
  </div>



        </div>
        <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
          
  
  <div class="sidebar-module">
    <h4>Recents</h4>
    <ul class="sidebar-module-list">
      
        <li>
          <a href="/every-programming-issue-solved/">Every Programming Issue Solved</a>
        </li>
      
        <li>
          <a href="/rethinking-action-names-redux-ngrx/">Rethinking Action Names (Redux/NgRX)</a>
        </li>
      
        <li>
          <a href="/how-to-avoid-binding-to-computed-values-in-angular/">How to Avoid Binding to Computed Values in Angular</a>
        </li>
      
        <li>
          <a href="/rxjs-conditional-logic/">rxjs-conditional-logic</a>
        </li>
      
        <li>
          <a href="/fixing-single-responsibility/">Fixing Single Responsibility</a>
        </li>
      
    </ul>
  </div>


  
  <div class="sidebar-module">
    <h4>Archives</h4>
    <ul class="sidebar-module-list"><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2021/09/">September 2021</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2021/05/">May 2021</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2020/11/">November 2020</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2020/10/">October 2020</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2020/09/">September 2020</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2020/06/">June 2020</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2020/01/">January 2020</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/10/">October 2018</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/09/">September 2018</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/08/">August 2018</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/07/">July 2018</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/03/">March 2018</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/02/">February 2018</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/01/">January 2018</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/12/">December 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/11/">November 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/10/">October 2017</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/09/">September 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/08/">August 2017</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/07/">July 2017</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/06/">June 2017</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/05/">May 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/04/">April 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/03/">March 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/02/">February 2017</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/01/">January 2017</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/12/">December 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/11/">November 2016</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/10/">October 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/09/">September 2016</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/08/">August 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/07/">July 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/06/">June 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/05/">May 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/04/">April 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/03/">March 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/02/">February 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/01/">January 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/12/">December 2015</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/11/">November 2015</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/10/">October 2015</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/09/">September 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/08/">August 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/07/">July 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/06/">June 2015</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/05/">May 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/04/">April 2015</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/03/">March 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/02/">February 2015</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/01/">January 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/12/">December 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/11/">November 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/10/">October 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/09/">September 2014</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/08/">August 2014</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/07/">July 2014</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/06/">June 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/05/">May 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/04/">April 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/03/">March 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/02/">February 2014</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/01/">January 2014</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/12/">December 2013</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/11/">November 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/10/">October 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/09/">September 2013</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/08/">August 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/07/">July 2013</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/06/">June 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/05/">May 2013</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/01/">January 2013</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2012/09/">September 2012</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2012/08/">August 2012</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2010/10/">October 2010</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2010/03/">March 2010</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/12/">December 2009</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/10/">October 2009</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/09/">September 2009</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/08/">August 2009</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/07/">July 2009</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/06/">June 2009</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/04/">April 2009</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/03/">March 2009</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/02/">February 2009</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/01/">January 2009</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/12/">December 2008</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/11/">November 2008</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/08/">August 2008</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/07/">July 2008</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/06/">June 2008</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/05/">May 2008</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/04/">April 2008</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2007/11/">November 2007</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2007/10/">October 2007</a><span class="sidebar-module-list-count">1</span></li></ul>
  </div>




        </div>
    </div>
  </div>
  <footer class="blog-footer">
  <div class="container">
    <div id="footer-info" class="inner">
      &copy; 2021 Dave M Bush<br>
      All opinions are my own and do not reflect any company I have or am currently working at.<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

  

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>



<script src="/js/script.js"></script>

</body>
</html>
