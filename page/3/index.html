<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Dave&#39;s Notebook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Dave&#39;s Notebook">
<meta property="og:url" content="http://davembush.github.com/page/3/index.html">
<meta property="og:site_name" content="Dave&#39;s Notebook">
<meta property="og:locale" content="English">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dave&#39;s Notebook">
  
    <link rel="alternate" href="/atom.xml" title="Dave&#39;s Notebook" type="application/atom+xml">
  
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" integrity="sha384-XdYbMnZ/QjLh6iI4ogqCTaIjrFk87ip+ekIjefZch0Y+PvJ8CDYtEs1ipDmPorQ+" crossorigin="anonymous">

  <link rel="stylesheet" href="/css/styles.css">
  

</head>

<body>
  <nav class="navbar navbar-inverse">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="main-menu-navbar">
      <ul class="nav navbar-nav">
        
          <li><a class=""
                 href="/index.html">Home</a></li>
        
          <li><a class=""
                 href="/archives/">Archives</a></li>
        
      </ul>

      <!--
      <ul class="nav navbar-nav navbar-right">
        
          <li><a href="/atom.xml" title="RSS Feed"><i class="fa fa-rss"></i></a></li>
        
      </ul>
      -->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

  <div class="container">
    <div class="blog-header">
  <h1 class="blog-title">Dave&#39;s Notebook</h1>
  
</div>

    <div class="row">
        <div class="col-sm-8 blog-main">
          
  
    <article id="post-thinking-in-javascript" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/thinking-in-javascript/">Thinking in JavaScript</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/thinking-in-javascript/" class="article-date"><time datetime="2017-09-05T10:30:54.000Z" itemprop="datePublished">2017-09-05</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>Over the last week I’ve gradually come to the realization that the fundamental reason why most people have trouble with JavaScript is because it doesn’t fit their mental model of how programming should be done.  This isn’t to say that most programmers don’t manage to achieve their end goal.  But if you sit back and take an objective look at the code we end up writing, you have to admit, the code ends up being quite ugly. Now, this isn’t a dig at the way we’ve been doing things.  We’ve all been doing the best we can with what we have.  But, the JavaScript world has progressed and there is a better mental model that has developed and should even be expanded which will allow us to develop more complex and feature rich applications now and well into the future. [caption id=”attachment_4432” align=”aligncenter” width=”800”]<img src="//blog.dmbcllc.com/wp-content/uploads/2017/09/2017-09-05.jpg" alt="Thinking in JavaScript" title="Thinking in JavaScript"> Photo credit: <a href="//www.flickr.com/photos/froderik/8283727226/">freddie boy</a> via <a href="//visualhunt.com/re/fb4c57">Visual Hunt</a> / <a href="//creativecommons.org/licenses/by-sa/2.0/"> CC BY-SA</a>[/caption] </p>
<h2 id="Where-We’ve-Been"><a href="#Where-We’ve-Been" class="headerlink" title="Where We’ve Been"></a>Where We’ve Been</h2><p>I’ve been saying for years that the thing that holds most programmers back is that they always want to treat whatever new thing they are using like the last thing they were using.  And nowhere has this displayed itself more apparently than with JavaScript. Take the most obvious of examples.  Everyone knows, or should know by now, that JavaScript is not really object-oriented.  And yet, we’ve been trying to force JavaScript to BE object-oriented pretty much from the beginning.  This hasn’t been such a big problem, although one could argue that by trying to make JavaScript object-oriented, we’ve prevented it from being able to do some of the things it does best. Where we really run into trouble is with the event based, and often asynchronous nature of JavaScript.  Think about this.  For years, we’ve been trying to synchronize something that is inherently asynchronous.  And this is where the real trouble begins. First, we had call back.  Then promises.  Now Observables.  Soon async and await.  And while callbacks are how the asynchronous nature of JavaScript is handle under the hood, the others are attempts to tame the asynchronous beast.  Especially async and await.</p>
<h2 id="Why"><a href="#Why" class="headerlink" title="Why?"></a>Why?</h2><p>Now, this is where we are.  Constantly trying to make JavaScript be something it isn’t.  But, why is this? I believe it is because we are trying to impose models onto JavaScript that were useful in our desktop and server-side applications.  MVC, MVVM, Object-Oriented, and others all grew up in a world that was both synchronous, multi-threaded, and lent themselves well to an object-oriented model.  As various frameworks have evolved, the attempt has been to take these familiar models and apply them to an asynchronous, single threaded and not really object-oriented.  From where I sit, I am amazed any of this worked at all.  It seems to me it should have failed long ago.</p>
<h2 id="A-Light-in-The-Darkness"><a href="#A-Light-in-The-Darkness" class="headerlink" title="A Light in The Darkness"></a>A Light in The Darkness</h2><p>Hey, I’ve been stuck in the old school model too.  But, I’m starting to think there may be a better way.  I’ve written about Redux and NgRX a lot on this blog.  I’ve fielded a lot of questions on the Angular slack channel.  Most of the questions revolve around the basic question of handling multiple asynchronous calls for data as part of one action.  All of the questions presuppose you would need to make each of the calls for data and then use some method of waiting for everything to return and assemble the data before moving on.  In each case, I recommend an alternative.  What if, each call was a unique action.  When each returns, another action is fired that places the return data in the appropriate store, or sub store.  In this model, we don’t care when the data comes back.  When it comes back, we deal with it appropriately.</p>
<h2 id="An-Example"><a href="#An-Example" class="headerlink" title="An Example"></a>An Example</h2><p>Let’s go with one of the more common examples I see. I need to make a request for a set of records.  Once I have the results, for each record in the result, I need to go get a set of child records.  Here is how I would deal with this at a very high level using NgRX.  I’m sure this would work for multiple Redux patterns but they may call things by different names.</p>
<ul>
<li>Fire an Action that request the main set of records.</li>
<li>The appropriate Effect responds to the action by making an AJAX call for the data.</li>
<li>When the AJAX call returns,<ul>
<li>fire an Action that puts the main records in the store.</li>
<li>for each record in the result fire an Action asking for the child record(s).</li>
</ul>
</li>
<li>The appropriate Effect(s) responds to the request for child records by making AJAX calls.</li>
<li>When the data returns fire an Action that places the data in the store.</li>
</ul>
<p>Since your view is listening for changes on the entities in your store, it will update as the data comes in.  Even better if you setup a debounce on your listener, the screen will update only when all of the data has been retrieved.</p>
<h2 id="The-Key-Concept"><a href="#The-Key-Concept" class="headerlink" title="The Key Concept"></a>The Key Concept</h2><p>The key concept here is that we no longer care WHEN something happens.  We only care THAT it happens.  And rather than trying to setup forkJoins() or some other mechanism to flatten this all out, our code ends up being quite simple.  Discrete bits of functionality.  And now, all our asynchronous code becomes Reactive code.  We no longer need to flatten anything out.</p>
<h2 id="Server-Side"><a href="#Server-Side" class="headerlink" title="Server Side"></a>Server Side</h2><p>Sadly, on the server side, things aren’t quite so easy.  At best we are tied to an implementation Observables and the various methods of combining Observables.  But I could also see some kind of client/server implementation that used a framework like SignalR or Socket.io so that as the various Observables complete, the data on the client would get updated.  An interesting way to make all of the AJAXy calls rather transparent to the user.</p>
<h2 id="Taking-it-To-the-Next-Level"><a href="#Taking-it-To-the-Next-Level" class="headerlink" title="Taking it To the Next Level"></a>Taking it To the Next Level</h2><p>You may call me a dreamer, but what if we made a JavaScript framework that was all message driven and reactive like I’ve described above?  We’ve done it before. When Windows was first created in ran on single core CPUs.  It was essentially single threaded.  The way it worked was primarily by putting “events” on a que and then sending the events to the appropriate application that needed to know about them. If you applied this model to JavaScript and folded in what I’ve described above, you could easily have a system that appeared to be multi-threaded even though it was single threaded at its core.</p>
<h2 id="Don’t-Throw-the-Baby-Out-…"><a href="#Don’t-Throw-the-Baby-Out-…" class="headerlink" title="Don’t Throw the Baby Out …"></a>Don’t Throw the Baby Out …</h2><p>Now, you may think I’m endorsing throwing out object-oriented JavaScript.  Actually, I think most of the View stuff we do lends itself well to object-oriented programming.  But, most of our business rules lend themselves better to the model I’ve described above.  Functional and Reactive.</p>
<h2 id="What-Do-You-Think"><a href="#What-Do-You-Think" class="headerlink" title="What Do You Think?"></a>What Do You Think?</h2><p>Once again, I ask, what do you think?  I’ll admit that this is just a germ of an idea.  Something you would add?  Some hole in my thinking?  Let me know in the comments below.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/thinking-in-javascript/" data-id="cjiw7ucnj00thdghicd78w1d2" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NgRX/">NgRX</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mvvm/">mvvm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redux/">redux</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-model-view-presenter-angular-testing" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/model-view-presenter-angular-and-testing/">Model View Presenter, Angular, and Testing</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/model-view-presenter-angular-and-testing/" class="article-date"><time datetime="2017-08-29T10:30:33.000Z" itemprop="datePublished">2017-08-29</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Angular-2/">Angular 2</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>While testing Components is possible, it is not easy and is often pointless.  Using the Model View Presenter pattern, or a variation of it, solves the problem. Here’s the deal. Long time readers of my blog know I’ve been a proponent of Unit Testing for a very long time. While I was learning React, I went through the exercise of trying to write test as I was learning.  Now, the great thing about Angular and React is that it is possible to test your components.  The problem with testing components is that you are either testing that your HTML ended up in the right spot, that Angular directives did what they should, or you are evaluating the DOM to verify that component logic worked.  In most cases, putting tests that do any of these at the component level is the wrong way to test. [caption id=”attachment_4427” align=”aligncenter” width=”800”]<img src="//blog.dmbcllc.com/wp-content/uploads/2017/08/2017-08-27.jpg" alt="Model View Presenter, Angular, and Testing" title="Model View Presenter, Angular, and Testing"> Photo credit: <a href="//www.flickr.com/photos/tamworthboroughcouncil/15657023428/">Tamworth Borough Council</a> via <a href="//visualhunt.com/re/e21893">Visualhunt.com</a> / <a href="//creativecommons.org/licenses/by/2.0/"> CC BY</a>[/caption] </p>
<h2 id="Evaluating-HTML"><a href="#Evaluating-HTML" class="headerlink" title="Evaluating HTML"></a>Evaluating HTML</h2><p>Ignoring for a second that setting up a component test is awkward, the question I want to address here is, “is that really an appropriate test?” If all your smart component does is pass data down to dumb component, all you really need to verify is that given a dumb component with an html fragment, and another one with another fragment, they will all end up sequentially after each other.  It is a pretty easy test to setup. But all you’ve ended up testing is that Angular does what it says it will. It won’t tell you what you can’t already see by running the code. Dumb components are even more obvious.  Let’s go for something obvious.  You have a ngFor that allows you to display a list of HTML.  You setup your component so that it has an array of three known items, you pass that into the component, do a change detection cycle, and verify that your HTML displays as expected. Great, you’ve verified that Angular works again.  You will have a hard time convincing me that you’ve really tested anything.</p>
<h2 id="Angular-Directives"><a href="#Angular-Directives" class="headerlink" title="Angular Directives"></a>Angular Directives</h2><p>In this case, you are going to try to verify that when you click on a component, or pass it some data, or… whatever, that Angular does what it should.  Maybe you do need to verify that when you click an element, something else happens.  But this is not the place. You might create an integration test, which would, by definition, take longer to run.  It would be better if you tested this using an end to end test.  But testing this as a unit test, doesn’t tell you much more than that Angular has said that it would. “But, I need to verify that the code in my event handler does what it should!”  You might complain.  Yes, you do, but you don’t need to fire a click event to do that, just call the event handler.</p>
<h2 id="Big-Fat-Hair-Logic"><a href="#Big-Fat-Hair-Logic" class="headerlink" title="Big Fat Hair Logic"></a>Big Fat Hair Logic</h2><p>And then there is that “big fat hairy logic” issue.  You’ve created some sort of component that has some rather complex logic.  OK, that happens.  A grid control is a perfect example.  But, maybe your logic is in the wrong place?</p>
<h2 id="A-Better-Solution"><a href="#A-Better-Solution" class="headerlink" title="A Better Solution"></a>A Better Solution</h2><p>There is a design pattern called “Model View Presenter” Like all of the MV* patterns it aims to separate out logic from the view so that we can test things easier.  It was popular with WebForms in ASP.NET when that was how you wrote ASP.NET web sites.  The way this worked was that you would create an Interface for your WebForm that represented all of the things you wanted to have access to from your logic code.  Your presenter.  All your component or page code did was respond to events on the page and expose data to the data driven forms.  In a lot of ways, Angular isn’t much different from WebForms.  Your TypeScript file is essentially a “code-behind” file and your template is similar to an ASPX page. The beauty of the MVP pattern is that when you do it right, your component has no logic at all.  It renders data and responds to events by calling down to the presenter.  In an Angular world, I doubt the Presenter would ever need to call up to the view.  This is prefect.  Now I can create a test for my component logic in a way very similar to how I would test any other Injectable.  Because Injectables are what we are going to use here.</p>
<h3 id="Injectable-Presenters"><a href="#Injectable-Presenters" class="headerlink" title="Injectable Presenters"></a>Injectable Presenters</h3><p>For the point of illustration, let’s assume that all components would follow this pattern.  Now a simple component would have four files instead of the normal three.</p>
<ul>
<li>*.component.ts</li>
<li>*.component.html</li>
<li>*.component.css</li>
<li>*.component.presenter.ts</li>
</ul>
<p>The *.component.presenter.ts file is our new Injectable.  Any properties in our component would pass on down to the presenter.  Any methods, which should be few to none, would pass on down to the presenter.  The presenter is where we do all the work.</p>
<h3 id="Make-the-Presenter-Available-to-the-Component"><a href="#Make-the-Presenter-Available-to-the-Component" class="headerlink" title="Make the Presenter Available to the Component"></a>Make the Presenter Available to the Component</h3><p>Now, if you’ve studied the Angular tutorials, you probably already know this, but my bet is most people programming the new Angular don’t.  You can make an Injectable available by providing it in a module, or by providing it in a component.  If you provide it in the module, it is globally available.  If you provide it in the component, it is only available to that component or its child components.  This is perfect for our use case here.  So, we provide it in our component and then inject it into our component’s constructor. Everything else we might have injected into our component can now be injected into our presenter.</p>
<h2 id="Look-Ma-No-DOM"><a href="#Look-Ma-No-DOM" class="headerlink" title="Look Ma, No DOM"></a>Look Ma, No DOM</h2><p>The side effect of this pattern is now, the complexity of the methods in our component should be 1.  This means they don’t really need to be tested.  And because they don’t need to be tested, we don’t really need a DOM available to run our tests.  This makes it MUCH easier to use jsDOM to run our unit test without having to wire in a bunch of polyfills just to make it all “work.”</p>
<h2 id="What-Do-You-Think"><a href="#What-Do-You-Think" class="headerlink" title="What Do You Think?"></a>What Do You Think?</h2><p>I’ll admit, I’ve been chewing on this one for several weeks.  I’ve run it past some other programmers I respect and I’ve yet to find any holes in this architecture. Some questions I’m still thinking about:</p>
<ul>
<li>Should we write every component like this for consistency or should we only do this once a component has a method that actually has some logic?</li>
<li>Is there ever a case when a Presenter would need to access the Component or can we safely assume that the pass-through mechanism would be enough?</li>
<li>Did I miss something?</li>
</ul>
<p>Let me know in the comments below.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/model-view-presenter-angular-and-testing/" data-id="cjiw7ucey00lqdghigz17hmq8" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mvp/">mvp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/unit-test/">unit test</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-tyranny-of-emotions" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/the-tyranny-of-emotions/">The Tyranny of Emotions</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/the-tyranny-of-emotions/" class="article-date"><time datetime="2017-08-22T10:30:33.000Z" itemprop="datePublished">2017-08-22</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Opinion/">Opinion</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>Emotions are a weird element of being human.  They can propel us forward or hold us back.  Sometimes they are violent.  Most of the time they whisper. Several events have occurred recently that have me thinking about this more. To start with, I’ve started paying more attention to my health.  There were a lot of things holding me back from this in the past.  But it turns out, most of what was holding me back was just a lie. I’ve started interviewing again.  The nature of what I do means I get to do this a lot.  You’d think I’d get used to it.  But, I don’t like the interview process.  I don’t like changing jobs.  I really don’t like code interviews.  But, I do them because I like having money. Some of the interviews I’ve been on have revealed that managers think in similar short-term ways that I have.  Short-term thinking is so easy to see when it is someone else. [caption id=”attachment_4422” align=”aligncenter” width=”660”]<img src="//blog.dmbcllc.com/wp-content/uploads/2017/08/2017-08-19.png" alt="The Tyranny of Emotions" title="The Tyranny of Emotions"> Photo credit: <a href="//www.flickr.com/photos/whinmobzappmedia/16016836686/">whinmobzappmedia</a> via <a href="//visualhunt.com/re/fb1f6a">VisualHunt</a> / <a href="//creativecommons.org/licenses/by/2.0/"> CC BY</a>[/caption]</p>
<h2 id="Health"><a href="#Health" class="headerlink" title="Health"></a>Health</h2><p>So, the health thing.  I was under the misconception that if I paid more attention to my health, it would take time away from things I would rather be doing.  But, as it turns out, paying attention to my health has more than made up for the time it has taken. I was “afraid” of being uncomfortable.  I admit it.  I’m generally a pain wimp.  I wasn’t looking forward to sweating.  But it turns out, you get use to stuff like that. But the question to ask here is, what was it that was keeping me from trying and what was it that got me started? In a word, fear.  I was afraid I was going to lose the ability to do things that I considered more fun.  I was afraid of the discomfort. But, the thing that got me started was slowly being exposed to the many benefits of living a slightly healthier life style.  I can’t say when exactly I started thinking I might want to make some changes, but I can tell you the first step was asking myself, “what can I do that is sustainable?” I’ve learned, “what can I do?” is the best question I can ask when all that is being offered are reasons why something can’t happen. It turns out, the answer to that question was, “if you got a tread mill, you could start walking every morning in the comfort of your own home.  You wouldn’t have to go outside when it is too hot or too cold. I’ve also learned that walking every morning is a medically proven way to reduce the chances of getting cancer, reduces cholesterol, lowers my resting heart rate, improves confidence, improves brain function, reduces depression and helps me sleep better. Prior to starting to walk every morning, I had already started to focus on my diet.  I’m not particularly over-weight.  But, I’m over-weight for me.  So, I started on a high fat diet.  Lately, I’ve worked in HTC oil, some super food supplements as well as some magnesium oil, and reduced my caffeine intake to the first two hours of my day.  Between this and the walking, I actually have more time in my day and I don’t feel nearly as tired by the end of the work day as I have been. So, the more I focus on my health, the more I want to focus on my health because I’ve found that most of the stuff holding me back from even starting were lies and half-truths.  Not to mention momentum and addictions to unhealthy foods. Here’s a super tip for anyone who is interested in this stuff.  Diet isn’t about will power.  If you are playing the will-power game, you are going to lose.  Your current life-style is formed on food addictions (with the help of food companies) emotions and occasionally the belief that you can’t afford to eat healthy.  The dirty little secret is, if you eat healthy and figure out what the emotional triggers are, the addictions practically take care of themselves.</p>
<h2 id="Interviewing"><a href="#Interviewing" class="headerlink" title="Interviewing"></a>Interviewing</h2><p>I’ve been a contract programmer most of my career.  By definition, most of the places I’ve worked have been about a year and a half long and then I move on.  There are exceptions, but that is the general rule.  And let’s just say that my career has been nice and long.  So, you’d think at some point I would get used to interviewing and switching jobs. But I haven’t.  I’ve never liked new.  And, every job is new.  Every interview is new. But I think the thing I dislike the most is that interviewing is a game that I don’t think anyone has figured out.  The strong temptation is to tell the person interviewing what you think they want to hear.  But, I’ve found I do better if I tell them what I actually believe. And then there is the code interview.  I’ve talked about this several times on this blog before.  I still don’t think it is a good measure of what I can bring to an organization.  But, with all of the “programmers” who can’t do the simple stuff, I acknowledge they are probably necessary. But the problem with code interviews is that they are “test” constructed by other programmers.  Not by a professional testing organization.  This means that the first thing I have to figure out during the interview is, “what are you really asking?”  Also, I might have the right answer, and you might have the wrong answer.  But, I lose if our answers don’t match even if I’m right and the person interviewing me is wrong. As an example, I was once asked how .NET memory management works.  The official answer is, “there is nothing in the .NET specification that says how it should work at all.”  But, the way it has been implemented in Windows is typically the answer people are looking for.  I’ve learned the best answer is the full answer. With all of these problems, why do I continue on? Well, as I’ve mentioned in other post, hopefully, I’ll learn something with each interview.  I’ll either learn something about myself, or I’ll learn some bit of programming that I still need to learn. But the growth experience of doing something hard has benefit too.  If I avoid hard stuff, I learn that hard stuff is bad.  If I do hard stuff, I learn that hard stuff is just hard.  But, it won’t kill me.  Besides, I can’t even say what it is about new stuff that scares me.  It is just that feeling.  And I need to silence that lizard.  This is one reason why I believe in interviewing even if you have a job. I work with a guy who won’t do code interviews.  He says, “I have thirty years of experience, if that’s not good enough for you, I don’t want to work for you.”  And I get it.  But I think secretly, he’s afraid of doing the interview.  I always ask, “why not just do the interview?  The worse that can happen is you don’t get the gig, and you might learn something in the process.”</p>
<h2 id="Hiring-Managers"><a href="#Hiring-Managers" class="headerlink" title="Hiring Managers"></a>Hiring Managers</h2><p>I’ve hit this one at several levels.  Mostly I deal with recruiters.  Most of the recruiters I deal with are just looking for warm bodies.  Having dealt with them on both ends, as a person conducting interviews and as the one looking for work, I can tell you the market is saturated with the “any warm body” variety of recruiter. I hit this in full force this week when I did a phone interview with a lady who works for a company that has a pool of remote developers who work on their client’s programs.  So when we started talking about rate I found out that they pay everyone the same because it makes the math easier for the owner. I’ve interviewed at other places where they seemed more concerned with what they would have me work on than IF they wanted to hire me. I get that the hiring process is difficult, and figuring out my worth might be a crap shoot.  But, let’s take a look at this for a bit. Let’s just say you have 10 programmers who you pay $100K a year each.  You are interviewing someone who can demonstrate that they are twice as productive AND that they’ll be able to improve the productivity of everyone else you already have by at least 10% simply by being on your team, mentoring your existing staff, and implementing process improvements to your organization.  How much value does this 11th programmer possess?  Simple math would indicate at least $300K. But, fear holds us back doesn’t it?  All we hear is that this programmer is asking for a salary that is twice as much as what you’re paying everyone else and think, “I can’t afford that.”  But the reality is, you probably can’t afford to NOT hire them. If you found a diamond mine in a field that was worth $1,000,000 and the land you found the mine in was being sold for $700,000 wouldn’t you find some way to buy the field? Maybe you don’t have $700,000.  And you think, “I can’t afford that.”  But isn’t a better question, “how can I afford that?”</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>So, my challenge this week is, “Don’t let fear hold you back.” Look for a way.  Stop listening to the whispers in your head telling you something can’t be done. Do something hard today and improve by 1%.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/the-tyranny-of-emotions/" data-id="cjiw7uco700u2dghi4zybifbb" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/emotions/">emotions</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/health/">health</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hiring/">hiring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/interview/">interview</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-upgrade-ngrx-4-x" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/how-to-upgrade-ngrx-to-4-x/">How to Upgrade NgRX to 4.x</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/how-to-upgrade-ngrx-to-4-x/" class="article-date"><time datetime="2017-08-15T10:30:42.000Z" itemprop="datePublished">2017-08-15</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Angular-2/">Angular 2</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>This week, I discovered that NgRX 4 had released. Yeah, we skipped over version 3 here too to get in sync with the Angular version numbering. There is a pretty complete upgrade guide that you can find <a href="//github.com/ngrx/platform/blob/master/MIGRATION.md">here</a>.  But, the upgrade guide assumes that you are creating Actions by instantiating a new Action object rather than returning a literal as I’ve been instructing. So, in this week’s post, I plan to cover the exact steps I recommend going through to upgrade to NgRX 4, why I don’t think instantiating an Action if the right way to create new actions, and some possible enhancements you can make once you’ve upgraded to the new version. [caption id=”attachment_4418” align=”aligncenter” width=”750”]<img src="//blog.dmbcllc.com/wp-content/uploads/2017/08/2017-08-15.png" alt="How to Upgrade NgRX to 4.x" title="How to Upgrade NgRX to 4.x"> Photo credit: <a href="//www.flickr.com/photos/smemon/6379436711/">Sean MacEntee</a> via <a href="//visualhunt.com/re/6e8a99">VisualHunt.com</a> / <a href="//creativecommons.org/licenses/by/2.0/"> CC BY</a>[/caption] </p>
<h2 id="Upgrade-NgRX-to-4-x"><a href="#Upgrade-NgRX-to-4-x" class="headerlink" title="Upgrade NgRX to 4.x"></a>Upgrade NgRX to 4.x</h2><h3 id="TypeScript-2-4-x"><a href="#TypeScript-2-4-x" class="headerlink" title="TypeScript 2.4.x"></a>TypeScript 2.4.x</h3><p>As the upgrade mentions, you’ll need to upgrade TypeScript to version 2.4.x and RxJS to 5.4.x before you can upgrade to NgRX 4.  So, the first thing we want to do is that we will want to upgrade to TypeScript 2.4.x.  In your package.json file, find the line that you are currently using to install TypeScript and make sure the version says</p>
<p><code>&quot;typescript&quot;: &quot;^2.4.2&quot;,</code></p>
<p>Then, delete the node_modules/typescript directory and run</p>
<p><code>npm install</code></p>
<p>to install the new version.  Since the Angular CLI uses the version that is local to the project, this will compile your code with TypeScript 2.4.x.  If you aren’t using the CLI, I’m assuming you are smart enough to figure out the tweaks you have to make.</p>
<p>Next, you’ll want to build your project.  You may find that the improved type checking in the 2.4 causes some compile errors you’ll want to fix.  If you are linting with the –type-check option, you’ll want to run your linter and fix any linting errors.</p>
<p>For good measure, you should run your application and make sure it still works.</p>
<h3 id="RxJS-5-4-x"><a href="#RxJS-5-4-x" class="headerlink" title="RxJS 5.4.x"></a>RxJS 5.4.x</h3><p>Now that you have everything working with the new compiler, it is safe to upgrade RxJS.  Again, find the current “rxjs”: “ve.rs.ion” line and change it to <code>&quot;rxjs&quot;: &quot;^5.4.3&quot;,</code> Delete the node_modules/rxjs directory and run <code>npm install</code> to install the new version of RxJS. Similarly, recompile, re-lint and run to verify that nothing has broken. To be clear, the reason we are making these upgrades so incrementally is so that when something doesn’t work, we know what change caused it to not work.</p>
<h3 id="Upgrade-NgRX-Store-and-NgRX-Effects"><a href="#Upgrade-NgRX-Store-and-NgRX-Effects" class="headerlink" title="Upgrade NgRX/Store and NgRX/Effects"></a>Upgrade NgRX/Store and NgRX/Effects</h3><p>Remove @ngrx/core from package.json and change  the version number associated with @ngrx/store and @ngrx/effects.</p>
<p><code>&quot;@ngrx/store&quot;: &quot;^4.0.2&quot;,</code></p>
<p><code>&quot;@ngrx/effects&quot;: &quot;^4.0.2&quot;,</code></p>
<p>Delete node_modules/@ngrx and run <code>npm install</code> to install the new versions.</p>
<p>Now, the fun begins.</p>
<h3 id="Compose-Has-Moved"><a href="#Compose-Has-Moved" class="headerlink" title="Compose Has Moved"></a>Compose Has Moved</h3><p>There is no longer an @ngrx/core.  That’s why we removed the reference to it.  So, we need to change any references in our code that point to</p>
<p><code>import {compose} from &#39;@ngrx/core/compose&#39;;</code></p>
<p>so, they now look like this:</p>
<p><code>import {compose} from &#39;@ngrx/store&#39;;</code></p>
<h3 id="No-payload-on-Action"><a href="#No-payload-on-Action" class="headerlink" title="No payload on Action"></a>No payload on Action</h3><p>One of the big structural changes in version 4 is that payload is no longer part of the Action interface.  I’ll talk more about why I disagree with this change in a bit.  But for now, we just want to get your code running.  So, we are going to create our own Action interface.  Create an action.interface.ts file and place the following code in it:</p>
<p><code>import {Action as NgRXAction} from &#39;@ngrx/store&#39;;</code></p>
<p><code>export interface Action extends NgRxAction {</code></p>
<p><code>payload?: any;</code></p>
<p><code>}</code></p>
<p>If you aren’t familiar with that import statement, the “as” is telling the compiler to import Action but we are going to refer to it AS NgRXAction in this file.  The rest is basic inheritance.</p>
<p>Now, everywhere you are currently importing Action from @ngrx/store, import this new version instead.  OK, we got payload back.  That will help a lot.</p>
<h3 id="Remove-some-code"><a href="#Remove-some-code" class="headerlink" title="Remove some code"></a>Remove some code</h3><p>Some of our code won’t work right now.  So, we need to remove it.  If you are using StoreDevtoolsModeuls (probably in app-stores.module.ts or if you haven’t been following along with how I code, it might still be in app.modules.ts.  Anyhow, you need to remove this.  Might as well remove it from package.json while you are at it. If you are using storeFreeze, you should remove that as well as the export function reducer() code that uses it.  By <a href="//blog.dmbcllc.com/typescript-functional-programming/">using and enforcing linting, any benefit storeFreeze provided can be implemented by using the readonly-keyword and readonly-array lint rules</a>. There may be places where you need to relax this rule simply because you are covering the mutation issue in another equally valid way.  For example, you may have a local array that you are returning from a function.  It is probably OK to mutate the array within the function because you just created it.  What we don’t want to have happen is to mutate existing arrays. So, the function needs to be ReadonlyArray.</p>
<h3 id="reducers-object"><a href="#reducers-object" class="headerlink" title="reducers object"></a>reducers object</h3><p>Next, change the const reducers object to be typed as an ActionReducerMap<object>.  Again, for those of you who may not have followed along with my previous post about using NgRX, we typically take the reducers object that is passed into provideStore() method in NgRX 2.x and make it a variable that we pass in rather than passing it in directly.  This makes maintaining that list easier. Speaking of provideStore(), that’s been replaced with forRoot().  So, you should be able to just change the name on that one.  Oh, and since we removed the reducer() function, we should now pass in the reducers object instead.  If you never had a reducer() function, don’t worry about it.  Just make sure you are passing in the ActionReducerMap<object> object.</object></object></p>
<h2 id="effects"><a href="#effects" class="headerlink" title="effects"></a>effects</h2><p>In NgRX 2, we had to run() each effect we wanted to use.  In NgRX 4, we can pass them all into the EffectModule as an array: <code>EffectsModule.forRoot([     EffectsClass1, EffectsClass2, etc ]);</code></p>
<h3 id="Compile"><a href="#Compile" class="headerlink" title="Compile"></a>Compile</h3><p>Yes, NOW you can finally try to compile, lint and run your code.  You may find that you’ll need to fix up some of your tests in a similar way to how we’ve fixed the code so far. Assuming that everything works, this will allow you to continue on using NgRX 4 as though you were using NgRX 2.  But, you now have some options you didn’t have before.</p>
<h2 id="Feature-Loading"><a href="#Feature-Loading" class="headerlink" title="Feature Loading"></a>Feature Loading</h2><p>The major advantage to upgrading to NgRX 4 is that we can now place our reducers, actions, effects closer to the code that will use them.  In fact, you can pass in an empty array in the forRoot() of both StoreModule and EffectsModule.  To load them with the module that will need them, use StoreModule.forFeature() and EffectsModule.forFeature().</p>
<h2 id="payload-Type-Checking"><a href="#payload-Type-Checking" class="headerlink" title="payload Type Checking"></a>payload Type Checking</h2><p>If you follow the instructions for upgrading on the main site, you’ll see that the way they handle payload type checking is by creating an Action class for each action.  The payload gets passed into the constructor when you create the object and gets assigned to whatever variable you decide to use.  Since the parameter is typed, you automatically get type checking.  While this method works, there is a significant issue that isn’t being discussed.  It takes significantly longer to new up an object in JavaScript than it does to use an object literal as we’ve been doing on our sites.  Grant it, no one will probably notice, but since we will be creating a lot of object during the course of the application, this is something to consider. I also find the syntax to use this method awkward. store.dispatch(new actionGroup.actionClass(payloadThing)); instead of store.dispatch(ActionClass.actionMethod(payloadThing)); It may not be obvious in the code above, but “actionGroup” is only what we named the group when we imported the action classes that actionClass() is a part of.  Something the compiler won’t pick up on if you decide to change the name. Either way at this point in the game, we have options.  You can use the official way, or you can use my way.  What I would do instead is that I would create an action interface for each reducer.  If you’ve been using NgRX for a while, you’ll already know that the payload is generally always the same, but occasionally varies.  For example, you might have a get() and delete() method that take an ID as a parameter, but your save() and update() methods would take structures.  Your action interface could end up looking like this: <code>import {Action} from &#39;@ngrx/store&#39;;</code> <code>export interface thingAction extends Action {</code> <code>id?: number;</code> <code>payload?: ThingModel</code> <code>}</code> Then, when you were using get() or delete() you would look at “id” and if you were using update() or add() you would use payload.  You still get strong typing. But your code is much more efficient, more object oriented, and the compiler takes care of naming changes in a way the official way does not.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/how-to-upgrade-ngrx-to-4-x/" data-id="cjiw7ucp200uodghioy2p7muv" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NgRX/">NgRX</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RxJS/">RxJS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-angular-observable-secrets-revealed" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/angular-observable-secrets-revealed/">Angular Observable Secrets Revealed</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/angular-observable-secrets-revealed/" class="article-date"><time datetime="2017-08-08T10:30:11.000Z" itemprop="datePublished">2017-08-08</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Angular-2/">Angular 2</a> / <a class="article-category-link" href="/categories/Angular-2/RxJS/">RxJS</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>If you’ve been programming JavaScript based applications for any length of time, you’ve probably already made the progression from callback hell to promises, but just to recap.  Whenever we make any kind of asynchronous call in JavaScript, we need to provide a callback function to the call so that, when the call completes, the function can be called with any resulting data.  Function calls you may typically make that need this kind of feature are <code>setTimeout()</code>, <code>setInterval(),</code> and AJAX calls using the various libraries that support this. The problem with using callbacks is that you can end up with “Callback Hell” where you have callbacks inside of other callbacks.  Our code becomes messy and difficult to reason about. To try to flatten this situation out, promises were created.  Instead of creating a callback function and passing it into the asynchronous function, the asynchronous function returns a promise that has a function we can pass our function into.  This function can return yet another promise.  The result is that instead of having nested callbacks, all of our callbacks live at the same level. However, in the process, we lost the ability to cancel an asynchronous function using callbacks.  Most of the time, this was not a huge concern, but in the case of AJAX calls, we did end up making more request than we really needed to.  Most people never even recognized this as an issue.  But if you go and take a look at some of your older code, you will see that you have several places where the code would work more efficiently if you were able to cancel a call that was being superseded by a new call. Meanwhile, some additional functions were added to JavaScript Arrays.  Maybe you’ve seen some of them?  map(), reduce(), and filter() are three of the more common functions. What?  You haven’t seen these?  If you have and you know how they work, you can skip this next section.  But, if you haven’t, pay careful attention because this next section is critical to understanding how Observables work. [caption id=”attachment_4415” align=”aligncenter” width=”800”]<img src="//blog.dmbcllc.com/wp-content/uploads/2017/08/2017-08-08.jpg" alt="Angular Observable Secrets Revealed" title="Angular Observable Secrets Revealed"> Photo via <a href="//visualhunt.com/re/4ba464">VisualHunt.com</a>[/caption] </p>
<h2 id="Array-Functions"><a href="#Array-Functions" class="headerlink" title="Array Functions"></a>Array Functions</h2><h3 id="map"><a href="#map" class="headerlink" title="map()"></a>map()</h3><p>Let’s say you have a list of objects that you need to transform into another form.  In the example below, we want to transform our list of objects into a list that can be used in a dropdown list using fullName for the display and id for the value. Without using <code>map()</code>, your code might look something like this: The thing is, we do most of the code from <code>newArray = []</code> on down over and over again.  It is only the code in the <code>push()</code> that changes. What if we were to make the code into a function?  That’s what <code>map()</code> does.  It takes a function as a parameter that takes an item as a parameter.  Inside the function, we use that item to specify how we want to transform the item and the whole map() function returns the new array. The code above, turns into this.</p>
<h3 id="filter"><a href="#filter" class="headerlink" title="filter()"></a>filter()</h3><p>Now, let’s say that for some reason, you only want to include items in the new array that include a last name that starts with ‘B’. Our old style code would look something like this: And once again, this is code we tend to write quite a bit.  So, what if we had a function that did this for us? This is exactly what the <code>filter()</code> function is for.  So, rewriting the code above using <code>filter()</code> would look like this.</p>
<h3 id="Chaining"><a href="#Chaining" class="headerlink" title="Chaining"></a>Chaining</h3><p>Once again, you can see that we passed in a function that takes the current item as a parameter.  The function returns true or false.  If it returns true, the item gets included in the new array. What if we want to filter AND transform the data? The temptation for programmers new to this model is to use the map and push the item into an array that was declared outside of the map. But that really isn’t all that much better than if we were just using a for/next loop like we’ve been doing.  Old habits die hard. Instead, we can take advantage of function chaining. What this allows us to do is to filter and then map. So much cleaner.</p>
<h3 id="reduce"><a href="#reduce" class="headerlink" title="reduce()"></a>reduce()</h3><p>The final useful function we have available to us for dealing with common array loops is reduce().  reduce() allows to loop through an array and accumulate the items in an array into another array, an object, or a value. The reduce() function take two parameters.  The first parameter is a function.  The second parameter is the starting value for the accumulator. The function that we pass in takes three parameters.  The current value of the accumulator, the current item, and the current item index.  Most people only use the first two parameters in their function.  The function returns the new accumulator value that then gets passed into the next call to the function. So, a really simple example would be, given an array of numbers, add them all up. I’ve also used this to turn an array of name/value pairs into an object where the properties are the name and the values are the values that were paired with the names.</p>
<h2 id="Events-as-Arrays"><a href="#Events-as-Arrays" class="headerlink" title="Events as Arrays"></a>Events as Arrays</h2><p>Now, imagine that events that fire are part of one long continuous array.  An array that never ends. If this were true listening to events would be as familiar as processing an array. This is all an observable is.  It treats everything as though it were an array, adds several other functions that give us even greater functionality, and several functions that allow us to deal with the fact that events are not only sequential, but also time based. And because events aren’t really arrays, we call this series of items a “stream.”  So, when you read about “streams” while working with Observables think, “list of items.”</p>
<h3 id="Button-Click"><a href="#Button-Click" class="headerlink" title="Button Click"></a>Button Click</h3><p>For example, let’s say you have a button on your screen and you want to know when it is pressed.  Let’s say your button is represented by a member variable name “myButton”.  In your code, you would listen to a button click by writing code that looks something like: You will notice that we used the <code>subscribe()</code> function instead of <code>map()</code>.  We still have a <code>map()</code> function.  But, <code>subscribe()</code> is how we tell the application, “we want to start listening to the stream now.”  Otherwise, <code>subscribe()</code> works just like map() does. Yes, I know what you’re thinking.  “How is that better than just having the template call an event handler?” Well, the fact of the matter is, it really isn’t all that much better.  But, here is where it does make more sense.</p>
<h3 id="Debouncing-Keystrokes"><a href="#Debouncing-Keystrokes" class="headerlink" title="Debouncing Keystrokes"></a>Debouncing Keystrokes</h3><p>If you’ve been writing application in JavaScript for a while, I’m sure you’ve written classic debounce handlers.  You know.  Don’t actually fire this event until you are no longer receiving change events from the input field. I won’t write out the old code here.  It is relatively long, hard to follow, and therefore somewhat complicated. But here is how we handle it using Observables. <code>debounceTime(250)</code> tells the Observable to wait for 250 milliseconds to see if there is some other event that comes in and use that event instead.  That is much easier than the old way.</p>
<h3 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h3><p>While you could handle button clicks and debounce logic using old school JavaScript tricks, in Angular, it is practically impossible to make an AJAX call without using Observables.  This is because the <code>Http</code> service and the <code>HttpClient</code> that was introduced in Angular 4.3 use Observables instead of callbacks or promises to manage dealing with the data that eventually is returned from the AJAX call. Since <code>Http</code> and <code>HttpClient</code> are similar, we will continue our discussion of handling AJAX calls using <code>HttpClient</code>.  The main advantage to using <code>HttpClient</code> is that it handles parsing the response into a JavaScript object we can use.  <code>Http</code> just returns the raw Response object and parsing it out is up to us. <code>HttpClient</code>, on the other hand, returns the object we would have parsed out with <code>Http</code>. So, assuming you’ve injected HttpClient into the class that is going to use it, a typical get might looks something like this: So, walking through this, you may notice that some things look very similar to Promises and then, there are some other things that aren’t so much.  But trust me this gets much better.  We are just starting out small. First, what is that <code>TypeInfo</code> thing? You see, our get call is what is normally referred to as a “templated method.”  In simple terms, get doesn’t know what type it returns until you tell it.  So, we are telling it that it returns a <code>TypeInfo</code> type.  <code>TypeInfo</code> is just a name I made up.  You would create an interface that is relevant to the type of information that your AJAX code is returning. Other than that, we subscribe to the observable that get() returns and process the data. But what if our get call fails? Oh! We have methods for that. First, we can trap failures with a <code>catch()</code> call. But, maybe you want to <code>retry</code> the failed call before you give up. And because we have a <code>catch()</code>, with must have a <code>finally</code> too, right? Try doing all of that with a Promise or a Callback. Oh, and did I mention you can cancel AJAX calls using Observables?  Yep.  It’s true.  In fact, my experience has been that if you make the same call from the same service two times in a row, it will cancel the first call before it makes the second.  Pretty cool. The final thing that tends to trip people up who are learning about Observables is that nothing in the observable chain executes until you subscribe to the observable and an event happens. Once you start getting comfortable with all of the methods you have available to you, you’ll begin to see the power of using Observables over using Promises or Callbacks, even if there are similarities.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/angular-observable-secrets-revealed/" data-id="cjiw7uc1n007jdghip9wo8cvj" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RxJS/">RxJS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/observables/">observables</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-typescript-basics-angular-developers" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/typescript-basics-for-angular-developers/">TypeScript Basics for Angular Developers</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/typescript-basics-for-angular-developers/" class="article-date"><time datetime="2017-08-01T10:30:30.000Z" itemprop="datePublished">2017-08-01</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Angular-2/">Angular 2</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>For the most part, TypeScript feels a lot like JavaScript.  Most people pick it up without having any formal training.   But, here’s the deal.  “Just because you can, doesn’t mean you should.” The thing that makes me most nervous about Angular is that it is structured so that you can write some really clean code.  But, you don’t have to.  Which mean most won’t. In fact, recruiters continue to contact me about Angular jobs with rates that make it obvious that hiring an Angular programmer is the same as hiring an HTML “programmer” 10 years ago.  Sorry gang, JavaScript has grown up and so has Angular. So, here are a few things you need to know about TypeScript that will make you a better Angular developer. [caption id=”attachment_4407” align=”aligncenter” width=”800”]<img src="//blog.dmbcllc.com/wp-content/uploads/2017/07/TypescriptBasicsForAngular.jpg" alt="TypeScript Basics for Angular Developers" title="TypeScript Basics for Angular Developers"> Photo credit: <a href="//www.flickr.com/photos/mujitra/8059355303/">MIKI Yoshihito. (#mikiyoshihito)</a> via <a href="//visualhunt.com/re/b6d829">VisualHunt.com</a> / <a href="//creativecommons.org/licenses/by/2.0/"> CC BY</a>[/caption] </p>
<h2 id="Variable-Declaration"><a href="#Variable-Declaration" class="headerlink" title="Variable Declaration"></a>Variable Declaration</h2><p>There are three ways of declaring a variable in TypeScript.  You can either use the JavaScript ‘var’ keyword like you’ve always done or you can use the ‘let’ keyword or the ‘const’ keyword. But first, what problem are we trying to solve? In the old JavaScript world, we would declare variables in a block of code, but where-ever we declared that variable, the actual declaration was “hoisted” to the top of the function.  In fact, there never was anything like block scope.  Just function scope. This caused one particular problem that was rather common.  If I created a for/next loop that called an asynchronous function, the asynchronous function would use the last value of the for/next incrementer. The primary benefit of using <code>let</code> or <code>const</code> is that they effectively provide for block level scope so that we can write code like I described above and it will behave in the way we would expect from other languages. Unless you explicitly want to avoid block level scope, you should never use the <code>var</code> keyword to declare a variable in TypeScript.  This falls under the “just because you can, doesn’t mean you should” rule. In my experience, you will use <code>const</code> more often than <code>let</code>.  Here’s the difference. If you are declaring a variable that will only ever be assigned one value, you declare it using <code>const</code>.  What isn’t obvious is that changing the contents of an object does not change the value of an object.  So, doing something like this:</p>
<p><strong>let</strong> myArray = [];  myArray.push({});</p>
<p>Would be more valid as:</p>
<p><strong>const</strong> myArray = [];  myArray.push({});</p>
<p>Because pushing something into the array doesn’t change the value, or the pointer, of myArray.  It only changes the content of the array.</p>
<h2 id="Types"><a href="#Types" class="headerlink" title="Types"></a>Types</h2><p>The main thing that makes TypeScript what it is, is that it allows us to type-check our code.  You don’t have to.  In fact, there are times when this might get in your way.  But, you have a choice. By default, TypeScript uses inference when it can to figure out the type of a variable.  This is important because I can bet one of the first errors you are going to see is a type mismatch error. You might try to do something like this:</p>
<p><strong>let</strong> v = ‘abc’;  // some other code, and then …  v = 20;</p>
<p>That’s not going to compile. But you could do something like this:</p>
<p><strong>let</strong> v: any = ‘abc’;  // some other code, and then …  v = 20;</p>
<p>That is telling the TypeScript compiler that we are OK with the variable v being any type. Other than the Classes and Interfaces that are either part of JavaScript or that we, or a third party, create, there are boolean, number, string, array, enum, any, void, tuple, never, null, and undefined. I’m going to assume that until I mentioned “tuple” you were ok with the types I mentioned.  So, let’s dig a little deeper on those last few. A tuple is a type that wars have been fought over.  OK, well not that bad.  But it is a highly controversial type.  But here is what it lets you do.  It allows you to return a highly defined array or object directly into local variables.  That is, I can specify that a function returns an array or object that has a specific number of elements and each element is a specific type.  It has its uses, but it is probably one of the types that you want to reserve for special cases.  It saves you from having to access array elements or object fields or properties.  That’s the long and short of it. The never type allows you to specify that a function never returns.  There are two reasons why this would be true.  First, you’ve entered an infinite loop or second, you’ve thrown an exception.  Again, not something you are likely to use. You can also explicitly specify that a type can only handle null or undefined.  But what is much more likely is that you specify that you don’t want to use these.</p>
<h2 id="Combined-Types"><a href="#Combined-Types" class="headerlink" title="Combined Types"></a>Combined Types</h2><p>So, let’s say you have a parameter or a variable that accepts multiple types.  You could just use any and go on your merry way.  But, wouldn’t it be nice if you could say, “I want this type to be either a string or a number.”?  Well, you can.  Simply by using the pipe operator between types.</p>
<p><strong>let</strong> v: string | number;</p>
<p>But we can take this even further.  Let’s say we want to make sure that the variable is a particular class type that we also want to be sure implements a specific interface.  For that, we use the ampersand.</p>
<p><strong>let</strong> v: Person &amp; Manager;</p>
<p>And while we are at it, what if we want to make sure that a variable only accepts string types that are not null or undefined?  By default, the compiler allows null and undefined to be assigned to anything, but there is a compiler switch that turns that feature off.  If you use the compiler switch and you want to allow null or undefined, you’ll need to use the pipe operator to include them.</p>
<h2 id="Interface"><a href="#Interface" class="headerlink" title="Interface"></a>Interface</h2><p>For the most part, a TypeScript Interface looks a lot like an Interface in other languages, but there are some differences that you need to know about. First, you don’t need to create a class that implements an Interface and then instantiate an object from that class in order to have an object of a particular interface type.  Actually, if you stop to think about it, this makes sense.  The problem is, there are a lot of people teaching TypeScript who are still using interfaces this way. But, in JavaScript, you can create an Object Literal.  TypeScript adds to JavaScript.  So, it only makes sense that TypeScript also allows you to create an Object Literal.  So, let’s say you have a parameter that takes an interface of type Name.  As long as the object we pass in conforms to the interface definition, the code will compile.</p>
<p>// interface Name with firstName and lastName as properties  interface Name {   firstName: string;   lastName: string;  }  // function that takes a Name as a parameter  foo(name: Name) {  }  // call the function with an object literal  foo({firstName: ‘Dave’, lastName: ‘Bush’});</p>
<h2 id="Optional"><a href="#Optional" class="headerlink" title="Optional"></a>Optional</h2><p>We’ve been talking a lot about Parameters and Interfaces.  In both cases, we often want to define a parameter or a property as optional. For example, most people have a middle name, but our Name interface doesn’t account for that.  If we added it, we’d want to make it optional since it is possible for that to not be included.  On the other hand, we don’t want people added whatever they want. The way we make sure a parameter is optional is by placing a question mark after the property, but before the colon.</p>
<p>interface Name {   firstName: string;  // middleName is optional   middleName?: string;   lastName: string;  }  // foo() now takes an optional name parameter  foo(name?: Name) {}</p>
<p>I would highly recommend that you tweak your tslint rules to require type annotations on all of your code.  Out of the box, the tslint rules that come with the Angular-CLI are a bit too lax in this area.</p>
<h2 id="this"><a href="#this" class="headerlink" title="this"></a>this</h2><p>The <code>this</code> keyword in JavaScript is probably the hardest concept to fully understand.  And while recent advances in the language have helped tame it, it still doesn’t fully conform to the model most people have in their mind of how an Object-Oriented language should behave.  This is because, of course, JavaScript isn’t an Object-Oriented language.  It is a Prototypal language.  There are similarities, but they aren’t they same. TypeScript, on the other hand, is more object oriented.  I say “more” because it is really only object-oriented in the places where you are taking advantage of TypeScript specific features, such as a Class.  If you create an object literal that has an inline function, you are back in JavaScript land. In a class, if you have a method that calls another method in the same class, you must use the <code>this</code> keyword to go after it.</p>
<p><strong>class</strong> <strong>SomeClass</strong> {   someFunction() {   }   someOtherFunction() {  <strong>this</strong>.someFunction();   }  }</p>
<p>This may take some getting used to if you are coming from JavaScript where you can call any function that is in scope without using the this keyword.  But, I can assure you that having this rule imposed on the language solves a lot of bugs caused the “this” side effects, that it is well worth the adjustment.</p>
<h2 id="Arrow-Functions"><a href="#Arrow-Functions" class="headerlink" title="Arrow Functions"></a>Arrow Functions</h2><p>Fat Arrow functions, Arrow Functions, or Lambda Expressions all refer to the same concept.  They are probably one of my favorite features of the latest version of TypeScript and JavaScript both because they allow me to write code with fewer characters and because they solve a very real problem that has confused JavaScript developers for years. First the problem. If you’ve written any serious application using JavaScript, one of the following scenarios will be familiar to you. Any time you create an event handler, when the function gets called, the ‘this’ keyword isn’t pointing to the object you are in, it is pointing to the context of the event that fired it.  This could be null, a windows object, or something else.  We often get around this problem by using the bind() function to wrap the context of the function. What the arrow functions in TypeScript do is that they form a closure around the current ‘this’ context by taking advantage of how TypeScript is compiled into JavaScript. You see, when your TypeScript code is compiled, every place you referred to ‘this’ it refers to a variable named ‘_this’.  Inside the arrow function, they refer to this same _this instead of creating a new one or looking at the context the function was called from. The main difference between a regular anonymous function and an arrow function is that we leave out a lot of junk. <strong>let</strong> newFunc = <strong>function</strong>(x) {  // do something with x  }  Compared to:  <strong>let</strong> newFunc = (x) =&gt; {  // do something with x  } But wait! There’s more.  If you only have one line, you can remove the curly braces. Let’s say you want to create an arrow function that returns the square of some number.  You could write this as:</p>
<p><strong>let</strong> newFunct = (x) =&gt; x * x;</p>
<p>Fat arrow functions return the value from the function automatically.</p>
<h2 id="Decorators"><a href="#Decorators" class="headerlink" title="Decorators"></a>Decorators</h2><p>I don’t want to spend a lot of time on decorators.  If you’ve been using .NET, you’ll recognized decorators as “Attributes”. Java programmers are probably used to calling them annotations. Effectively, what a decorator does is that it adds additional information to a function, field, or class that marks it for special use.  While you can create your own decorators, we will only concentrate on implementing decorators that have already been defined for us. You’ll know that something is a decorator because it is a symbol prefixed with the at symbol.</p>
<h2 id="Import-and-Export"><a href="#Import-and-Export" class="headerlink" title="Import and Export"></a>Import and Export</h2><p>Last in our discussion of TypeScript are the keywords import and export. But first, why do we need these keywords? Well, if you are familiar with other languages such as C#, VB.NET or Java, you will recognize the concept of Import as the keyword that says, “Tell this file I’m going to reference code from that other file over there in here.”  And then when we compile our code, the compiler makes sure that we are using that other code correctly. A similar thing happens in TypeScript, but in Angular we get the added benefit of also being able to use this information so that we only include the code we are actually using. You see, in the old days, we would suck in entire JavaScript libraries just because we were using a few functions.  But now with concepts like “Tree Shaking” that we will cover later, we can look at the actual code we are referencing and only include that code.  This reduces the size and number of files that our customer has to download to use our applications. The export keyword, on the other hand, tells the compiler what functions, classes, and interfaces external code is able to reference.  If it isn’t exported, it is only available to code in the file it was declared in.</p>
<h2 id="More"><a href="#More" class="headerlink" title="More"></a>More</h2><p>I have barely scratched the surface of TypeScript here.  There is a lot more available in the language than what I’ve introduced to you here and knowing the parts I’ve left out will ultimately make you a better programmer and make your code more stable.  But the parts I have introduced will get you going and will make you familiar with the parts you will see most often.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/typescript-basics-for-angular-developers/" data-id="cjiw7ucnz00tvdghi8jzs0fxi" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular-2/">angular 2</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/typescript/">typescript</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-typescript-functional-programming" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/enforce-typescript-functional-programming/">Enforce TypeScript Functional Programming</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/enforce-typescript-functional-programming/" class="article-date"><time datetime="2017-07-25T10:30:00.000Z" itemprop="datePublished">2017-07-25</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/none/">none</a> / <a class="article-category-link" href="/categories/none/TypeScript/">TypeScript</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>As consistent readers of this blog are aware, I’ve fallen in love with Functional Programming.  But I also live in a primarily Angular/TypeScript world where some code is still Object Oriented and other code is more Functional in nature.  And while TypeScript lets you do some Functional things, I’ve found it hard to force functional concepts in TypeScript.  So, I’ve gone searching.  Wouldn’t it be great if there were some sort of flag you could set that said, “Hey compiler, I’m in ‘Functional’ mode now!”  And the compiler would make sure that you never used a conditional statement, never accessed hidden parameters, and never mutated state? Well, I think I’ve figured out some of how to manage all of this using nothing more than TypeScript and some TSLint rules. [caption id=”attachment_4402” align=”aligncenter” width=”800”]<img src="//blog.dmbcllc.com/wp-content/uploads/2017/07/2017-07-25.jpg" alt=""> Photo credit: <a href="//www.flickr.com/photos/archer10/15127010075/">archer10 (Dennis) 99M Views</a> via <a href="//visualhunt.com/re/52cd50">VisualHunt.com</a> / <a href="//creativecommons.org/licenses/by-sa/2.0/"> CC BY-SA</a>[/caption] </p>
<h2 id="Immutability"><a href="#Immutability" class="headerlink" title="Immutability"></a>Immutability</h2><p>Several weeks ago, I demonstrated how to <a href="//blog.dmbcllc.com/really-use-ngrx-better/">protect against immutability using freeze</a>.  But, wouldn’t it be better to catch immutability issues at compile time? There are a couple features in TypeScript that do just that. First, we can use the <code>readonly</code> keyword on a field to ensure that it doesn’t change.  And second, we can declare arrays using <code>ReadonlyArray</code>.  For this to be most useful, we are going to want to provide an interface for all of our data that needs to be immutable.  This is how I typically use NgRX.</p>
<h2 id="Enforcing-Functional"><a href="#Enforcing-Functional" class="headerlink" title="Enforcing Functional"></a>Enforcing Functional</h2><p>Now, that is as far as it goes for support in TypeScript itself, as far as I am aware.  But, we can get more support by using TSLint.  If you are using the Angular-CLI, this gets installed when you create your project.  If you aren’t using the Angular-CLI, or you are using some other framework, you are on your own for getting that installed and setup. There are two problems we need to overcome in order to use TSLint to solve our “switch into Functional mode” issue.  First, is that we need a set of rules we can use.  The second is that we will need some way of isolating where those rules take effect. Fortunately, we can create a separate <code>tslint.json</code> file for each directory.  And since all of my Functional code is isolated to my NgRX state management stuff, I can put a file in that directory and it will take care of my Functional needs while leaving my normal <code>tslint.json</code> file for the rest of my code. The other thing you will want to do is that you’ll want to install <a href="//www.npmjs.com/package/tslint-immutable">tslint-immutable.</a> tslint-immutable adds some rules specifically for immutability that are not included in the core implementation.  I love plugable systems. I’ll let you read the documentation on the site for the rules that it adds.  Who knows when you’ll be reading this and the package may have changed by the time you get here.</p>
<h2 id="pre-commit-hooks"><a href="#pre-commit-hooks" class="headerlink" title="pre-commit hooks"></a>pre-commit hooks</h2><p>Having a good set of linting rules if of no use if they get ignored.  Right? So, another package I install into my projects is pre-commit.  Be warned though.  If you are using Windows as your development computer, you’ll also need to install <a href="//gnuwin32.sourceforge.net/packages/coreutils.htm">coreutils</a> because pre-commit assumes you are able to run bash. But of course, someone could comment out or remove the pre-commit hooks or otherwise force a commit.  This is why you also want a good code review process in place for your team. When I review code, I check several items regularly.</p>
<ul>
<li>What changed and was it changed in a way consistent with how we want things coded.</li>
<li>If something wasn’t coded correctly, is there a linting rule we can put in place to correct it?</li>
<li>When I pull down the code, can I compile for production as well as for development mode?</li>
</ul>
<p>Point 2 is critical.  The more reviewing the computer can do for you the better off you’ll be.</p>
<h2 id="Conditionals"><a href="#Conditionals" class="headerlink" title="Conditionals"></a>Conditionals</h2><p>What I haven’t been able to find is a rule that will prevent conditions from showing up inside of observable functions or their array cousins.  If you know of something, please let me know in the comments below.</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>Now, a little code would be nice to flesh this all out.  So, this is what I’m currently using: First, the scripts and pre-commit sections from my package.json file: And then the tslint that I put with my NgRX code: If you have any other tips for how to force TypeScript into being more Functional, I’d love to hear them.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/enforce-typescript-functional-programming/" data-id="cjiw7ucod00u6dghifzxh0irb" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/functional/">functional</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tslint/">tslint</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/typescript/">typescript</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-angular-routing" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/how-to-implement-angular-2-routing/">How to Implement Angular 2+ Routing</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/how-to-implement-angular-2-routing/" class="article-date"><time datetime="2017-07-18T10:30:23.000Z" itemprop="datePublished">2017-07-18</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Angular-2/">Angular 2</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>In the old world where all of our pages were on the server and every change on the client side required a full round trip to the server, each page was a unique URL on the server.  In the SPA world, we only load one “Page” from the server and the client takes care of making it look like we have moved from one page to another. When done well, we can create pages that reuse existing content on the screen causing a minimal screen refresh while still allowing the user to link to a specific “Page” in our application. These “Pages” are called “Routes”  As in, here is the route to some code I want to execute. [caption id=”attachment_4394” align=”aligncenter” width=”800”]<img src="//blog.dmbcllc.com/wp-content/uploads/2017/07/2017-07-18.png" alt="How to Implement Angular 2+ Routing" title="How to Implement Angular 2+ Routing"> Photo via <a href="//visualhunt.com/re/9589c4">Visual Hunt</a>[/caption]  Sounds pretty cool.  But there is a down side that shows up every time someone tries to do this for the first time.  You won’t see this problem until the first time you try to deploy your code because the development server handles this issue for you. The problem is this.  When a server receives a request from the browser, it tries to find that file on the server.  If it doesn’t exist, the server returns a 404 error.  File not found. Most servers provide ways of circumventing this issue by providing rules.  Essentially, you write a server rule that says, “If the browser ask for a file that doesn’t exist, send them back index.html instead.”  You may need to provide exceptions or otherwise refine the rule if your server is also rerouting other traffic. If you are running on an IIS server, <a href="//blog.dmbcllc.com/asp-net-angular-js-html5mode/">I wrote instructions for how to take care of this issue</a> for AngularJS (1.x).  The instructions work for any client side framework that implements routing. Assuming you have that end of things working correctly, here are the steps to get basic routing working in your Angular application.</p>
<h2 id="Define-Your-Routes"><a href="#Define-Your-Routes" class="headerlink" title="Define Your Routes"></a>Define Your Routes</h2><p>While we could easily define our routes in app.module.ts, the code we write will be much easier to maintain if we create a separate module file named app-routes.module.ts.  So to start, create an app-routes.module.ts file right next to your app.module.ts file.  You can do this with the Angular CLI by typing the following in the command line from within the src/app directory: <code>ng g module app-routes</code> When you create a module with the Angular CLI, it will put it in a sub-directory.  In this case, it created an app-routes sub-directory.  We want it next to our app.module.ts file.  So, now we need to move the module up a directory and remove the app-routes directory. Open up the file, it has some stuff in it that we don’t need.  Remove the CommonModule references and the declarations section of the @NgModule decorator. In this new file, you will create an empty Routes array, called routes and decorate the class with @NgModule You need to also import Routes and while you are doing that, you might as well import RouterModule because you are going to need that soon too. Next, in your app.modules.ts file, import AppRoutesModule using both the TypeScript import and as part of the imports section of the @NgModule decorator We really haven’t done anything useful yet, we’ve just setup some boilerplate code that will compile so we won’t have to think about it any more. Now, back to the app-routes.module.ts file. Each element in our Routes array defines a specific route in our system relative to the parent route it is a part of.  At the top level the parent route would be the root of the application. Here are the properties that are available to us:</p>
<h3 id="path"><a href="#path" class="headerlink" title="path"></a>path</h3><p>The path property allows us to specify what path, or URL, will load this route.  If you want the component to load for any path, use ‘<strong>’ as the value.  If you want the component to load for the root element, use ‘’ for the path and specify pathMatch: ‘full’ as another property.  You can also use the value ‘</strong>’ to mean, “match anything.”  We typically use ** to match what would typically be thought of as 404 errors.  For this to work correctly, it should be the last element in your top most route definition.</p>
<h3 id="pathMatch"><a href="#pathMatch" class="headerlink" title="pathMatch"></a>pathMatch</h3><p>As we’ve already mentioned, pathMatch should be ‘full’ to match ‘’ as the exact path.  But you can also give this value ‘prefix’ to tell it to match any path that starts with the value.  You only need to specify this value if you want to use ‘full’. It should also be noted that this value only evaluates the part of the path you are in.  If you use this in a child path, it won’t match the whole path, but only the part that is in the child.</p>
<h3 id="component"><a href="#component" class="headerlink" title="component"></a>component</h3><p>Component specifies what component should get loaded when the path is matched.</p>
<h3 id="children"><a href="#children" class="headerlink" title="children"></a>children</h3><p>The children property allows us to specify an array of child paths.</p>
<h2 id="Route-Components"><a href="#Route-Components" class="headerlink" title="Route Components"></a>Route Components</h2><p>Since our routes will need components, let’s start by creating several components so that we can illustrate routing. But first, a short word about how we organize our code. In many demos online, the tendency is to put all of our components right under the app directory.  But, in larger applications, I’ve found that it makes a lot more sense to create a route directory under the app directory that we place each of our routes in. Now, you might think that we would want to place our child routes as child directories under the routes they are a part of, but the problem with this is that we often have child components in our routes.  How do we know which directory represents a child route and which represents a child component? No.  What we really want to do is place even the components that represent child routes right under our routes directory.  So, say we have a Page1 route and there is a SubPage route that is a child of Page1.  To make it clear, we put SubPage in a directory named page1.sub-page. As for components that are common to multiple pages, we place those in a components directory which is right under the app directory.  This keeps our directories well organized and the code neatly organized as well. The next obvious thing that we need to do is that we need to create a routes directory.  Do that now. Now, at the command line, inside the new routes directory, execute the following Angular CLI commands <code>ng g component page1</code> <code>ng g component page2</code> <code>ng g component page1-subpage</code> As you executed each command, it should have created a directory for each component with the corresponding css, html, ts and spec files.  Then it updated the app.module.ts file for you so that the components are available for use in the system. You may also notice that we created the component as page1-subpage instead of page1.subpage.  The reason for this is that the CLI doesn’t like period separation of file names.  So, the next thing we are going to do is change the directory name to page1.subpage.  You will also need to change the TypeScript import line that references this directory in your app.module.ts file. So, now that we have components to page to, let’s create our route definitions.  Back to the Routes array in our app-routes.module.ts file. The first definition may look a bit odd.  We are setting up a route to page1, but the route is the children.  Then in the children we define a route to ‘’.  This is where the Page1Component is specified as the component we want to load. You will also note that we specified “pathMatch: ‘full’” for the Page1Component.  This is because we only want this component to be loaded when the child path is empty. Using this definition, everything loads into the top level router-outlet.  If we placed Page1Component at the same level as we defined the page1 path, then Angular would expect to have a router-outlet in Page1Component where Pag1SubpageComponent would be loaded. Needless to say, you need to be careful how you define your routes. Next, you will need to import the three components using the TypeScript import statement. Now that everything is defined, we just need to tell Angular where we want these components to show up.  For right now, open the app.component.html file and remove everything that is there and add the router-outlet component. Now, router-outlet is a component that is defined in the RouterModule, so we need to import that in the imports section of our AppRoutesModule.  But we don’t just import the RouterModule, we use RouterModule.forRoot() and pass in the route array we just defined into forRoot(). There is one final tweak that we need to make to our route definition.  Right now, if you go to the root of the application, there isn’t a component defined for it.  To fix this, we are going to add the following definition at the top of  our routes: You need <code>pathMatch: ‘full’</code> to tell the router to only match this rule when the path is ‘’ exactly, just like we did with the Page1Component in the children list.  Otherwise, it will match everything. The <code>redirectTo: ‘page1’</code> part tells it to redirect to the page1 path when this rule is true.</p>
<h2 id="Lazy-Loading"><a href="#Lazy-Loading" class="headerlink" title="Lazy Loading"></a>Lazy Loading</h2><p>I realize that I still need to show you how to navigate to routes in your application, but first let’s look at lazy loading the routes. In the past, when building a Single Page Application, the custom was to load all of the JavaScript code we needed for the page up front.  But, if you have multiple pages in your application, some of those may never be needed by your user.  So, what are we doing loading stuff that will never get used? No, it is better to load only what we need when we need it.  While it might take longer if you totaled up each load, the user perceives the experience as faster.  Therefore what we want to do is to make each of our pages load as we need them. To do this, we need to create a module for each of the components that represent our top level routes.  We want to import modules and services into the module that is closest to where we need them.  This is why.  By only importing things where we need them, Angular can create the smallest package necessary all up and down the dependency tree. To make things easy and to do them the way you would have done them if you had done it this way to begin with, let’s delete all of the sub-directories under routes.  It’s OK.  We aren’t losing any work that we can’t quickly get back.  We haven’t added any code to these routes yet. At the command line, navigate to the routes directory and then type in the following Angular-CLI commands: <code>ng g module page1</code> <code>ng g component page1</code> <code>ng g module page1-subpage</code> <code>ng g component page1-subpage</code> <code>ng g module page2</code> <code>ng g component page2</code> And then, just like we did the first time, rename the page1-subpage directory to page1.subpage. Next, go to the app.modules.ts file and remove the references to the Page1, Page2, and Page1Subpage components anywhere you see them. Do the same thing in the app-routes.module.ts file. Now, the way we define our routes changes slightly.  We will still need the redirect route, but everything else changes. The key to making this work is the property <code>loadChildren</code>, which is a string in the format of: <code>‘pathToModule#ModuleClassName’</code> We’ll work from the top down.  Change the routes array in app-routes.module.ts to look like this: When we try to access something from page1, it will load the Page1Module and try to resolve it from there.  When we try to access something from page2, it will load the Page2Module.  Both of these happen during run time. Next, go to page1.module.ts and, import RouterModule and add the following to the imports section of @NgModule Next move over to page2 and do something similar.  Since page2 doesn’t have a sub-route, you only need, one route. And again, similarly for page1-subpage If you haven’t already, move your command-line prompt back to the root of the project and type <code>npm start</code> To start the server and compile your code.  If everything compiles, you should see 3 chunk files along with the other files we saw when we compiled the code without lazy loading. One each for each of the routes. Run the app in your browser now to make sure it works correctly. See how easy that was?  It isn’t really that much harder than specifying the routes like we did the first time, but we get huge benefits in performance.</p>
<h2 id="Passing-Parameters"><a href="#Passing-Parameters" class="headerlink" title="Passing Parameters"></a>Passing Parameters</h2><p>The last thing you need to know about is how to pass parameters.  You would normally do this when you are coming from an existing list of items.  Each item has some sort of unique identifier.  We click some link and that takes us to another page to show details or to edit the content.  For our purposes here, it doesn’t matter. To specify that a route takes a parameter, use colon notation: <code>path: ‘detail/:id’</code> Angular knows it is a parameter when you use a URL to get to it because of the location.</p>
<h2 id="Retrieving-Parameters"><a href="#Retrieving-Parameters" class="headerlink" title="Retrieving Parameters"></a>Retrieving Parameters</h2><p>Let’s say you have a component that represents a route with a parameter.  For that to be useful, you’ll need to pull the parameter out of the route information. To do this, you’ll need to inject <code>ActivatedRoute</code> into the component.  Then when you need the parameter(s) you can use: <code>route.params.take(1).subscribe(params =&gt;</code> <code>// Use params[&#39;id&#39;], where ‘id’ is the name</code> <code>// we gave the parameter in the path.</code> <code>);</code></p>
<h2 id="Route-Navigation"><a href="#Route-Navigation" class="headerlink" title="Route Navigation"></a>Route Navigation</h2><p>Now that we have routes in place, we need to discuss how to navigate from one route to another.  The temptation, having just used URLs to go from one to the other, would be to use hyperlinks and put the information in the href attribute. No doubt, you could probably get that to work, but the main problem with using that method is that there is no safeguards to make sure that the URL you use to navigate when you are developing will work when you move the site to another environment. The reason for this is that we have to set the base href for the site.  During development this is normally ‘/’.  But when you go to production, it could be some sub directory. Also, because of this base href, every page/route we land on is still relative to that base.  This means that every route we want to navigate to would have to be hard wired to the base of the site, and again, that’s assuming that the site will always be in the same relative location when it is deployed. Now, if we can’t using a regular URL to navigate, what do we use instead?</p>
<h3 id="routerLink"><a href="#routerLink" class="headerlink" title="routerLink"></a>routerLink</h3><p>You use the routeLink directive added to your anchor tag. <code>&lt;a [routerLink]=”[‘/page1’]”&gt;go here&lt;/a&gt;</code> This may look a little different from what you expected, so let’s break this down. The routerLink directive takes an array.  Since we can’t pass an array as a string, the only way we can pass it is by evaluating it at run time.  Remember, the square bracket syntax is an indication to the Angular compiler that what we are assigning is something that should be evaluated.  Typically this would be pointing to a function or variable in our TypeScript code.  In this case, we are pointing to a literal array.  Everything between the opening and closing quotes is JavaScript. As for the actual parameter, the string in the single element array works much like you would use a URL.  The forward slash says to start at the root of the web application (instead of the root of the domain like a URL would.)  And the page1 is the route we’ve already defined.  If you leave the forward slash off, it is relative to the current route. But what about passing parameters? <code>&lt;a [routerLink]=”[‘/page1’, someVariable]”&gt;go here&lt;/a&gt;</code> Each comma delimited value represents a segment of your route.</p>
<h3 id="Router-navigate"><a href="#Router-navigate" class="headerlink" title="Router.navigate()"></a>Router.navigate()</h3><p>The other way you might want to cause navigation to a page to occur is by using the navigate() method hanging off the Router class.  Using dependency injection, you inject the Router into the class that needs to use it and then use that instance to call navigate().  The parameter you pass in looks very similar to what you used for routerLink. <code>router.navigate(‘/page1’,someVariable);</code> Yes, both routerLink and Router.navigate() both support URL like references using ‘./path’ or ‘../path’.</p>
<h2 id="Where-Am-I-Now"><a href="#Where-Am-I-Now" class="headerlink" title="Where Am I Now?"></a>Where Am I Now?</h2><p>The last part of routing you will commonly need to know about is detecting what the current route is.  Once again this will require you to inject the Router object into the component that needs the information.  Once you have the router object, you can use code like this: <code>router.routerState.snapshot.url;</code> This will get the current route url.  I normally grap this as part of listening for the router’s NavigationEnd. <code>this.router.events</code> <code>.filter(arg =&gt; arg instanceof NavigationEnd)</code> <code>.map(arg =&gt; {</code> <code>this.selectedTab = router.routerState.snapshot.url.split(&#39;/&#39;)[1];</code> <code>return this.selectedTab;</code> <code>}).subscribe();</code></p>
<h2 id="Guards"><a href="#Guards" class="headerlink" title="Guards"></a>Guards</h2><p>Guards control access to our routes.  What happens if you have a route that only certain people should have access to.  Like an admin page.  Sure, you could leave the link off so no one can click the link to get to the page, but that doesn’t prevent someone from pasting the link to the forbidden page into the address bar of the browser and getting there anyhow. In Angular, we have four kinds of guards and two ways of creating them. The four types of guards are:</p>
<ul>
<li>CanActivate</li>
<li>CanActivateChild</li>
<li>CanDeactivate</li>
<li>CanLoad</li>
</ul>
<p>If you follow my advice and always lazy load your routes, than the two you will most often use are CanLoad and CanDeactivate.  CanLoad provides rules for lazy loading a module.  CanDeactive provides rules for leaving a route. If you decide to bundle routes together, then you may also need CanActivate and CanActivateChild.  CanActivate is exactly what it sounds like.  Can I activate this route?  CanActivateChild would go on a route definition that has a children’s collection.  This rule determines if I can activate the children. To use Guards in our application, the first thing we need to do is to define them.  The easiest way to define them is as a function that returns a boolean value, a boolean Observable, or a boolean Promise.  For our purposes here, we will just return a boolean value.  But when you have some asynchronous call you need to make to determine if we should return true or false, you’ll want to return an Observable or a Promise.  I favor Observables. The definition for a Guard rule looks like this: <code>@NgModule({</code> <code>…</code> <code>providers: [{</code> <code>provide: ‘ruleNameHere’,</code> <code>useValue: () =&gt; {</code> <code>return true;</code> <code>}</code> <code>}`</code>])<code>Then, to use the rule, you assign the appropriate rule the name of the rule.</code>{<code></code>path: ‘page1’,<code></code>canLoad: [‘ruleNameHere’],<code></code>loadChildren: ‘./routes/page1/page1.module#Page1Module’<code></code>}<code>Notice that canLoad, as well as the other guard properties, takes an array.  This allows you to apply multiple rules to a route. The other way of defining a route is as a class that implements an interface, or multiple interfaces that include CanActivate, CanActivateChild, CanDeactivate, and CanLoad.  You them implement the corresponding functions in your class. Now, to include the rule you use the Class rather than a string:</code>{<code></code>path: ‘page1’,<code></code>canLoad: [RuleClassHere],<code></code>loadChildren: ‘./routes/page1/page1.module#Page1Module’<code></code>}`</p>
<h2 id="But-wait-there’s-more-…"><a href="#But-wait-there’s-more-…" class="headerlink" title="But wait, there’s more …"></a>But wait, there’s more …</h2><p>Believe it or not, there is even more to routing than we’ve discussed here.  But we’ll leave that for another day or this post will turn into a book. Oh! By the way… I am working on a training book on Angular.  What will make it unique from most of the other books you can find is that, instead of telling you all of the possible ways you COULD do something, I’ll be teaching only the ways you SHOULD do something.  Of course, it will have a lot of the opinions I’ve already shared on this blog, but it will be all in one place and presented in a systematic manner. There, I’ve said it.  Now I have to finish it.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/how-to-implement-angular-2-routing/" data-id="cjiw7uc150074dghijty7k7le" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular-2/">angular 2</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/routing/">routing</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-how-to-be-an-awesome-programmer" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/how-to-be-an-awesome-programmer/">How To Be an Awesome Programmer</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/how-to-be-an-awesome-programmer/" class="article-date"><time datetime="2017-07-11T10:30:48.000Z" itemprop="datePublished">2017-07-11</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Opinion/">Opinion</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>It isn’t what you think.  Being an awesome programmer, or being awesome at anything has a lot less to do with any given topic: programming, boxing, writing.  It has a lot to do with being a healthy human.  So, the simple answer to the question of “How to be an awesome programmer” is simply, “be healthy.” But what does healthy look like? I really couldn’t tell you what got me started, but I’ve been reading an experimenting with Brain Hacks, Diet, Exercise, and Social Skills for over a year now.  Turns out, they are all related. Now, most of my audience has less than 5 years of experience.  I can say that because most of the programming population has less than 5 years of experience, so I’m going on the assumption that the people who read this blog, are a small representation of the global population.  Many symptoms I will reference are going to be things you may not suffer with … yet.  If you fall in that group, think of this post as a letter from your older self.  I was young once too.  I remember, I thought I was immune to some of these issues and if I wasn’t, there wasn’t much I could do. But we’ve learned SO much in the last 20 years.  Much of what we’ve thought was “normal” really isn’t.  We are just proverbial frogs in a pan of water being heated to death. [caption id=”attachment_4382” align=”aligncenter” width=”800”]<img src="//blog.dmbcllc.com/wp-content/uploads/2017/07/2017-07-11.jpg" alt="How To Be an Awesome Programmer" title="How To Be an Awesome Programmer"> Photo via <a href="//visualhunt.com/re/4bde52">VisualHunt.com</a>[/caption] </p>
<h2 id="Disclaimer"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a>Disclaimer</h2><p>Now, the stuff I’m going to talk about in here is what I’ve learned and from my experience.  I’m a programmer.  Not a doctor, Jim.  I write this in the hopes that it helps at least one other person.  But, I also leave the research and due diligence to you.  Just like I could give you some general programming guidance, but I would expect you to dig for more details.  Not that I do that intentionally when I write about programming.  Just be aware that I’m definitely not giving details here. Also, there is this funny little thing called “reactance” that causes us to want to believe that what we currently believe is the right way.  So, I’m going to ask you a simple little question.  It is the one I try to implement every time I hear a new idea.  “What if they are right?  What if I am wrong?” The truth is, just because you are used to living a certain way, doesn’t make it the right way.</p>
<h2 id="Brain-Health"><a href="#Brain-Health" class="headerlink" title="Brain Health"></a>Brain Health</h2><p>So, as I’ve thought about what I want to write, I could literally start from just about any angle.  The cool thing about our bodies is that they are SO intertwined.  When one system gets out of whack, other systems in the body fail as well.  But I wanted to start with Brain Health because if you can hack that, it seems most of the other stuff we should be doing becomes quite a bit easier.</p>
<h3 id="Sleep"><a href="#Sleep" class="headerlink" title="Sleep"></a>Sleep</h3><p>So, our first stop in brain health is sleep.  There are a lot of hacks that you can implement to get better sleep, but if you are going to be late and getting up early so that you are in bed for less than 8 hours, you are already starting out in a bad place.  I’ve always been pretty good at sleeping.  But there was a time when I was trying to cram more useful day out of my 24 hours so I was getting up an hour earlier than I currently do. Meanwhile, I developed aching shoulder muscles that I caulked up to a change in office chairs. Then I changed sleep habits.  I decided I didn’t really need that extra hour.  Almost immediately, my shoulders stopped aching.</p>
<h3 id="Food"><a href="#Food" class="headerlink" title="Food"></a>Food</h3><p>Talking about food is like talking about religion.  People have some very strongly held beliefs.  I’m guessing you do too. Now, before I try to break through some myths, let’s address where our current beliefs about how to eat “right” come from. When I was a kid, we had the “4 square meal.”  Equal portions of different categories of food.  Then, it was a REALLY big deal when USDA came out with the “Food pyramid.”  And now we have a “food plate.” How can you believe that any one of those is “right” when they’ve changed so often?  Either our research is flawed, or something else is influencing the changes.  But, they sure aren’t reliable.  But, we want to believe them because an “authority” says they are. Let me tell you something about “authorities.”  They aren’t all knowing and sometimes, they are wrong. Another thing that sticks with me is something a psychologist (employer) of mine told me.  “The schools are at least 20 years behind the research.”   WOW!  This means that your doctor is recommending things he learned 20+ years ago.  And it gets worse.  With lawsuits as prevalent as they are and insurance companies in control, few doctors are going to tell you what the current research says about what you should be eating, even if they know.  The “system” moves slowly. But, it doesn’t take long to find information on the Internet that supports the following basic food truths:</p>
<ol>
<li>Stay away from sugar</li>
<li>Stay away from carbs</li>
<li>Eat more fat</li>
</ol>
<p>You’ve heard it before.  Probably from some diet thing.  But, did you know that eating primarily carbs and sugars, as we’ve been doing now for over a generation, also makes us dumber?! So, I’ve been on a basically ketogenic diet for several years now.  Up until recently, I struggled with the temptation of eating foods on the naughty list.  There are two things that turned that around for me. First, I realized that the foods that held the strongest temptation had some emotional trigger or event tied to them.  But, in truth, I didn’t REALLY like the food. Second, I increased the amount of fat in my diet.  Now, I crave vegetables.  And as an added bonus, I don’t eat as many calories and I’m almost never hungry. But, what does this have to do with brain health?  Well, it turns out that your brain is mostly fat.  And not just any fat, but the kind of fat you’ll find in butter, coconut oil, olive oil, and meat.  There is still “bad fat” but it is the fat that is manmade.  Margarine, and corn oil for example.  Anyhow, if you remove good fat from your diet, your brain doesn’t function as well. In fact, there are studies that indicate that a lot of brain disease is caused by a lack of fat in our diets. Carbs are bad.  Fats are good.  Check it out for yourself.</p>
<h3 id="Exercise"><a href="#Exercise" class="headerlink" title="Exercise"></a>Exercise</h3><p>The next thing that heavily influences brain health is exercise.  Yes, it helps for dieting too.  But, that’s not the only benefit.  And only certain kinds of exercise is beneficial to exercise.  But the simple act of walking for 30 minutes every day 6 days a week, has several brain healthy benefits:</p>
<ol>
<li>Improves confidence</li>
<li>Helps fight depression</li>
<li>Improves sleep (which also helps your brain)</li>
<li>Reduces stress</li>
<li>Generally improves cognition.</li>
</ol>
<p>It is a simple thing to do that has so many benefits that using the excuse, “I’m too busy to exercise.” Is just that.  An excuse.</p>
<h3 id="Cortisol-and-Oxytocin"><a href="#Cortisol-and-Oxytocin" class="headerlink" title="Cortisol and Oxytocin"></a>Cortisol and Oxytocin</h3><p>Cortisol is the hormone that is triggered by stress.  It isn’t all bad.  But the amount we generally live with is bad.  The thing about Cortisol is that it can wreck your diet.  You’ve been trying to shed pounds but you’ve reached a floor.  It could be you are under too much stress.  Maybe because you aren’t getting enough sleep.   Or maybe you’ve just forgotten how to relax.  Or, it could be you aren’t eating correctly. Oxytocin, on the other hand, is the “feel good” drug.  There are a lot of ways to increase this and the great news is, no one has yet run a study that has concluded you can get too much. And once again, what is generally bad for our general health is directly linked to our brain health.</p>
<h3 id="Breath"><a href="#Breath" class="headerlink" title="Breath"></a>Breath</h3><p>This one kind of surprised me.  Just doing nothing more than focusing on your breath for 10 minutes a day, lowers cortisol and has many other health benefits. Sometimes you’ll see this phrased as “meditation” which kind of freaks some people out.  So, don’t meditate.  Just go to a quiet place and focus on breathing.  If you want to move it up a notch focus on breathing and relaxing on the exhale. 10 minutes a day.  Who doesn’t have time for that?</p>
<h2 id="Ask-Good-Questions"><a href="#Ask-Good-Questions" class="headerlink" title="Ask Good Questions"></a>Ask Good Questions</h2><p>Now, when I mention some of my practices to people I work with, I’m invariably met with, “I could never do that.”  Which reminds me of what my dad always said, “Can’t went to the poor house and died.” The point is, if you think you can’t, you surely won’t.  I won’t go so far as to say, “If you think you can or you think you can’t, in either case you are right.”  But, thinking you can will lead you to asking the right question and will at least get you closer to “there” where ever that may be. Here are some questions for you to ponder. How can I get the right amount of sleep? How can I get good quality sleep? What is keeping me from sleeping? How can I eat healthier? What foods will help me? What foods will hurt me? What in my environment needs to change?</p>
<h2 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h2><p>I’d put resources here of stuff I’ve read.  But I want you to do the research.  If I give it to you, you are a lot less likely to put it into action. But I do want to ask you a few questions. Listen, I know you are reluctant to change.  I get that.  I really do.  But if you were to change even just a few of your habits, what might some of the benefits be for you? On a scale of 1 to 10, how likely are you to investigate some of the changes mentioned above? Why didn’t you rate it lower? Imagine you’ve investigated the changes and implemented them, what kind of impact would that have on your life? What is that important to you? Now, what are you going to do about this next?</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/how-to-be-an-awesome-programmer/" data-id="cjiw7uc8m00f3dghi1qnit1sa" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/brain/">brain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/health/">health</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/programmer/">programmer</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-upload-image-file-angular" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/upload-an-image-as-a-file-in-angular/">Upload an Image as a File in Angular</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/upload-an-image-as-a-file-in-angular/" class="article-date"><time datetime="2017-07-04T10:30:08.000Z" itemprop="datePublished">2017-07-04</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Angular-2/">Angular 2</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>This past week, I needed to be able to upload an image in my application to the server as a file so that I could crop it and upload it. Now, uploading an image that you pulled up using the file upload control is relatively straight forward.  But, in our case, the image we want to be able to upload didn’t always come from the user’s file system.  This causes two problems. First, you can’t crop an image you retrieved from a different URL using the HTML Canvas because of Cross Origin restrictions and second, you can’t upload the file using the standard file upload mechanism because you didn’t get it from the file system. [caption id=”attachment_4375” align=”aligncenter” width=”800”]<img src="//blog.dmbcllc.com/wp-content/uploads/2017/07/2017-07-04.jpg" alt="Upload an Image as a File in Angular" title="Upload an Image as a File in Angular"> Photo via <a href="//visualhunt.com/re/3bc74d">Visual Hunt</a>[/caption]</p>
<h2 id="Image-to-Data-without-Canvas"><a href="#Image-to-Data-without-Canvas" class="headerlink" title="Image to Data without Canvas"></a>Image to Data without Canvas</h2><p>Now, the standard way of converting an Image to a data URL is to</p>
<ul>
<li>create a new Image,</li>
<li>set the onload event handler to a function</li>
<li>set the Image src attribute to the file</li>
<li>in the onload function,<ul>
<li>draw the image onto the canvas</li>
<li>call canvas.toDataUrl(mimeType) to get the data url.</li>
</ul>
</li>
</ul>
<p>It is pretty trivial code: <a href="https://gist.github.com/DaveMBush/0454717c390db1055674ff8a2817f68d#file-canvas-example-ts" target="_blank" rel="noopener">https://gist.github.com/DaveMBush/0454717c390db1055674ff8a2817f68d#file-canvas-example-ts</a> But, the trouble starts when you use a URL that doesn’t originate from the file system, or the same domain as the application your are running. The trick is to read the image using an XMLHttpRequest for foriegn URLs and then use a FileReader object and call readAsDataURL passing the result of the XMLHttpRequest.read. <a href="https://gist.github.com/DaveMBush/0454717c390db1055674ff8a2817f68d#file-data-url-ts" target="_blank" rel="noopener">https://gist.github.com/DaveMBush/0454717c390db1055674ff8a2817f68d#file-data-url-ts</a> Now we can put the image using the data URL on the canvas and the canvas doesn’t know we got it from a foreign URL any more so we no longer get a cross origin URL. The entry point for this code is on line 27.  You see  that if we are working with a File, we just use the FileReader directly.  But if we are using http, we go through the XMLHttpRequest.</p>
<h2 id="Fake-File-Upload"><a href="#Fake-File-Upload" class="headerlink" title="Fake File Upload"></a>Fake File Upload</h2><p>The only problem with this is that now we no longer have the file point, so if we want to upload the file, as a file, to the server we have come up with some way of creating a fake file object.  And believe it or not, that is a lot easier than you might think. You see, a File object is just a kind of Blob object.  So, all we really need to do is to create a Blob.  But, we have one additional issue.  Our image is in base 64 and we need to convert it to a binary byte array. <a href="https://gist.github.com/DaveMBush/0454717c390db1055674ff8a2817f68d#file-b64tofile-ts" target="_blank" rel="noopener">https://gist.github.com/DaveMBush/0454717c390db1055674ff8a2817f68d#file-b64tofile-ts</a> You can use the resulting “File” anywhere you would use a File you had retrieved from the file system.</p>
<h2 id="Upload-via-Http"><a href="#Upload-via-Http" class="headerlink" title="Upload via Http"></a>Upload via Http</h2><p>The last bit of this is that we need to upload this via the Http service.  This is going to be harder to show with code because it depends on what you need to do. In my case, I needed to just upload the file, so the post was pretty straight forward.  I used an Http.post() and passed the returned “file” as the data parameter. But, you may need to upload it by wrapping the file in a Form object and specifying varying headers.</p>
<h2 id="The-End"><a href="#The-End" class="headerlink" title="The End"></a>The End</h2><p>I know it is a relatively short post, but I hope it is helpful to someone.  There are a lot of examples out there of how to do this in JavaScript and jQuery, but I was unable to find anything that was specific to TypeScript and Angular.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/upload-an-image-as-a-file-in-angular/" data-id="cjiw7ucph00uydghipajv7u2w" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/file-upload/">file upload</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/images/">images</a></li></ul>


    </footer>
  </div>
  
</article>



  


  <div id="page-nav">
    <nav><ul class="pagination"><li><a class="page-prev" rel="prev" href="/page/2/"><i class="fa fa-chevron-left"></i> Prev</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li class="active"><span class="page-number">3</span></li><li><a class="page-number" href="/page/4/">4</a></li><li><a class="page-number" href="/page/5/">5</a></li><li class="disabled"><span class="page-space">&hellip;</span></li><li><a class="page-number" href="/page/31/">31</a></li><li><a class="page-next" rel="next" href="/page/4/">Next <i class="fa fa-chevron-right"></i></a></li></ul></nav>
  </div>



        </div>
        <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
          
  
  <div class="sidebar-module">
    <h4>Recents</h4>
    <ul class="sidebar-module-list">
      
        <li>
          <a href="/vmware-s-clarity-design-system-for-angular/">VMWare&#39;s Clarity Design System for Angular</a>
        </li>
      
        <li>
          <a href="/the-full-stack-developer-myth/">The Full Stack Developer Myth</a>
        </li>
      
        <li>
          <a href="/how-you-do-anything/">How you do Anything ...</a>
        </li>
      
        <li>
          <a href="/property-based-testing-in-angular-with-jsverify/">Property Based Testing in Angular with jsVerify</a>
        </li>
      
        <li>
          <a href="/property-based-testing-revealed-a-better-way-to-test/">Property Based Testing Revealed - A Better Way to Test</a>
        </li>
      
    </ul>
  </div>


  
  <div class="sidebar-module">
    <h4>Archives</h4>
    <ul class="sidebar-module-list"><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/03/">March 2018</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/02/">February 2018</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/01/">January 2018</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/12/">December 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/11/">November 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/10/">October 2017</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/09/">September 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/08/">August 2017</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/07/">July 2017</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/06/">June 2017</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/05/">May 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/04/">April 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/03/">March 2017</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/02/">February 2017</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/01/">January 2017</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/12/">December 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/11/">November 2016</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/10/">October 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/09/">September 2016</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/08/">August 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/07/">July 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/06/">June 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/05/">May 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/04/">April 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/03/">March 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/02/">February 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/01/">January 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/12/">December 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/11/">November 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/10/">October 2015</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/09/">September 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/08/">August 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/07/">July 2015</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/06/">June 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/05/">May 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/04/">April 2015</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/03/">March 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/02/">February 2015</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/01/">January 2015</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/12/">December 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/11/">November 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/10/">October 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/09/">September 2014</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/08/">August 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/07/">July 2014</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/06/">June 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/05/">May 2014</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/04/">April 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/03/">March 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/02/">February 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/01/">January 2014</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/12/">December 2013</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/11/">November 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/10/">October 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/09/">September 2013</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/08/">August 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/07/">July 2013</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/06/">June 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/05/">May 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/03/">March 2013</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/02/">February 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/01/">January 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2012/12/">December 2012</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2012/09/">September 2012</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2012/08/">August 2012</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2012/04/">April 2012</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2010/10/">October 2010</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2010/08/">August 2010</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2010/04/">April 2010</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2010/03/">March 2010</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/12/">December 2009</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/11/">November 2009</a><span class="sidebar-module-list-count">7</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/10/">October 2009</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/09/">September 2009</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/08/">August 2009</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/07/">July 2009</a><span class="sidebar-module-list-count">8</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/06/">June 2009</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/05/">May 2009</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/04/">April 2009</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/03/">March 2009</a><span class="sidebar-module-list-count">6</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/02/">February 2009</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/01/">January 2009</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/12/">December 2008</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/11/">November 2008</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/08/">August 2008</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/07/">July 2008</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/06/">June 2008</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/05/">May 2008</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/04/">April 2008</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/02/">February 2008</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/01/">January 2008</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2007/11/">November 2007</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2007/10/">October 2007</a><span class="sidebar-module-list-count">1</span></li></ul>
  </div>




        </div>
    </div>
  </div>
  <footer class="blog-footer">
  <div class="container">
    <div id="footer-info" class="inner">
      &copy; 2018 Dave M Bush<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

  

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>



<script src="/js/script.js"></script>

</body>
</html>
